[{"copy":0,"tags":[],"key":"a09c723f161cfc975ee259f27fad95475755e744","createAt":1541636849720,"updateAt":1541639779708,"name":"vb-ArrayFunction","description":"","files":[{"key":"4c10f7c384f107cb376cafb47d1cc06362405963","name":"IsInArray.vbs","value":"'' Determines whether a string has the same value in an array\n'' @stringToBeFound  :  to be found string\n'' @arr              :  use to found in array\nFunction IsInArray(stringToBeFound As String, arr As Variant) As Long\nDim i As Long\n' default return value if value not found in array\nIsInArray = -1\n\nif Initialized(arr) then\n    For i = LBound(arr) To UBound(arr)\n      If StrComp(stringToBeFound, arr(i), vbTextCompare) = 0 Then\n        IsInArray = i\n        Exit For\n      End If\n    Next i\nelse\n    IsInArray = -2\nEnd If\n\nEnd Function"},{"key":"3de06fc5e3b11e0aa63c31608791f49ab8acfd64","name":"pushArray.vbs","value":"'' push  value in an array\n'' @arr              :  not need dim length in advance\nSub pushArray(val As Variant, ByRef resizeArr As Variant)\n\nOn Error GoTo FIRST\nReDim Preserve resizeArr(UBound(resizeArr) + 1)\n\nresizeArr(UBound(resizeArr)) = val\n\nExit Sub\n\nFIRST:\nReDim resizeArr(0)\nresizeArr(0) = val\n\nEnd Sub"},{"key":"8ab176a699ce1a9dbb5e0ec510ef385d8e27b04e","name":"pushArrayToArray.vbs","value":"'' push  arr2 to another arr1\nFunction pushArrayToArray(ByRef arr1 As Variant, ByVal arr2 As Variant) As Long\n  Dim i As Integer\n\n  For i = LBound(arr2) To UBound(arr2)\n    pushArray arr2(i), arr1\n  Next i\n\nEnd Function"},{"key":"7f05a8dda8850429aa5e09fd6a9f78a1bad233a9","name":"pushRangeToArrayNoRepetition.vbs","value":"'' push value of range into a array and no repetition\n'' @range\n'' @arr  : array with contain distinct value\nFunction pushRangeToArrayNoRepetition(ByVal Range As Excel.Range, ByRef arr() As Variant)\n    Dim c As Excel.Range\n    Dim str As String\n\n    For Each c In Range\n        If c.Value2 <> \"\" Then\n            str = c.Value2\n        End If\n\n        '-1 :   no find string, -2 : array no init\n        If IsInArray(str, arr) < 0 Then\n            pushArray2 str, arr\n        End If\n\n    Next\nEnd Function"},{"key":"0140aff2fd9c75012a91b8bfc35b961b3aa89f64","name":"pushRangeToArray.vbs","value":"'' push value of range into a array\n'' @range\n'' @arr  : array with contain distinct value\nFunction pushRangeToArray(ByVal Range As Excel.Range, ByRef arr() As Variant)\n    Dim c As Excel.Range\n    Dim str As String\n\n    For Each c In Range\n        If c.Value2 <> \"\" Then\n            str = c.Value2\n        End If\n\n        pushArray2 str, arr\n\n    Next\nEnd Function"},{"key":"92ee4cda0568013b255882f9a5c5687b299295e1","name":"supSplit.vbs","value":"'' find splite sign in string,return array.if not find return 0\nFunction supSplit(ByVal str As String, Optional ByRef flag As Integer) As String()\nDim aStr(0) As String\nflag = 1\n\nIf InStr(str, \",\") > 0 Then\n    supSplit = Split(str, \",\")\nElseIf InStr(str, \":\") > 0 Then\n    supSplit = Split(str, \":\")\nElseIf InStr(str, \"|\") > 0 Then\n    supSplit = Split(str, \"|\")\nElseIf InStr(str, \"\\\") > 0 Then\n    supSplit = Split(str, \"\\\")\nElseIf InStr(str, \";\") > 0 Then\n    supSplit = Split(str, \";\")\nElseIf InStr(str, \"_\") > 0 Then\n    supSplit = Split(str, \"_\")\nElseIf InStr(str, \"-\") > 0 Then\n    supSplit = Split(str, \"-\")\nElse\n    aStr(0) = str\n    supSplit = aStr\n    flag = 0\nEnd If\n\n\nEnd Function"},{"key":"3beef7616c4bec05c6f2e150a955e7fecec42b33","name":"countArrayNotEmpte.vbs","value":"'' return count of element of array,and element is not \"\"\nFunction countArrayNotEmpte(ByVal arr As Variant) As Integer\nDim count As Integer\nDim i As Integer\n\nFor i = LBound(arr) To UBound(arr)\n    If arr(i) <> \"\" Then\n        count = count + 1\n    End If\nNext i\n\ncountArrayNotEmpte = count\n\nEnd Function"},{"key":"0690b10f0c957f8aa4d979803529c12ffc433985","name":"countArray.vbs","value":"Function countArray(ByVal arr As Variant) As Integer\nDim i As Variant\nDim count As Integer\n\nFor Each i In arr\n    count = count + 1\nNext\n\ncountArray = count\n\nEnd Function"},{"key":"961a1f074c91af8b9cbab08db8f0745acc2d1a55","name":"Initialized.vbs","value":"'' Determine if Array is not Initialized\nFunction Initialized(val) As Boolean\nOn Error GoTo errHandler\n    Dim i\n\n    If Not IsArray(val) Then GoTo exitRoutine\n\n    i = UBound(val)\n\n    Initialized = True\nexitRoutine:\n    Exit Function\nerrHandler:\n    Select Case Err.Number\n        Case 9 'Subscript out of range\n            GoTo exitRoutine\n        Case Else\n            Debug.Print Err.Number & \": \" & Err.Description, _\n                \"Error in Initialized()\"\n    End Select\n    Debug.Assert False\n    Resume\nEnd Function"},{"key":"1c68a612d13889a3a0de49195adf37b9a9661b4d","name":"pushArrayToRange.vbs","value":"'' 将一个array中的值填充到一个range中\n'' @range\n'' @arr  :\nFunction pushArrayToRange(ByRef arr As Variant, ByVal range As Excel.range)\nDim i As Long\nDim j As Long\n\nj = 1\n\nFor i = LBound(arr) To UBound(arr)\n    If  j <= range.Count Then\n        range.Item(j) = arr(i)\n        j = j + 1\n    End If\nNext i\n\nEnd Function"},{"key":"901a6b055fead1112848e4663926e1a4c9869c0c","name":"pushArrayToSingleColumnRange.vbs","value":"''push element of array into a range of single column type from up to down\n'@arr           :   array by pushed\n'@startCell    :   range type , the first cell by pushed\nSub pushArrayToSingleColumnRange(arr As Variant, ByVal startCell As range)\nDim i As Long\nDim c As range\n\nFor i = 0 To UBound(arr)\n        Set c = startCell.Offset(rowoffset:=i)\n        c.Value2 = arr(i)\nNext i\n\nEnd Sub"}]},{"copy":0,"tags":[],"key":"24e8d03e44c25acbf5a915e1fd7740f017f6968a","createAt":1541637274434,"updateAt":1541639795886,"name":"vb-ExcelCheck","description":"","files":[{"key":"626aec8ee1e3e58510c38bc257399f4927aa1fc4","name":"checkInteger.vbs","value":"'check every cell in range is integer or zero\n'@r :   range be checked\n'@flag  : 1 -   check integer\n'         2 -   check zero or positive integer\n'         3 -   check natural number\nFunction checkInteger(r As Range, flag As Integer) As Boolean\nDim c As Range\n\ncheckInteger = False\n\nFor Each c In r\n    If IsNumeric(c) Then\n\n        If flag = 1 Then\n\n        ElseIf flag = 2 Then\n\n            If (c.Value2 < 0) Or (c.Value2 <> CInt(c.Value2)) Then\n                c.Activate\n                MsgBox \"bad\"\n                End\n            End If\n\n        ElseIf flag = 3 Then\n\n        End If\n\n    Else\n        c.Activate\n        MsgBox \"bad\"\n        End\n    End If\n\nNext\n\ncheckInteger = True\nEnd Function"},{"key":"760cda4787eca69c29f763b0816ae38663a1fcbe","name":"checkSum.vbs","value":"'check sum of range equal special value\n'@r     :   range\n'@sum   :   special value\nFunction checkSum(r As Range, sum As Double) As Boolean\nDim s As Double\nDim c As Range\n\nFor Each c In r\n    s = s + c.Value2\nNext\n\nIf s <> sum Then\n    r.Activate\n    MsgBox \"bad\"\n    End\nEnd If\n\nEnd Function"}]},{"copy":0,"tags":[],"key":"01da4d16582b7f29bf520a28bb35b9bd862d73ab","createAt":1541637414897,"updateAt":1541639660313,"name":"vb-checkDuration","lang":"VBScript","value":"'时间格式是20150914 08:35:37\n'检查两个时刻间隔是否小于2分钟，如果小于就标黄\nPrivate Sub checkDuration()\nDim checkedSheets As Object\nDim checkedSheet As Excel.Worksheet\nDim bottomRowNo As Integer   '最底层行号\nDim row\nDim startTime As Integer\nDim nextTime As Integer\nDim startUsername As String\nDim nextUsername As String\n\nDim startDay\nDim startMM\nDim nextDay\nDim nextMM\n\nSet checkedSheets = Workbooks(1).Worksheets\n\nFor Each checkedSheet In checkedSheets\n    bottomRowNo = getBottomRow(checkedSheet, 1)\n    \n    For row = 2 To bottomRowNo - 1\n        startUsername = checkedSheet.Cells(row, 2).Value\n        nextUsername = checkedSheet.Cells(row + 1, 2).Value\n        \n        startTime = Mid(checkedSheet.Cells(row, 5).Value, 13, 2) '获取时间字符串，样式为20150914 08:35:37\n        nextTime = Mid(checkedSheet.Cells(row + 1, 5).Value, 13, 2)\n        \n        'startDay 为转换后的日期 格式为2015/09/14\n        startDay = Mid(Left(checkedSheet.Cells(row, 5).Value, 8), 1, 4) & \"/\" & Mid(Left(checkedSheet.Cells(row, 5).Value, 8), 5, 2) & \"/\" & Mid(Left(checkedSheet.Cells(row, 5).Value, 8), 7, 2)\n        'startMM 为转换后的时分秒 格式为08:35:37\n        startMM = Right(checkedSheet.Cells(row, 5).Value, 8)\n        \n        nextDay = Mid(Left(checkedSheet.Cells(row + 1, 5).Value, 8), 1, 4) & \"/\" & Mid(Left(checkedSheet.Cells(row + 1, 5).Value, 8), 5, 2) & \"/\" & Mid(Left(checkedSheet.Cells(row + 1, 5).Value, 8), 7, 2)\n        nextMM = Right(checkedSheet.Cells(row + 1, 5).Value, 8)\n        \n        If (startUsername = nextUsername) Then\n        \t\t'先比较日期，如果不是同一天就不用继续比较\n            If DateDiff(\"d\", startDay, nextDay) >= 1 Then\n                GoTo NEXTROW\n            '再比较时间，如果超过2分钟就不标黄，否则该行标黄\n            ElseIf DateDiff(\"n\", startMM, nextMM) >= 2 Then\n                GoTo NEXTROW\n            Else\n                checkedSheet.Rows(row + 1).Interior.ColorIndex = 6\n            End If\n            \n        End If\n        \nNEXTROW:\n        \n    Next\n    \nNext\n\nMsgBox \"检查完毕\"\n\n\nEnd Sub\n","description":""},{"copy":0,"tags":[],"key":"5d416c150cf2b24f8a6d3283c6ad4e6f7d511ef3","createAt":1541637479653,"updateAt":1541637479653,"name":"vb-comment_cell","lang":"VBScript","value":"'对制定的单元格添加批注，并标识该单元格及所在行的颜色\n'@ cell          添加批注的单元格\n'@ comment       所要添加的批注\n'@ ifColor       是否要修改单元格的颜色，true 修改颜色,false 不修改颜色\n'@ error_count   单元格计数器\nSub comment_cell(cell As Excel.Range, _\n                comment As String, _\n                Optional ByRef ifColor As Boolean, _\n                Optional ByRef error_count As Integer)\n\nIf ifColor = True Then\n    cell.Parent.Rows(cell.row).Interior.ColorIndex = 6\n    cell.Interior.ColorIndex = 33\nEnd If\n\nIf cell.comment Is Nothing Then\n    cell.AddComment\nEnd If\ncell.comment.Text Text:=comment & Chr(10) & cell.comment.Text\n\nerror_count = error_count + 1\n\nEnd Sub","description":""},{"copy":0,"tags":[],"key":"c335eacd6d8f63181790a233aaa7deeeb6d4c564","createAt":1541637614889,"updateAt":1541637643312,"name":"vb-common_check","lang":"VBScript","value":"Attribute VB_Name = \"common_check\"\nOption Explicit\n\n'检查数据文件的列是否与模板一致\n'并增加用于数据库字段名一行，用于数据导入\n'match_wb               对应表文件workbook\n'province_city          数据文件来自于省还是地市，省1，地市0\n'data_ws                数据文件的worksheet\n'table_name             所检查的表名\n'start_check_row        表头起始行\n'dbcol_code_row         插入数据文件导入数据库识别字段名称，如果原有则覆盖\n'log_path               日志文件路径\n'return                 数据文件数据部分的宽度\nFunction checkDataFileCol(match_wb As Excel.Workbook _\n                    , province_city As Integer _\n                    , data_ws As Worksheet _\n                    , table_name As String _\n                    , start_check_row As Integer _\n                    , dbcol_code_row As Integer _\n                    , log_path As String)\n\nDim match_ws As Worksheet                               '省级对应表或地市对应表\nDim match_tab_row, match_tab_col As Integer             '对应表里的行号和列号\nDim data_tab_row, data_tab_col As Integer               '数据文件里的行号和列号\nDim data_tab_wide As Integer                            '数据文件数据部分的宽度\n\nDim row As Integer\n\nIf province_city = 1 Then\n    Set match_ws = match_wb.Worksheets(\"网省对应表\")\nElseIf province_city = 0 Then\n    Set match_ws = match_wb.Worksheets(\"地市对应表\")\nElse\n    MsgBox \"错误！未指定对应表使用省或地市\"\nEnd If\n\n'取消整表数据有效性\ndata_ws.cells.Validation.Delete\n\n'因为已有代码不正确，删除再插入一行，因为下发工程项目表没有此行，因此不删除\nIf InStr(data_ws.Name, \"工程\") = 0 Then\n    data_ws.Rows(dbcol_code_row).Delete\nEnd If\ndata_ws.Rows(dbcol_code_row).Insert shift:=xlShiftDown\n\ndata_tab_wide = 0\n\nrow = 1\ndata_tab_col = 0\nDo While match_ws.cells(row, 1).Text <> \"\"\n    If match_ws.cells(row, 1).Text = table_name Then\n        '统计数据文件数据部分的宽度\n        data_tab_wide = data_tab_wide + 1\n    \n        match_tab_row = row\n        match_tab_col = 2\n        \n        data_tab_row = start_check_row\n        data_tab_col = data_tab_col + 1\n        \n        Do While match_ws.cells(match_tab_row, match_tab_col).MergeArea.Item(1).Text <> \"\"\n        \n            If (match_ws.cells(match_tab_row, match_tab_col).MergeArea.Item(1).Text = _\n                        data_ws.cells(data_tab_row, data_tab_col).MergeArea.Item(1).Text) _\n                    Or (match_ws.cells(match_tab_row, match_tab_col).MergeArea.Item(1).Text = \"h\") Then\n                match_tab_col = match_tab_col + 1\n                data_tab_row = data_tab_row + 1\n                \n                '插入数据库导入的识别字段名\n                If match_ws.cells(match_tab_row, match_tab_col).MergeArea.Item(1).Text = \"\" Then\n                        data_ws.cells(dbcol_code_row, data_tab_col).Value2 = _\n                            match_ws.cells(match_tab_row, 14)\n                End If\n            Else\n                Call log.error(log_path _\n                                , \"数据文件与模板不符。请检查表:\" & table_name & \"第\" _\n                                    & data_tab_row & \"行，第\" & data_tab_col & \"列是否与模板一致\")\n                data_ws.Columns(data_tab_col).Interior.ColorIndex = 6\n                GoTo Next_Data_Table_Column\n            End If\n            \n        Loop\n    End If\n    \nNext_Data_Table_Column:\n\n    row = row + 1\n\nLoop\n\ncheckDataFileCol = data_tab_wide\n\nEnd Function\n\n'修改有错误单元格的行为黄色，并批注错误说明，修改单元格为蓝色\nSub comment_cell(cell As Excel.Range, comment As String)\n\ncell.Parent.Rows(cell.row).Interior.ColorIndex = 6\ncell.Interior.ColorIndex = 33\nIf cell.comment Is Nothing Then\n    cell.AddComment\nEnd If\ncell.comment.Text Text:=comment & Chr(10) & cell.comment.Text\n\nerror_count = error_count + 1\n\nEnd Sub\n\n'判断字符串是否含有字母,，空格，如果是，返回true\nFunction IsCounter(value As String) As Boolean\n    Dim reg As Object\n    Set reg = CreateObject(\"vbscript.RegExp\")\n    With reg\n     .Global = True\n     '.Pattern = \"[a-zA-Z_，=~!@#$%^&()-{}\\[\\]\\|:;'“?<>/ ]\"\n     .Pattern = \"[a-zA-Z_，= :;：；]\"\n    End With\n    IsCounter = reg.Test(value)\n    Set reg = Nothing\nEnd Function\n\n\n'进行数字或字符检查\n'num_str_code       该列进行数字检查还是字符检查，1，进行数字检查；2，进行字符检查\n'data_table_range   被检查的数据集\n'data_table_name    被检查的数据文件的表名\n'log_path           日志文件路径\n'update_num_method  修改为数字型的处理方式，1：使用VAL方式转换，对应于10kV这种类型；2：使用公式转换，如容量里填写成容量组成\nSub check_num_str(num_str_code As Integer _\n                    , data_table_range As Excel.Range _\n                    , data_table_name As String _\n                    , log_path As String _\n                    , update_num_method As Integer)\n                    \nDim data_table_cell As Excel.Range\nDim try_flag As Boolean\n\nIf num_str_code = 1 Then\n    For Each data_table_cell In data_table_range\n    try_flag = True\nTry_again:\n        If Not (Application.WorksheetFunction.IsNumber(data_table_cell.Value2)) And data_table_cell.Text <> \"\" Then\n            If update_num_method = 1 And try_flag = True Then\n                data_table_cell.Value2 = Val(data_table_cell.Text)\n                try_flag = False\n                GoTo Try_again\n            ElseIf update_num_method = 2 And try_flag = True And IsCounter(data_table_cell.Text) = False Then\n                data_table_cell.Value2 = Replace(data_table_cell.Value2, \"×\", \"*\")\n                data_table_cell.Formula = \"=\" & data_table_cell.Text\n                try_flag = False\n                GoTo Try_again\n            Else\n                'Call log.error(log_path:=log_path _\n                                , msg:=\"不是数字型错误。请检查表:\" & data_table_name & \"第\" _\n                                        & data_table_cell.row & \"行，第\" & data_table_cell.Column & \"列是否的确是数字\")\n                comment_cell data_table_cell, \"该单元格应为数字型\"\n            End If\n        End If\n    Next\nElseIf num_str_code = 2 Then\n\nElse\n    MsgBox \"use error num_str_code\"\nEnd If\n\nEnd Sub\n\n'修改为指定的精度\n'accuracy               指定小数点后位数,为0,1，2，3，4,6\n'                       5 文本\n'data_table_range       被修改的数据集\nSub updat_accuracy(accuracy As Integer _\n                    , data_table_range As Excel.Range)\nSelect Case accuracy\n    Case 0\n        data_table_range.NumberFormat = \"#;[red]#\"\n    Case 1\n        data_table_range.NumberFormat = \"#.#;[red]#.#\"\n    Case 2\n        data_table_range.NumberFormat = \"#.##;[red]#.##\"\n    Case 3\n        data_table_range.NumberFormat = \"#.###;[red]#.###\"\n    Case 4\n        data_table_range.NumberFormat = \"#.####;[red]#.####\"\n    Case 5\n        data_table_range.NumberFormat = \"@\"\n    Case 6\n        data_table_range.NumberFormat = \"#.######;[red]#.######\"\n    Case Else\n        MsgBox \"指定了错误的小数点精度\"\nEnd Select\nEnd Sub\n\n'修改日期类型为指定格式\n'date_type              1,修改为2010/09/28;2,修改为YYYY-MM-DD HH:MIN;3,yyyy;4,hh:mm\n'data_table_range       被修改的数据集\nSub update_date(date_type As Integer _\n                , data_table_range As Excel.Range _\n                , log_path As String)\n\nDim data_cell As Excel.Range\nDim data_table_name As String\n\ndata_table_name = data_table_range.Parent.Name\n\n    Select Case date_type\n        Case 1\n            For Each data_cell In data_table_range\n                If IsDate(data_cell.Text) And data_cell.Text <> \"\" Then\n                    data_cell.Value2 = CDate(data_cell.Value2)\n                    data_cell.NumberFormatLocal = \"yyyy/m/d\"\n                    data_cell.Value2 = \"'\" & data_cell.Text\n                    data_cell.NumberFormat = \"@\"\n                ElseIf data_cell.Text <> \"\" Then\n                    comment_cell cell:=data_cell _\n                                , comment:=\"不是日期。请按 年/月/日 格式填写\"\n                End If\n            Next\n        Case 2\n            \n            For Each data_cell In data_table_range\n                If IsDate(data_cell) And data_cell.Text <> \"\" Then\n                    data_cell.Value2 = CDate(data_cell.Value2)\n                    data_cell.NumberFormat = \"yyyy/m/d hh:mm\"\n                    data_cell.Value2 = \"'\" & data_cell.Text\n                    data_cell.NumberFormat = \"@\"\n                ElseIf data_cell.Text <> \"\" Then\n                    comment_cell cell:=data_cell _\n                                , comment:=\"不是日期。请按 年/月/日 小时：分钟 格式填写\"\n                End If\n            Next\n              \n        Case 3\n        \n            For Each data_cell In data_table_range\n                    data_cell.NumberFormatLocal = \"yyyy\"\n                    data_cell.Value2 = Val(data_cell.Value2)\n            Next\n            \n        Case 4\n            For Each data_cell In data_table_range\n                If data_cell.Text <> \"\" Then\n                    'data_cell.Value2 = CDate(data_cell.Value2)\n                    data_cell.NumberFormatLocal = \"hh:mm\"\n                    data_cell.Value2 = \"'\" & data_cell.Text\n                    data_cell.NumberFormat = \"@\"\n                ElseIf data_cell.Text <> \"\" Then\n                    comment_cell cell:=data_cell _\n                                , comment:=\"未按时间格式要求填写，请按 小时：分钟 格式填写\"\n\n                End If\n            Next\n            \n        Case Else\n            MsgBox \"指定了错误的日期格式\"\n            \n    End Select\n\n\n\n\nEnd Sub\n\n\n'在公用数据词典中查找指定的字符串，返回相应的编码\n'如果找到，返回一个整型数\n'如果没有找到.\nFunction array_substr_multi(array_searched() As String, str_searched As String, type_code As Long)\nDim i, j As Integer\nDim type_values As String\n\nIf str_searched = \"\" Then\n    GoTo End_Function\nEnd If\n\nFor i = 0 To UBound(array_searched)\n    If array_searched(i, 0) = type_code Then\n    type_values = type_values & array_searched(i, 3) & \" 值为\" & array_searched(i, 2) & \",\" & Chr(10)\n    End If\nNext\n\nFor i = 0 To UBound(array_searched)\n    If array_searched(i, 0) = type_code Then\n        If StrComp(StrConv(array_searched(i, 3), vbLowerCase), StrConv(str_searched, vbLowerCase), vbTextCompare) = 0 Then\n            array_substr_multi = array_searched(i, 2)\n            GoTo End_Function\n        End If\n    End If\nNext\n\narray_substr_multi = type_values\n\nEnd_Function:\nEnd Function\n\n'在行政区划或公司组织机构数组中查询指定字符串的对应编码\n'如果找到，返回一个整型数\n'如果没有找到，返回 20122012\n'array_searched()       被查询的数组\n'str_searched()           被查询的字符串\nFunction array_substr_single(array_searched() As String, str_searched() As String)\nDim i As Integer, j As Integer\n\n\nFor j = 0 To UBound(str_searched)\n    For i = 0 To UBound(array_searched)\n        If array_searched(i, 1) = str_searched(j) Then\n            array_substr_single = array_searched(i, 0)\n            GoTo End_Function\n        End If\n    Next\nNext\n\n\narray_substr_single = 20122012\n\nEnd_Function:\nEnd Function\n\n'转换编码\n'exchange_array             存储数据标志,1:国网公司组织机构;2:行政区划（空则填充）;3:公用编码;4:行政区划（则不填充）\n'data_table_range           被转换的数据文件数据集\n'province_name              省名\n'city_name                  地市名\n'data_table_name            被转换的数据文件表名\n'log_path                   日志文件路径\n'type_code                  公用数据字典查询用的主编码，不用设为0\nSub exchange(exchange_array As Integer _\n                , data_table_range As Excel.Range _\n                , province_name As String _\n                , city_name As String _\n                , data_table_name As String _\n                , log_path As String _\n                , type_code As Long)\n                \nDim unit_name() As String             '省名+地市名+市区/县名,或者市区/县名\nDim data_cell As Excel.Range        '被检查单元格\nDim result_search\nDim exchanged_value As String       '要被公用数据字典查询后替换的字符串\n\nDim i As Integer\n                \nSelect Case exchange_array\n    Case 1 'company_code\n    \n        For Each data_cell In data_table_range\n        \n            ReDim unit_name(2)\n            unit_name(0) = data_cell.Text\n            unit_name(1) = province_organ_name\n            \n            result_search = array_substr_single(company_code(), unit_name())\n            \n            If result_search = 20122012 Then\n                'Call log.error(log_path:=log_path _\n                                , msg:=\"所填公司名称与数据字典不对应错误。表：\" & data_table_name & \" 第\" & _\n                                data_cell.row & \" 行，第\" & data_cell.Column & _\n                                \" 列，所填公司名称与数据字典（供电公司.xls）不符\")\n                comment_cell cell:=data_cell _\n                            , comment:=\"所填公司名称与数据字典不对应错误。表：\" & data_table_name & \" 第\" & _\n                            data_cell.row & \" 行，第\" & data_cell.Column & \"列，所填公司名称与数据字典(供电公司.xls)不符\"\n            Else\n                data_cell.NumberFormat = \"@\"\n                data_cell.Value2 = result_search\n            End If\n        Next\n        \n    Case 2 'gov_code 如果为行政区划的单元格为空，则用编码填充\n        \n        For Each data_cell In data_table_range\n        \n            ReDim unit_name(5)\n            \n            If data_cell.Text = \"\" Then\n                unit_name(0) = province_name + city_name\n            Else\n                unit_name(0) = data_cell.Text\n                unit_name(1) = province_name + city_name + data_cell.Text\n                unit_name(2) = province_name + data_cell.Text\n                unit_name(3) = city_name + data_cell.Text\n                'unit_name(4) = province_name + city_name       如果没有填写，不用修改\n                \n                \n            End If\n                 \n            \n            result_search = array_substr_single(gov_code(), unit_name())\n            \n            If result_search = 20122012 Then\n                'Call log.error(log_path:=log_path _\n                                , msg:=\"所填行政区划名称与数据字典不对应错误。表：\" & data_table_name & \" 第\" & _\n                                data_cell.row & \" 行，第\" & data_cell.Column & _\n                                \" 列，所填行政区划名称与数据字典（行政区划.xls）不符\")\n                comment_cell cell:=data_cell _\n                            , comment:=\"所填行政区划名称与数据字典不对应错误。表：\" & data_table_name & \" 第\" & _\n                                data_cell.row & \" 行，第\" & data_cell.Column & _\n                                \"列，所填行政区划名称与数据字典(行政区划.xls)不符\"\n            Else\n                data_cell.NumberFormat = \"@\"\n                data_cell.Value2 = result_search\n            End If\n        Next\n        \n    Case 3 'pub_domain_code\n        \n        For Each data_cell In data_table_range\n            exchanged_value = data_cell.Text\n            \n            result_search = array_substr_multi(pub_domain_code(), exchanged_value, type_code)\n            \n            If IsNumeric(result_search) Then\n                data_cell.Value2 = result_search\n            Else\n                'Call log.error(log_path:=log_path, msg:=\"枚举值不对应。\" & _\n                                city_name & \"表：\" & data_table_name & \"第\" & _\n                                data_cell.row & \" 行，第\" & data_cell.Column & \"应填：\" & result_search)\n                comment_cell cell:=data_cell _\n                            , comment:=\"枚举值不对应。\" & _\n                                city_name & \"表：\" & data_table_name & \"第\" & _\n                                data_cell.row & \" 行，第\" & data_cell.Column & \"应填：\" & result_search\n            End If\n        Next\n        \n    Case 4 'gov_code 如果为行政区划的单元格为空，则不处理\n        ReDim unit_name(1)\n        \n        For Each data_cell In data_table_range\n            \n            If data_cell.Text = \"\" Then\n                \n                GoTo NextCellExchange\n                \n            Else\n            \n                If InStr(data_cell.Text, \",\") > 0 Or InStr(data_cell.Text, \"，\") > 0 Then\n                \n                    If InStr(data_cell.Text, \",\") > 0 Then\n                        unit_name = Split(data_cell.Text, \",\")\n                    Else\n                        unit_name = Split(data_cell.Text, \"，\")\n                    End If\n                    \n                    i = 0\n                    Do While i <= UBound(unit_name)\n                        result_search = array_substr_single(gov_code(), unit_name()) & \",\" & result_search\n                        i = i + 1\n                    Loop\n                \n                Else\n                \n                    unit_name(0) = data_cell.Text\n                    result_search = array_substr_single(gov_code(), unit_name())\n                \n                End If\n                \n            End If\n            \n            \n            If result_search = 20122012 Then\n                'Call log.error(log_path:=log_path _\n                                , msg:=\"所填行政区划名称与数据字典不对应错误。表：\" & data_table_name & \" 第\" & _\n                                data_cell.row & \" 行，第\" & data_cell.Column & _\n                                \" 列，所填行政区划名称与数据字典（行政区划.xls）不符\")\n                comment_cell cell:=data_cell _\n                            , comment:=\"所填行政区划名称与数据字典不对应错误。表：\" & data_table_name & \" 第\" & _\n                                data_cell.row & \" 行，第\" & data_cell.Column & _\n                                \"列，所填行政区划名称与数据字典(行政区划.xls)不符\"\n            Else\n                data_cell.Value2 = result_search\n            End If\n        \nNextCellExchange:\n        Next\n        \n    Case Else\n        MsgBox \"错误的存储数组名称\"\nEnd Select\n\n\nEnd Sub\n\n'处理电压值\n'如果没有带kV,加上kV;\n'data_table_range           被转换的数据文件数据集\n'province_name              省名\n'city_name                  地市名\n'data_table_name            被转换的数据文件表名\n'log_path                   日志文件路径\nSub update_voltage_value(data_table_range As Excel.Range _\n                        , province_name As String _\n                        , city_name As String _\n                        , data_table_name As String _\n                        , log_path As String)\nDim cells As Excel.Range\nDim cell_value As String\nDim reg As Object\nDim reg_nokv As Object\n\nSet reg = CreateObject(\"vbscript.regexp\")\nWith reg\n    .Global = True\n    .Pattern = \"(^[±][0-9.]+[k][v]$)|(^[0-9.]+[k][v]$)|(^[±][0-9.]+$)|(^[0-9.]+$)\"\nEnd With\n\nSet reg_nokv = CreateObject(\"vbscript.regexp\")\nWith reg_nokv\n    .Global = True\n    .Pattern = \"(^[±][0-9.]+$)|(^[0-9.]+$)\"\nEnd With\n\nFor Each cells In data_table_range\n    \n    If Not (cells.comment Is Nothing) Then\n        If InStr(cells.comment.Text, Cell_RESOLVED) > 0 Then\n            GoTo Next_cell_update_voltage_value\n        End If\n    End If\n    \n    cell_value = cells.Text\n    cell_value = StrConv(cell_value, vbLowerCase)\n    \n    If reg.Test(cell_value) Then\n        If reg_nokv.Test(cell_value) Then\n            cells.Value2 = cells.Text & \"kV\"\n            \n            If cells.comment Is Nothing Then\n                With cells.AddComment\n                    .Visible = False\n                    .Text Cell_RESOLVED\n                End With\n            End If\n            \n            cells.comment.Text Cell_RESOLVED\n\n        End If\n    ElseIf cell_value <> \"\" Then\n        comment_cell cell:=cells _\n                            , comment:=\"电压值格式不正确.列必须是以下四种格式之一:±数字kv,数字kv,±数字,数字。kv大小写都可以，不能带有其他字符\"\n    End If\nNext_cell_update_voltage_value:\nNext\n\n\n\nSet reg = Nothing\nSet reg_nokv = Nothing\n\nEnd Sub\n\n'生成不重复的序列\nSub update_serial(data_table_range As Excel.Range _\n                        , province_name As String _\n                        , city_name As String _\n                        , data_table_name As String _\n                        , log_path As String)\nDim serial As String\nDim city_code As String\nDim data_cell As Excel.Range\nDim i As Integer\n\nDim u As Double, su As Double\nDim hh As Integer, mm As Integer, ss As Integer, sss As Integer\nDim tmp_str As String\n    \ndata_table_range.NumberFormat = \"@\"\n\nFor Each data_cell In data_table_range\n    \n    If Not (data_cell.comment Is Nothing) Then\n        If InStr(data_cell.comment.Text, Cell_RESOLVED) > 0 Then\n            GoTo Next_cell_update_serial\n        End If\n    End If\n\n    u = Timer\n    mm = Int(u / 60)\n    su = u - mm * 60#\n    ss = Int(su)\n    sss = CLng((su - ss) * 1000)\n    hh = Int(mm / 60)\n    mm = Int(mm / 60)\n    serial = CLng(Date) & hh & mm & ss & sss\n    \n    \n    Randomize\n    tmp_str = serial & Int(10 * Rnd)\n    Randomize\n    tmp_str = tmp_str & Int(10 * Rnd)\n    Randomize\n    tmp_str = tmp_str & Int(10 * Rnd)\n    Randomize\n    tmp_str = tmp_str & Int(10 * Rnd)\n    Randomize\n    data_cell.Value2 = tmp_str & Int(10 * Rnd)\n    \n    If data_cell.comment Is Nothing Then\n        With data_cell.AddComment\n            .Visible = False\n            .Text Cell_RESOLVED\n        End With\n    Else\n        data_cell.Text = Cell_RESOLVED\n    End If\n    \n      \nNext_cell_update_serial:\nNext\n\nEnd Sub\n\n'分析字符串中是否有的电压等级,如果有，返回该电压等级的code\nFunction get_voltage(str As String)\nDim i As Integer\nDim reg As Object\n\nSet reg = CreateObject(\"vbscript.regexp\")\n    \n    '1000kV-----------------------------\n    With reg\n    .Global = True\n    .Pattern = \"(1000)\"\n    End With\n    \n    If reg.Test(str) Then\n        get_voltage = 12\n        GoTo end_get_voltage\n    End If\n    \n    '750kV-----------------------------\n    With reg\n    .Global = True\n    .Pattern = \"(750)\"\n    End With\n    \n    If reg.Test(str) Then\n        get_voltage = 17\n        GoTo end_get_voltage\n    End If\n    \n    '500kV-----------------------------\n    With reg\n    .Global = True\n    .Pattern = \"(500)\"\n    End With\n    \n    If reg.Test(str) Then\n        get_voltage = 7\n        GoTo end_get_voltage\n    End If\n    \n    '330kV-----------------------------\n    With reg\n    .Global = True\n    .Pattern = \"(330)\"\n    End With\n    \n    If reg.Test(str) Then\n        get_voltage = 13\n        GoTo end_get_voltage\n    End If\n    \n    '220kV-----------------------------\n    With reg\n    .Global = True\n    .Pattern = \"(220)\"\n    End With\n    \n    If reg.Test(str) Then\n        get_voltage = 6\n        GoTo end_get_voltage\n    End If\n    \n    '110kV-----------------------------\n    With reg\n    .Global = True\n    .Pattern = \"(110)\"\n    End With\n    \n    If reg.Test(str) Then\n        get_voltage = 5\n        GoTo end_get_voltage\n    End If\n    \n    '66kV-----------------------------\n    With reg\n    .Global = True\n    .Pattern = \"(66)\"\n    End With\n    \n    If reg.Test(str) Then\n        get_voltage = 16\n        GoTo end_get_voltage\n    End If\n    \n    '35kV-----------------------------\n    With reg\n    .Global = True\n    .Pattern = \"(35)\"\n    End With\n    \n    If reg.Test(str) Then\n        get_voltage = 4\n        GoTo end_get_voltage\n    End If\n    \n    '10kV-----------------------------\n    With reg\n    .Global = True\n    .Pattern = \"(10)\"\n    End With\n    \n    If reg.Test(str) Then\n        get_voltage = 3\n        GoTo end_get_voltage\n    End If\n    \n    '±1100kV-----------------------------\n    With reg\n    .Global = True\n    .Pattern = \"(±1100)\"\n    End With\n    \n    If reg.Test(str) Then\n        get_voltage = 30\n        GoTo end_get_voltage\n    End If\n    \n    '±800kV-----------------------------\n    With reg\n    .Global = True\n    .Pattern = \"(±800)\"\n    End With\n    \n    If reg.Test(str) Then\n        get_voltage = 31\n        GoTo end_get_voltage\n    End If\n    \n    '±660kV-----------------------------\n    With reg\n    .Global = True\n    .Pattern = \"(±660)\"\n    End With\n    \n    If reg.Test(str) Then\n        get_voltage = 32\n        GoTo end_get_voltage\n    End If\n    \n    '±500kV-----------------------------\n    With reg\n    .Global = True\n    .Pattern = \"(±500)\"\n    End With\n    \n    If reg.Test(str) Then\n        get_voltage = 33\n        GoTo end_get_voltage\n    End If\n    \n    '±400kV-----------------------------\n    With reg\n    .Global = True\n    .Pattern = \"(±400)\"\n    End With\n    \n    If reg.Test(str) Then\n        get_voltage = 34\n        GoTo end_get_voltage\n    End If\n    \n    '±250kV-----------------------------\n    With reg\n    .Global = True\n    .Pattern = \"(±250)\"\n    End With\n    \n    If reg.Test(str) Then\n        get_voltage = 38\n        GoTo end_get_voltage\n    End If\n    \n    '±225kV-----------------------------\n    With reg\n    .Global = True\n    .Pattern = \"(±225)\"\n    End With\n    \n    If reg.Test(str) Then\n        get_voltage = 37\n        GoTo end_get_voltage\n    End If\n    \n    '±125kV-----------------------------\n    With reg\n    .Global = True\n    .Pattern = \"(±125)\"\n    End With\n    \n    If reg.Test(str) Then\n        get_voltage = 35\n        GoTo end_get_voltage\n    End If\n    \n    '±120kV-----------------------------\n    With reg\n    .Global = True\n    .Pattern = \"(±120)\"\n    End With\n    \n    If reg.Test(str) Then\n        get_voltage = 36\n        GoTo end_get_voltage\n    End If\n\n\nget_voltage = 2012      '2012 说明没有找到\n\nend_get_voltage:\nEnd Function\n\n'分析字符串中是否有的变压器编号,如果有，返回该变压器编号\nFunction get_BYQ_NO(str As String)\nDim i As Integer\nDim reg As Object\n\nSet reg = CreateObject(\"vbscript.regexp\")\n    \n    '1\n    With reg\n    .Global = True\n    .Pattern = \"(1号)|(1主)|(1#)|(#1)|一\"\n    End With\n    \n    If reg.Test(str) Then\n        get_BYQ_NO = 1\n        GoTo end_get_BYQ_NO\n    End If\n    \n    '2\n    With reg\n    .Global = True\n    .Pattern = \"(2号)|(2主)|(2#)|二\"\n    End With\n    \n    If reg.Test(str) Then\n        get_BYQ_NO = 2\n        GoTo end_get_BYQ_NO\n    End If\n    \n    '3\n    With reg\n    .Global = True\n    .Pattern = \"(3号)|(3主)|(3#)|三\"\n    End With\n    \n    If reg.Test(str) Then\n        get_BYQ_NO = 3\n        GoTo end_get_BYQ_NO\n    End If\n    \n    '4\n    With reg\n    .Global = True\n    .Pattern = \"(4号)|(4主)|(4#)|四\"\n    End With\n    \n    If reg.Test(str) Then\n        get_BYQ_NO = 4\n        GoTo end_get_BYQ_NO\n    End If\n    \nget_BYQ_NO = 2012\n    \nend_get_BYQ_NO:\nEnd Function\n\n\n\n'获得变电站名称，线路名称中有关地点的信息\n'str        输入为小写\nFunction get_addressinfo(str As String)\nDim i As Integer\n\n\n'str = Replace(str, \"330\", \"\")\n'str = Replace(str, \"750\", \"\")\n'str = Replace(str, \"500\", \"\")\n'str = Replace(str, \"220\", \"\")\n'str = Replace(str, \"110\", \"\")\n'str = Replace(str, \"66\", \"\")\n'str = Replace(str, \"35\", \"\")\n\nstr = Replace(str, \"kv\", \"\")\nstr = Replace(str, \"变电\", \"\")\n\nstr = Replace(str, \"风力\", \"\")\nstr = Replace(str, \"风\", \"\")\nstr = Replace(str, \"发电\", \"\")\nstr = Replace(str, \"热电\", \"\")\nstr = Replace(str, \"水电\", \"\")\nstr = Replace(str, \"火电\", \"\")\nstr = Replace(str, \"电\", \"\")\nstr = Replace(str, \"厂\", \"\")\nstr = Replace(str, \"场\", \"\")\n\n\nstr = Replace(str, \"站\", \"\")\nstr = Replace(str, \"主变\", \"\")\nstr = Replace(str, \"变\", \"\")\nstr = Replace(str, \"主\", \"\")\nstr = Replace(str, \"压器\", \"\")\nstr = Replace(str, \"路\", \"\")\nstr = Replace(str, \"线\", \"\")\nstr = Replace(str, \"回\", \"\")\nstr = Replace(str, \"号\", \"\")\nstr = Replace(str, \"-\", \"\")\nstr = Replace(str, \"一\", \"\")\nstr = Replace(str, \"二\", \"\")\nstr = Replace(str, \"三\", \"\")\nstr = Replace(str, \"i\", \"\")\n\nFor i = 0 To 9\n    str = Replace(str, i, \"\")\nNext\n\nget_addressinfo = str\n\nEnd Function\n\n'获得数据字典的编码\nFunction get_code(str As String, code_type As Integer)\n\nEnd Function\n\n'判断10kV以下线路开关号\nFunction get_SWITCH_NO(str As String)\nDim i As Integer\n\nFor i = 1 To Len(str)\n    If IsNumeric(Mid(str, i, 1)) Then\n        get_SWITCH_NO = Val(Right(str, Len(str) - i + 1))\n        GoTo end_get_SWITCH_NO\n    End If\nNext\n\nget_SWITCH_NO = CInt(2012)\n\nend_get_SWITCH_NO:\nEnd Function\n\n\n'根据子表的值在父表中查询，将子表的外键替换为父表的主键值\n'slave_table_range                  子表数据集\n'slave_foreign_col                  子表外键列\n'slave_table_name                   子表名\n'master_table_name                  父表名\n'master_start_row                   父表记录起始行\n'master_mainkey_col                 父表主键列\n'slave_verify_col()                 0 子表区域列号，1 子表电压列号\n'master_verify_col()                0 父表区域列号，1 父表电压列号,2 父表设备名称列号\n'province_name                      省名\n'city_name                          地市名\n'log_path                           日志文件路径\nSub master_to_slave(slave_table_range As Excel.Range _\n                    , slave_forkey_range As Excel.Range _\n                    , slave_table_name As String _\n                    , master_table_name As String _\n                    , master_start_row As Integer _\n                    , master_mainkey_col As Integer _\n                    , slave_verify_col() As Integer _\n                    , master_verify_col() As Integer _\n                    , province_name As String _\n                    , city_name As String _\n                    , log_path As String)\n                    \nDim slave_cell As Excel.Range\nDim master_cell As Excel.Range\n\nDim master_wb As Excel.Workbook\nDim master_ws As Excel.Worksheet\nDim master_mainkey_range As Excel.Range\nDim master_table_range As Excel.Range\nDim master_table_bottom As Integer\n\nDim search_value As String\n\nDim m_count As Long\nDim s_count As Long\n\nDim finded_count As Long                '最后发现主表记录匹配的位置\nDim finded_flag As Boolean              '\n\nfinded_count = 1\nfinded_flag = False\n\nDim master_str As String\nDim i As Integer\n\nDim search_value_voltage As Integer, master_str_voltage As Integer\nDim search_address_info As String, master_address_info As String\nDim search_no As Integer, master_no As Integer\n\nDim slave_verify_area(1) As String, slave_verify_voltage(1) As String\nDim master_verify_area, master_verify_voltage\n\n\nSet master_wb = Workbooks.Open(slave_table_range.Parent.Parent.path & \"/\" & master_table_name & \".xls\")\nSet master_ws = master_wb.Worksheets(1)\n\nDim temp_array() As Variant\n\nmaster_table_bottom = compare_bottom_row(master_ws)\n\nSet master_table_range = _\n            master_ws.Range(master_ws.cells(master_start_row, master_verify_col(2)), master_ws.cells(master_table_bottom, master_verify_col(2)))\n\nSet master_mainkey_range = _\n            master_ws.Range(master_ws.cells(master_start_row, master_mainkey_col), master_ws.cells(master_table_bottom, master_mainkey_col))\n\ns_count = 1\nDo While s_count <= slave_table_range.Count\n    \n    Set slave_cell = slave_table_range.Item(s_count)\n    slave_cell.NumberFormatLocal = \"@\"\n    \n    \n    '从上次循环发现的位置开始\n    m_count = finded_count\n    finded_flag = True\n    Do While m_count <= master_table_range.Count\n    \n        search_value = StrConv(slave_cell.Text, vbLowerCase)\n        \n        Set master_cell = master_table_range.Item(m_count)\n        master_str = StrConv(master_cell.Text, vbLowerCase)\n        \n        search_value_voltage = get_voltage(search_value)\n        master_str_voltage = get_voltage(master_str)\n        \n        search_address_info = Trim(get_addressinfo(search_value))\n        master_address_info = Trim(get_addressinfo(master_str))\n        \n        '变压器运行数据需要判断变压器编号\n        If slave_table_range.Parent.Name = \"变压器运行数据\" And _\n            slave_table_range.Column = 7 Then\n            search_no = Trim(get_BYQ_NO(StrConv(slave_cell.Text, vbLowerCase)))\n            master_no = Trim(get_BYQ_NO(StrConv(master_cell.Text, vbLowerCase)))\n        End If\n        \n        '10kV线路运行数据需要判断出口开关的开关号\n        If slave_table_range.Parent.Parent.Name = \"10(20、6)kV线路运行数据.xls\" And _\n            slave_table_range.Column = 7 Then\n            search_no = get_SWITCH_NO(StrConv(slave_cell.Text, vbLowerCase))\n            master_no = get_SWITCH_NO(StrConv(master_cell.Text, vbLowerCase))\n        End If\n        \n        slave_verify_area(0) = slave_cell.Parent.cells(slave_cell.row, slave_verify_col(0)).Text\n        master_verify_area = master_cell.Parent.cells(master_cell.row, master_verify_col(0)).Text\n        \n        slave_verify_voltage(0) = slave_cell.Parent.cells(slave_cell.row, slave_verify_col(1)).Text\n        master_verify_voltage = master_cell.Parent.cells(master_cell.row, master_verify_col(1)).Text\n        \n        '字符串里是否有电压信息\n        '如果有电压信息，则判断是否相同；再判断地理信息是否相同；再判断区域信息是否相同；如果三者都相同，匹配\n        '如果没有电压信息，则从电压列调信息\n        If search_value_voltage <> 2012 And master_str_voltage <> 2012 Then\n            \n            '判断电压是否相等\n            If master_str_voltage = search_value_voltage Then\n            \nverify_voltage_equal:\n                '判断地理信息是否相同,如果是变压器匹配，还要判断变压器编号是否相同\n                If (StrComp(search_address_info, master_address_info) = 0) And _\n                    search_no = master_no Then\n                    \n                    '判断区域是否相同\n                    If ((master_verify_area = slave_verify_area(0)) Or _\n                    (master_verify_area = array_substr_single(gov_code(), slave_verify_area()))) Then\n                        \n                        If slave_forkey_range.cells(s_count).comment Is Nothing Then\n                            slave_forkey_range.cells(s_count).AddComment\n                            slave_forkey_range.cells(s_count).comment.Visible = False\n                        End If\n                        \n                        slave_forkey_range.cells(s_count).comment.Text _\n                            Chr(10) & \"原值为:\" & slave_cell.Text & \",匹配值为:\" & master_cell.Text\n                        \n                        \n                        slave_forkey_range.cells(s_count).Value2 = _\n                            CStr(master_mainkey_range.cells(m_count).Value2)\n                            \n                        '记录主表发现的位置，下次循环优先使用这个位置\n                        finded_count = m_count\n                        \n                        slave_forkey_range.cells(s_count).NumberFormat = \"@\"\n                            \n                        GoTo NextSerach\n                    '如果不相同，但如果是包含关系，则也替换\n                    '如果区域信息的后两位为0，说明是一个较宽泛层次区域，则替换为较狭窄层次区域\n                    ElseIf Right(master_verify_area, 2) = \"00\" Or _\n                            Right(slave_verify_area(0), 2) = \"00\" Or _\n                            Right(array_substr_single(gov_code(), slave_verify_area()), 2) = \"00\" Then\n                                \n                        slave_forkey_range.cells(s_count).NumberFormatLocal = \"@\"\n                        \n                        If slave_forkey_range.cells(s_count).comment Is Nothing Then\n                            slave_forkey_range.cells(s_count).AddComment\n                            slave_forkey_range.cells(s_count).comment.Visible = False\n                        End If\n                        \n                        slave_forkey_range.cells(s_count).comment.Text _\n                            Chr(10) & \"原值为:\" & slave_cell.Text & \",匹配值为:\" & master_cell.Text\n                        \n                        \n                        slave_forkey_range.cells(s_count).Value2 = _\n                            master_mainkey_range.cells(m_count).Value2\n                            \n                        GoTo NextSerach\n\n                    End If\n                Else\n                    '如果finded_flag为true，说明是使用最后一次主表位置查找没有找到而跳到下次循环\n                    If finded_flag Then\n                        m_count = 0\n                        finded_flag = False\n                    End If\n                    GoTo next_master_search\n                End If\n                \n            Else\n                If finded_flag Then\n                        m_count = 0\n                        finded_flag = False\n                End If\n                GoTo next_master_search\n            End If\n        \n        ElseIf ( _\n                (master_verify_voltage = slave_verify_voltage(0)) Or _\n                (master_verify_voltage = CDbl(get_voltage(slave_verify_voltage(0)))) _\n                ) Then\n                \n                '设备名称里没有电压信息，但是确认用电压等级相同,跳到电压相同处理方式\n                GoTo verify_voltage_equal\n                \n        '这里的slave_verify_voltage处理的是发电厂类型信息\n        ElseIf ( _\n                (master_verify_voltage = slave_verify_voltage(0)) Or _\n                (master_verify_voltage = array_substr_multi(pub_domain_code(), slave_verify_voltage(0), 4194537)) _\n                ) Then\n                \n                '设备名称里没有电压信息，但是确认用电压等级相同,跳到电压相同处理方式\n                GoTo verify_voltage_equal\n        \n        '站内母线第10列-所属变电站\n        '开关台帐第10列-所属变电站\n        '并联电容电抗器第5列-所属变电站\n        '不需要匹配电压信息，因此不用电压信息匹配\n        ElseIf (slave_table_range.Parent.Name = \"站内母线\" And slave_table_range.Column = 10) Or _\n                (slave_table_range.Parent.Name = \"开关台账\" And slave_table_range.Column = 10) Or _\n                (slave_table_range.Parent.Name = \"并联电容电抗器\" And slave_table_range.Column = 5) Then\n            GoTo verify_voltage_equal\n            \n        End If\n        \nnext_master_search:\n    m_count = m_count + 1\n    Loop\n    \n    If m_count > master_table_range.Count Then\n        comment_cell cell:=slave_cell _\n                        , comment:=Chr(10) & \"变电站/线路不存在。\"\n    End If\n    \nNextSerach:\ns_count = s_count + 1\nLoop\n\nmaster_wb.Close saveChanges:=False\nEnd Sub\n\n'非空检查\nSub check_No_Null(data_table_range As Excel.Range _\n                        , province_name As String _\n                        , city_name As String _\n                        , data_table_name As String _\n                        , log_path As String)\n\nDim data_cell As Excel.Range\n\nFor Each data_cell In data_table_range\n\n    If data_cell.Text = \"\" Then\n        Call log.error(log_path:=log_path _\n                                , msg:=\"该列必填.\" & city_name & \"表\" & data_table_name & \"第\" & data_cell.Column & \"列必填\")\n            comment_cell cell:=data_cell _\n                                , comment:=\"该列必填.\" & city_name & \"表\" & data_table_name & \"第\" & data_cell.Column & \"列必填\"\n    End If\n\nNext\n\nEnd Sub\n\n'清空所有单元格\nSub value_to_null(data_table_range As Excel.Range _\n                        , province_name As String _\n                        , city_name As String _\n                        , data_table_name As String _\n                        , log_path As String)\n                        \nDim data_cell As Excel.Range\n\nFor Each data_cell In data_table_range\n\n    data_cell.Value2 = \"\"\n\nNext\n\nEnd Sub\n\n'填入指定的值,\n'用于填入area_type,省填1，地市填2\nSub input_special_value(data_table_range As Excel.Range _\n                        , spec_value As String)\n                        \nDim data_cell As Excel.Range\n\nFor Each data_cell In data_table_range\n\n    data_cell.Value2 = spec_value\nNext\nEnd Sub\n\n\n'输入DEPTID\nSub input_deptid(data_table_range As Excel.Range _\n                        , unit_name As String)\n\nDim org_id As String\nDim i As Integer\nDim main_ws As Excel.Worksheet\n\nSet main_ws = Workbooks(\"checkscript.xlsm\").Worksheets(2)\n\ni = 2\nDo While main_ws.cells(i, 1).Text <> \"\"\n\n    If StrComp(main_ws.cells(i, 1).Text, unit_name, vbTextCompare) = 0 Then\n        org_id = main_ws.cells(i, 2).Text\n        Exit Do\n    End If\n\n    i = i + 1\nLoop\n\ninput_special_value data_table_range, org_id\n\nEnd Sub\n\n'根据确认列，将子表的值替换为父表的值,使用：电抗器\n'slave_foreign_col                  子表外键列\n'slave_table_name                   子表名\n'master_table_name                  父表名\n'master_start_row                   父表记录起始行\n'master_mainkey_col                 父表主键列\n'slave_verify_col()                 0 子表所属变电站编号，1 子表所连母线名称\n'master_verify_col()                0 父表变电站编号，1 父表母线名称,2 未使用\n'province_name                      省名\n'city_name                          地市名\n'log_path                           日志文件路径\nSub master_to_slave_dkq(slave_forkey_range As Excel.Range _\n                    , slave_table_name As String _\n                    , master_table_name As String _\n                    , master_start_row As Integer _\n                    , master_mainkey_col As Integer _\n                    , slave_verify_col() As Integer _\n                    , master_verify_col() As Integer _\n                    , province_name As String _\n                    , city_name As String _\n                    , log_path As String)\n                    \n'Dim slave_cell As Excel.Range\n'Dim master_cell As Excel.Range\n\nDim master_wb As Excel.Workbook\nDim master_ws As Excel.Worksheet\nDim master_mainkey_range As Excel.Range\nDim master_table_bottom As Integer\n\nDim slave_ws As Excel.Worksheet\nDim slave_table_start As Integer\nDim slave_table_bottom As Long\n\n\nDim slave_verify_range_zero As Excel.Range, slave_verify_range_one As Excel.Range\nDim master_verify_range_zero As Excel.Range, master_verify_range_one As Excel.Range\n\nDim s_count As Integer, m_count As Integer\n\n\nSet master_wb = Workbooks.Open(slave_forkey_range.Parent.Parent.path & \"/\" & master_table_name & \".xls\")\nSet master_ws = master_wb.Worksheets(1)\n\nmaster_table_bottom = compare_bottom_row(master_ws)\n\nSet master_mainkey_range = _\n            master_ws.Range(master_ws.cells(master_start_row, master_mainkey_col), _\n            master_ws.cells(master_table_bottom, master_mainkey_col))\n\nSet master_verify_range_zero = _\n            master_ws.Range(master_ws.cells(master_start_row, master_verify_col(0)), _\n            master_ws.cells(master_table_bottom, master_verify_col(0)))\n\nIf master_verify_col(1) <> 0 Then\n    Set master_verify_range_one = _\n                master_ws.Range(master_ws.cells(master_start_row, master_verify_col(1)), _\n                master_ws.cells(master_table_bottom, master_verify_col(1)))\nEnd If\n            \nSet slave_ws = slave_forkey_range.Parent\n\nslave_table_start = slave_forkey_range.Item(0).row\nslave_table_bottom = slave_forkey_range.Item(slave_forkey_range.Count).row\n\nSet slave_verify_range_zero = _\n            slave_ws.Range(slave_ws.cells(4, slave_verify_col(0)), _\n                            slave_ws.cells(slave_table_bottom, slave_verify_col(0)))\n                            \nIf slave_verify_col(1) <> 0 Then\n    Set slave_verify_range_one = _\n                slave_ws.Range(slave_ws.cells(4, slave_verify_col(1)), _\n                                slave_ws.cells(slave_table_bottom, slave_verify_col(1)))\nEnd If\n\ns_count = 1\nDo While s_count <= slave_forkey_range.Count\n\n    \n    m_count = 1\n    Do While m_count <= master_mainkey_range.Count\n\n        If StrComp(CStr(slave_verify_range_one(s_count)), _\n                    CStr(master_verify_range_one(m_count))) = 0 Then\nVERIFY_ONE_NO_NEED:\n            If StrComp(CStr(slave_verify_range_zero(s_count).Value2), _\n                        CStr(master_verify_range_zero(m_count).Value2)) = 0 Then\n                \n                slave_forkey_range.cells(s_count).NumberFormatLocal = \"@\"\n                        \n                        If slave_forkey_range.cells(s_count).comment Is Nothing Then\n                            slave_forkey_range.cells(s_count).AddComment\n                            slave_forkey_range.cells(s_count).comment.Visible = False\n                        End If\n                        \n                        slave_forkey_range.cells(s_count).comment.Text _\n                            Chr(10) & \"原值为:\" & slave_verify_range_one(s_count).Text & _\n                            \",匹配值为:\" & master_verify_range_one(m_count).Text\n                        \n                        \n                        slave_forkey_range.cells(s_count).Value2 = _\n                            master_mainkey_range.cells(m_count).Value2\n                            \n                        GoTo NextSerach\n                        \n            End If\n        '站内母线-第23列投运日期不需要确认第一项。\n        ElseIf (slave_forkey_range.Parent.Name = \"站内母线\" And slave_forkey_range.Column = 23) Then\n            GoTo VERIFY_ONE_NO_NEED\n        End If\n    \n    m_count = m_count + 1\n    Loop\n    \n    If m_count > slave_forkey_range.Count Then\n        comment_cell cell:=slave_verify_range_one(s_count) _\n                        , comment:=Chr(10) & \"找不到所属母线/变电站。\"\n    End If\n    \nNextSerach:\ns_count = s_count + 1\nLoop\n\nmaster_wb.Close saveChanges:=False\nEnd Sub","description":""},{"copy":0,"tags":[],"key":"673de52b88bcf8172d75f1726a986942b5724cac","createAt":1541637698735,"updateAt":1541639670933,"name":"copySingleColumnRange","lang":"VBScript","value":"''copy value of single column range to another range\n''@sRange   :   source range,range cell can be merged\n''@tRange   :   target range,range cell can be merged\nSub copySingleColumnRange(ByRef sRange As Range, ByRef tRange As Range)\nDim sc As Range, tc As Range\n\nSet sc = sRange.Item(1)\nSet tc = tRange.Item(1)\n\nDo Until (sc.row > sRange.Item(sRange.Count).row) Or (tc.row > tRange.Item(tRange.Count).row)\n    tc.Value2 = sc.Value2\n    Set tc = tc.Offset(rowOffset:=1, columnOffset:=0)\n    Set sc = sc.Offset(rowOffset:=1, columnOffset:=0)\nLoop\n\nEnd Sub","description":""},{"copy":0,"tags":[],"key":"0e2e84b8666c53eaa31956f2f31915e6596a5d3b","createAt":1541637743105,"updateAt":1541637743105,"name":"crackVBAPassword.vbs","lang":"VBScript","value":"Private Sub VBAPassword() '你要解保护的Excel文件路径\nFilename = Application.GetOpenFilename(\"Excel文件（*.xls & *.xla & *.xlt）,*.xls;*.xla;*.xlt\", , \"VBA破解\")\nIf Dir(Filename) = \"\" Then\nMsgBox \"没找到相关文件,清重新设置。\"\nExit Sub\nElse\nFileCopy Filename, Filename & \".bak\" '备份文件。\nEnd If\nDim GetData As String * 5\nOpen Filename For Binary As #1\nDim CMGs As Long\nDim DPBo As Long\nFor i = 1 To LOF(1)\nGet #1, i, GetData\nIf GetData = \"CMG=\"\"\" Then CMGs = i\nIf GetData = \"[Host\" Then DPBo = i - 2: Exit For\nNext\nIf CMGs = 0 Then\nMsgBox \"请先对VBA编码设置一个保护密码...\", 32, \"提示\"\nExit Sub\nEnd If\n\nDim St As String * 2\nDim s20 As String * 1\n'取得一个0D0A十六进制字串\nGet #1, CMGs - 2, St\n'取得一个20十六制字串\nGet #1, DPBo + 16, s20\n'替换加密部份机码\nFor i = CMGs To DPBo Step 2\nPut #1, i, St\nNext\n'加入不配对符号\nIf (DPBo - CMGs) Mod 2 <> 0 Then\nPut #1, DPBo + 1, s20\nEnd If\nMsgBox \"文件解密成功......\", 32, \"提示\"\nClose #1\nEnd Sub","description":""},{"copy":0,"tags":[],"key":"dbdf64dfe95891996bdeeff0baeb945ea943248b","createAt":1541637787835,"updateAt":1541637787835,"name":"createFile","lang":"VBScript","value":"'根据输入的文件路径，产生一个指定的文件，如果指定的路径下存在一个同名的文件，就先删除该文件\n'@ FilePath 文件绝对路径\nSub createFile(FilePath As String)\nDim fso As Object\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n\nIf fso.FileExists(FilePath) Then\n    fso.DeleteFile (FilePath)\nEnd If\n\nDim oFile As Object\nSet oFile = fso.CreateTextFile(FilePath)\n\noFile.WriteLine \"--'** author:kursk.ye@gmail.com **\"\noFile.Close\n\nSet fso = Nothing\nSet oFile = Nothing\n\nEnd Sub","description":""},{"copy":0,"tags":[],"key":"d1e3aa78cbfc4b651468c52f550b0966fc5b080a","createAt":1541637823703,"updateAt":1541637823703,"name":"getBitmapColor","lang":"VBScript","value":"'根据指定的range范围内查询单元格的颜色，返回符合iColor颜色的的位置和值\n'range  指定范围\n'iColor 指定颜色\n'multiArr 二维数组,第二维的顺序是 行号,列号,值 行号,列号,值 [[row1, col1, value1],[row2, col2, value2] ... ]\n'return number 符合条件的单元格数量(考虑合并单元格的情况)，同时这个值也是二维数组实际有值的长度\nFunction getBitmapColor(range As range, iColor As Long, ByRef multiArr() As Variant)\nDim cellArr(2) As Variant                   '单元格的行号,列号,值组成的数组\nDim i As Long                               '单元格索引号\nDim iCell As range                          '单元格\nDim number As Integer                       '找到的符合要求的单元格数量\nDim exist As Boolean                        '是否存在的标识，true存在,false不存在\n\n\nFor iIndexCell = 1 To range.Count\n    If range.Item(iIndexCell).Interior.Color = iColor Then\n        Set iCell = range.Item(iIndexCell).MergeArea    '考虑合并单元格的情况\n        cellArr(0) = iCell.row\n        cellArr(1) = iCell.column\n        cellArr(2) = iCell.Item(1).Value2\n        \n        exist = existMultiArray(multiArr, cellArr)\n        If exist = False Then\n            pushMultiArray multiArr, cellArr, number\n            number = number + 1\n        End If\n    End If\nNext\n\ngetBitmapColor = number\n\n\nEnd Function\n\n'在一个多维数组中检查一个数组是否存在\n'多维数组第二维的长度为3\n'如果存在返回 true，否则返回false\nFunction existMultiArray(ByRef multiArr() As Variant, checkedArr() As Variant)\nDim index As Integer\n\nFor index = LBound(multiArr) To UBound(multiArr)\n    If multiArr(index, 0) = checkedArr(0) _\n        And multiArr(index, 1) = checkedArr(1) _\n        And multiArr(index, 2) = checkedArr(2) Then\n            existMultiArray = True\n            Exit Function\n    End If\nNext\n\nexistMultiArray = False\n\nEnd Function\n\n'在一个多维数组中压入一个新元素\n'多维数组第二维的长度为3,新元素的维度长度也为3\n'multiArr 多维数组\n'pushedArr 被压入的元素,长度为3的一维数组\n'lastBound 被压入的位置，从0开始\nSub pushMultiArray(ByRef multiArr() As Variant, pushedArr() As Variant, lastBound As Integer)\n\n\n'ReDim multiArr(length + 1, 2) As Variant  'VBA语法此处不能使用redim 二维数组\n\nmultiArr(lastBound, 0) = pushedArr(0)\nmultiArr(lastBound, 1) = pushedArr(1)\nmultiArr(lastBound, 2) = pushedArr(2)\n\nEnd Sub","description":""},{"copy":0,"tags":[],"key":"11e4117b5b10f1d651873ddd3bcc4434b4ac8886","createAt":1541637930795,"updateAt":1541637930795,"name":"getCoordFromMirrorColumnRange","lang":"VBScript","value":"''return source cell or merged cell with compare source range and target range\n''''EXAMPLE\n''| source  |                                                 | target      |\n''| range   |                                                  | range     |\n''|             |                                                 |               |\n''|   ABC   |    compare value one by one      |               |\n''|             |                                                |               |\n''|             |                                                |   ABC     |\n''|             |                                                |               |\n''\n''return source range and target range \"ABC\" cell ,\n''if this cell is mered cell ,and return merged first cell and last cell\n''parameter\n''sRange    :   source range\n''tRange    :   target range\n''sCellArrr :   array,\n''if searched cell is not merge, then return array has only element which is cell\n''if searched cell is merged, first element return mergearea range ,second and third element\n''  is merged range first cell and last cell\n''tCellArr  :   array, same as above but target range\n''\nSub getCoordFromMirrorColumnRange(sRange As Range, tRange As Range, ByRef sCellArr() As Range, ByRef tCellArr() As Range)\nDim sCell As Range, tCell As Range\n\nSet sCell = sRange.Item(1)\nSet tCell = tRange.Item(1)\n\nDo Until (sCell.row > sRange.Item(sRange.Count).row)\n\n    Do Until (tCell.row > tRange.Item(tRange.Count).row)\n\n    If sCell.Value2 = tCell.Value2 Then\n        returnMergedFirstAndLastCell sCell, sCellArr\n        returnMergedFirstAndLastCell tCell, tCellArr\n        Exit Sub\n    End If\n\n    Set tCell = tCell.Offset(rowOffset:=1, columnOffset:=0)\n    Loop\n\nSet sCell = sCell.Offset(rowOffset:=1, columnOffset:=0)\nLoop\n\n\nEnd Sub\n\n''if cell is not merged ,only return this cell in arr()\n''if cell is merged, the first element of arr() is the mergearea range,\n''second element and third element is first cell and last cell of merged range\n''@cell :   merged range\n''@arr  :   return arr() contain cell\nSub returnMergedFirstAndLastCell(cell As Range, ByRef arr() As Range)\nReDim arr(2)\n\nIf cell.MergeCells Then\n    Set arr(0) = cell.MergeArea\n    Set arr(1) = cell.Item(1)\n    Set arr(2) = cell.Item(cell.MergeArea.Count)\nElse\n    Set arr(0) = cell\nEnd If\n\nEnd Sub","description":""},{"copy":0,"tags":[],"key":"b093a1539a62b79bd7922f38cf7c84196a225692","createAt":1541637973681,"updateAt":1541637973681,"name":"getCoordSpecialValueFromRange","lang":"VBScript","value":"''return a cell whic value equal special value from a Range\n'' if return cell is a merged cell then return mergearea\n''@search   :   string be found\n''@range    :   range be found\nFunction getCoordSpecialValueFromRange(search As String, r As Range) As Range\nDim c As Range\n\nFor Each c In r\n    If StrComp(c.Value2, search, 1) = 0 Then\n        If c.MergeCells Then\n            Set getCoordSpecialValueFromRange = c.MergeArea\n            Exit Function\n        Else\n            Set getCoordSpecialValueFromRange = c\n            Exit Function\n        End If\n\n    End If\nNext\nEnd Function","description":""},{"copy":0,"tags":[],"key":"f4efc81f754bc31aced839ee147766f3d5b5111a","createAt":1541638029985,"updateAt":1541638029985,"name":"ShowSubFolders","lang":"VBScript","value":"dim grade\n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nobjStartFolder = \"D:\\HdkjWok\"\n\nSet objFolder = objFSO.GetFolder(objStartFolder)\ngrade = 0\nWscript.Echo \"--\" & grade & \"--  \"  & objFolder.Path\n\nSet colFiles = objFolder.Files\n\nFor Each objFile in colFiles\n    Wscript.Echo objFile.Name\nNext\nWscript.Echo\n\nShowSubfolders objFSO.GetFolder(objStartFolder), grade+1\n\nSub ShowSubFolders(Folder, grade)\n    For Each Subfolder in Folder.SubFolders\n        echoGrade grade\n        Wscript.Echo Subfolder.Name\n        Set objFolder = objFSO.GetFolder(Subfolder.Path)\n        Set colFiles = objFolder.Files\n        For Each objFile in colFiles\n            Wscript.Echo objFile.Name\n        Next\n        Wscript.Echo\n        ShowSubFolders Subfolder, grade+1\n    Next\nEnd Sub\n\nSub echoGrade(grade)\nWscript.Stdout.Write \"FG:\" & grade\nFor i = 1 to grade\n    Wscript.Stdout.Write \"--\"\nnext\nEnd Sub","description":""},{"copy":0,"tags":[],"key":"ad12a94e90d84f1c08865b82e68e26d20efb41d5","createAt":1541638259221,"updateAt":1541638259221,"name":"getLastRowAndCol","lang":"VBScript","value":"Public Const MAX_TIMES = 40        '比较次数，经过times比较次数的比较得出的行号或列号才是最大值\nPublic Const MAX_NULL_CELL = 30     '找到一个内容的单元格后，探索性继续搜索的最多数量单元格\n\n'返回给定worksheet有内容的单元格的最下列的行号和列号\n'@return row_col是一个2字符长度的数组，下标0是行号，下标1是列号\nSub getLastRowAndCol(ws As Excel.Worksheet, Optional ByRef lastRow As long, Optional ByRef lastCol As long)\nDim row_col(2) As Integer\n\nlastRow = getBottomRow(ws)\nlastCol = getLastRightCol(ws)\n\nEnd Sub\n\n'通过MAX_TIMES次测试比较得到最底行,返回worksheet最下一行的行号\nFunction getBottomRow(ws As Excel.Worksheet)\n\nDim a As Long, b As Long, c As Long\nDim max As Long\nDim randomCol As Integer\nDim bottomRow As Long\nDim i As Long\n\nbottomRow = 1 '初始bottomRow为1\ni = 1\n\nDo While i <= MAX_TIMES\n    randomCol = Int((i + 2) * Rnd + i)\n\n    a = getSpecialLastRow(ws, randomCol)\n    b = getSpecialLastRow(ws, randomCol + 1)\n    c = getSpecialLastRow(ws, randomCol + 2)\n\n    max = max_three(a, b, c)\n\n    If (max > bottomRow) Then\n        bottomRow = max\n        i = 1\n    Else\n        i = i + 1\n    End If\n\nLoop\n\ngetBottomRow = bottomRow\n\nEnd Function\n\n'获得某一个列的最底行,该函数思想是：遍历指定列的所有单元格，当找到一个单元格的值不为空时，将该单元格的\n'行号设为最底行，然后继续向下搜索，并开始计数；如果下方还有单元格的值不为空，则将重新设置最底行的值，并将\n'计数器清零，重新开始向下探索；直到计数器的值大于MAX_NULL_CELL,则返回该列的最底行数值.\nFunction getSpecialLastRow(ws As Excel.Worksheet, test_col As Integer)\n\nDim row, col As Long\nDim last_bottom As Long\nDim null_row_number As Integer\n\n\nrow = 1\ncol = test_col\nnull_row_number = 0\n\nDo While True\n    If ws.Cells(row, col).Text = \"\" And null_row_number < MAX_NULL_CELL Then\n        If null_row_number = 0 Then\n            last_bottom = row - 1\n        End If\n\n        null_row_number = null_row_number + 1\n    ElseIf ws.Cells(row, col).Text <> \"\" And null_row_number > 0 Then\n        last_bottom = row\n        null_row_number = 0\n    ElseIf null_row_number >= MAX_NULL_CELL Then\n        getSpecialLastRow = last_bottom\n        Exit Do\n    End If\n\n    row = row + 1\nLoop\n\nEnd Function\n\n'3值比较\nFunction max_three(b1 As Long, b2 As Long, b3 As Long)\n\nIf b1 >= b2 Then\n    If b1 >= b3 Then\n        max_three = b1\n    Else\n        max_three = b3\n    End If\nElseIf b2 >= b3 Then\n    max_three = b2\nElse\n    max_three = b3\nEnd If\n\nEnd Function\n\n'通过MAX_TIMES次测试比较,返回worksheet有内容单元格的最右边的列号\nFunction getLastRightCol(ws As Excel.Worksheet)\n\nDim a As Long, b As Long, c As Long\nDim max As Long\nDim randomRow As Integer\nDim rightCol As Long\nDim i As Long\n\nrightCol = 1 '初始rightCol为1\ni = 1\n\nDo While i <= MAX_TIMES\n    randomRow = Int((i + 2) * Rnd + i)\n\n    a = getSpecialRightCol(ws, randomRow)\n    b = getSpecialRightCol(ws, randomRow + 1)\n    c = getSpecialRightCol(ws, randomRow + 2)\n\n    max = max_three(a, b, c)\n\n    If (max > rightCol) Then\n        rightCol = max\n        i = 1\n    Else\n        i = i + 1\n    End If\n\nLoop\n\ngetLastRightCol = rightCol\n\n\nEnd Function\n\n'指定worksheet的行号，返回该行最右边有内容的单元格的列号,与getSpecialLastRow的思路相同\n'@ sheet\n'@ row  指定行号\nFunction getSpecialRightCol(sheet As Excel.Worksheet _\n                , row As Integer)\nDim lastCol As Integer\nDim cell As Excel.Range\nDim j As Integer, counter As Integer\n\ncounter = 0\nlastCol = 0\nj = 0\n\nDo\n    j = j + 1\n    Set cell = sheet.Cells(row, j)\n\n    If cell.Value2 <> \"\" Then\n        lastCol = j\n        counter = 0\n    Else\n        counter = counter + 1\n\n        If counter > MAX_NULL_CELL Then\n            getSpecialRightCol = lastCol\n            Exit Function\n        End If\n\n    End If\nLoop While True\n\nEnd Function","description":""},{"copy":0,"tags":[],"key":"2936cc85f0132d7860220f4408ab3ae3075e402a","createAt":1541638303933,"updateAt":1541638303933,"name":"getMergedFirstAndLastCell","lang":"VBScript","value":"''if cell is not merged ,only return this cell in arr()\n''if cell is merged, the first element of arr() is the mergearea range,\n''second element and third element is first cell and last cell of merged range\n''@cell :   merged range\n''@arr  :   return arr() contain cell\nSub getMergedFirstAndLastCell(cell As Range, ByRef arr() As Range)\nReDim arr(2)\n\nIf cell.MergeCells Then\n    Set arr(0) = cell.MergeArea\n    Set arr(1) = cell.Item(1)\n    Set arr(2) = cell.Item(cell.MergeArea.Count)\nElse\n    Set arr(0) = cell\nEnd If\n\nEnd Sub","description":""},{"copy":0,"tags":[],"key":"ea64cc94215a78d2298b828bbb44da144c5222f4","createAt":1541638332767,"updateAt":1541638332767,"name":"getSpeicalFolderFiles","lang":"VBScript","value":"''return array of files in a input folder\n''@path     :   path of folder\n''@search   :   if \"\" then return all files in folder, or return file contain searched string\n''@return   :   array contain files ,variant data type\nSub getSpeicalFolderFiles(ByRef filesArr() As Variant, path As String, search As String)\n\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n\nFor Each f In fso.GetFolder(path).Files\n    If search = \"\" Then\n       pushArray f, filesArr\n    ElseIf InStr(f.Name, search) > 0 Then\n       pushArray f, filesArr\n    End If\nNext\n\nEnd Sub","description":""},{"copy":0,"tags":[],"key":"4cad2df0aa216f0a10cc4599dba0ba709898f78b","createAt":1541638380087,"updateAt":1541638380087,"name":"ouputRedirect","lang":"VBScript","value":"Set objShell = WScript.CreateObject(\"WScript.Shell\")\nstrRun = \"%comspec% /c ipconfig.exe > \" & AddQuotes(\"d:\\ipconfig.txt\")\nobjShell.Run strRun, 1, True\n\nFunction AddQuotes(strInput)\nAddQuotes = Chr(34) & strInput & Chr(34)\nEnd Function","description":""},{"copy":0,"tags":[],"key":"d79ea0023ab57543706ae1b6ef43fdf4b601100c","createAt":1541638416811,"updateAt":1541638416811,"name":"pad","lang":"VBScript","value":"'*********************************************************************\n   'Declarations section of the module.\n '*********************************************************************\n   Option Explicit\n   Dim x As Integer\n   Dim PadLength As Integer\n\n '=====================================================================\n   'The following function will left pad a string with a specified\n   'character. It accepts a base string which is to be left padded with\n   'characters, a character to be used as the pad character, and a\n   'length which specifies the total length of the padded result.\n '=====================================================================\n   Function Lpad (MyValue$, MyPadCharacter$, MyPaddedLength%)\n\n      Padlength = MyPaddedLength - Len(MyValue)\n      Dim PadString As String\n      For x = 1 To Padlength\n         PadString = PadString & MyPadCharacter\n      Next\n      Lpad = PadString + MyValue\n\n   End Function\n\n '=====================================================================\n   'The following function will right pad a string with a specified\n   'character. It accepts a base string which is to be right padded with\n   'characters, a character to be used as the pad character, and a\n   'length which specifies the total length of the padded result.\n '=====================================================================\n   Function Rpad (MyValue$, MyPadCharacter$, MyPaddedLength%)\n\n      Padlength = MyPaddedLength - Len(MyValue)\n      Dim PadString As String\n      For x = 1 To Padlength\n         PadString = MyPadCharacter & PadString\n      Next\n      Rpad = MyValue + PadString\n\n   End Function","description":""},{"copy":0,"tags":[],"key":"560ed615e2f538b2f8a01c599260708651536313","createAt":1541638457055,"updateAt":1541638457055,"name":"setCellNumberFormatPercentag","lang":"VBScript","value":"'将用户鼠标所选择的区域的单元格格式设置为百分比类型\nPrivate Sub CommandButton1_Click()\nDim r As Excel.Range\nDim cell As Excel.Range\n\nSet r = selection\n\n\nFor Each cell In r\n    cell.NumberFormat = \"0.00%\"\n    cell.Value2 = cell.Value2 & \"%\"\nNext\n\nEnd Sub","description":""},{"copy":0,"tags":[],"key":"93b2a1d71f7363069a7826bd42cd3e60fe3a009c","createAt":1541638490635,"updateAt":1541638490635,"name":"SheetExists","lang":"VBScript","value":"''determine one worksheet exist\n''@shtName  :   string\n''@wb       :   workbook\n''return boolean\nFunction SheetExists(shtName As String, Optional wb As Workbook) As Boolean\n\nDim sht As Worksheet\n\nIf wb Is Nothing Then Set wb = ThisWorkbook\n\nOn Error Resume Next\nSet sht = wb.Sheets(shtName)\nOn Error GoTo 0\nSheetExists = Not sht Is Nothing\n\nEnd Function","description":""},{"copy":0,"tags":[],"key":"4e9c35bef738fd2fbbaaabdcc3eb46529ca992da","createAt":1541638518496,"updateAt":1541638518496,"name":"sort","lang":"VBScript","value":"''******************************************************************************************************************\nSub sortBubble(ByRef arr As Variant)\nDim i As Long, j As Long\nDim temp As Variant\n\ni = 0\n\nDo Until i > UBound(arr)\n\n    j = UBound(arr)\n    Do Until j <= i\n\n    If arr(i) < arr(j) Then\n        temp = arr(i)\n        arr(i) = arr(j)\n        arr(j) = temp\n    End If\n\n    j = j - 1\n    Loop\n\ni = i + 1\nLoop\nEnd Sub\n\n\n''******************************************************************************************************************\n''  sort a array by rank,same value of element should be same rank,from big to small\n''  @sortArr    :   array by sorted\n''  @rankArr    :   array used to rank\n''  @arr1       :   another array,could be sort with sortArr\nSub sortArrayRank(ByRef sortArr() As Variant, ByRef rankArr() As Integer, Optional ByRef arr1 As Variant)\nDim rankNo As Long, i As Long\n\nsortBubble sortArr, arr1\n\nrankNo = 1\n\nFor i = 0 To UBound(sortArr)\n    If i = 0 Then\n        rankArr(i) = rankNo\n    Else\n\n        If sortArr(i) = sortArr(i - 1) Then\n            rankArr(i) = rankNo\n        Else\n            rankNo = rankNo + 1\n            rankArr(i) = rankNo\n        End If\n\n    End If\nNext\n\nEnd Sub","description":""},{"copy":0,"tags":[],"key":"6b36b1a5ceaf2c277f4434ef179a2904ac99848d","createAt":1541638546321,"updateAt":1541638546321,"name":"superMidStr","lang":"VBScript","value":"'在一个字符串中查询两个字符串，并将该字符串在两者之间的字符串返回。\n'@ str           需要查询的字符串\n'@ startStr      查找的第一个字符串\n'@ endStr        查找的第二个字符串\nFunction superMidStr(str As String, startStr As String, endStr As String)\n    superMidStr = Mid(str, (InStr(str, startStr) + 1), (InStr(str, endStr) - (InStr(str, startStr))))\nEnd Function","description":""},{"copy":0,"tags":[],"key":"291e947b8ddcd1da601803a430518c774a7c808f","createAt":1541638604739,"updateAt":1541638604739,"name":"vote","lang":"VBScript","value":"dim ip1\ndim ip2\ndim ip3\ndim ip4\ndim ip\ndim ShellCMD\ndim objShell\n\ndim h1\ndim h2\ndim h3\ndim h4\ndim h5\ndim h6\ndim h7\ndim h8\ndim h9\ndim h10\ndim h11\ndim url\ndim postData\ndim fakeIpHeader\n\ndim count\ndim i\n\ni = 0\ncount = 10\n\nip1 = 10\nip2 = 2\nip3 = 252\nip4 = 1\n\nh1 = \"-H\" & \" \" & chr(34) & \"x-requested-with: XMLHttpRequest\" & chr(34) & \" \"\nh2 = \"-H\" & \" \" & chr(34) &  \"Accept-Language: zh-cn\"& chr(34) & \" \"\nh3 = \"-H\" & \" \" & chr(34) &  \"Referer: http://sgtv.sgcc.com.cn/publish/gwgsh/\"& chr(34) & \" \"\nh4 = \"-H\" & \" \" & chr(34) &  \"Accept: */*\"& chr(34) & \" \"\nh5 = \"-H\" & \" \" & chr(34) &  \"Content-Type: application/x-www-form-urlencoded\"& chr(34) & \" \"\nh6 = \"-H\" & \" \" & chr(34) &  \"Accept-Encoding: gzip, deflate\"& chr(34) & \" \"\nh7 = \"-H\" & \" \" & chr(34) &  \"User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)\"& chr(34) & \" \"\nh8 = \"-H\" & \" \" & chr(34) &  \"Host: sgtv.sgcc.com.cn \" & chr(34) & \" \"\nh9 = \"-H\" & \" \" & chr(34) &  \"Content-Length: 8\"& chr(34) & \" \"\nh10 = \"-H\" & \" \" & chr(34) &  \"Connection: Keep-Alive\"& chr(34) & \" \"\nh11 = \"-H\" & \" \" & chr(34) &  \"Pragma: no-cache\"& chr(34) & \" \"\n\nurl = \"http://sgtv.sgcc.com.cn/plus/zan.php?dopost=send\"\npostData = \" -d \" & \" \" & chr(34) &  \"aid=8408\"& chr(34) & \" \"\n\n\ndo while ip1 <= 10\n\ndo while ip2 <= 2\n\ndo while ip3 <= 254\n\n    do while ip4 <= 254\n    \t\n    \t \t\t\n    \t ip = ip1 & \".\" & ip2 & \".\" & ip3 & \".\" & ip4\n       fakeIpHeader = \"-H\" & \" \" & chr(34) &  \"x-forwarded-for: \" & ip & chr(34) & \" \"\n       ShellCMD = \"curl\" & \" \" & h1 & h2 & h3 & h4 & h5 & h6 & h7 & h8 & h9 & h10 & h11 &  fakeIpHeader & \" \" & url & postData\n\n       Set objShell = WScript.CreateObject(\"WScript.Shell\")\n       strRun =  ShellCMD  & \" -o  D:\\software\\vote_output.log\"\n       SESSION_ID=objShell.Run(strRun)\n\n       wscript.echo ip\n       wscript.echo strRun\n\n       'wscript.sleep 500\n\t\t\t i = i + 1       \n\n\n    ip4 = ip4 + 1\n    loop\n\n    ip4 = 1\n    ip3 = ip3 + 1\nloop\n\n\nip3 = 1\nip2 = ip2 + 1\nloop\n\nip2 = 1\nip1 = ip1 + 1\nloop\n\n\nwscript.echo \"good work!\"\n\n\n\nFunction AddQuotes(strInput)\nAddQuotes = Chr(34) & strInput & Chr(34)\nEnd Function","description":""},{"copy":0,"tags":[],"key":"66fa135c3de8e54ed9291bbf231f40466cf370b3","createAt":1541638702410,"updateAt":1541638702410,"name":"binaryInsertionSort","lang":"JavaScript","value":"// 从第一个元素开始，该元素可以认为已经被排序；\n// 取出下一个元素，在已经排序的元素序列中二分查找到第一个比它大的数的位置；\n// 将新元素插入到该位置后；\n// 重复上述两步。\n\nfunction binaryInsertionSort(array) {\n\tif (Object.prototype.toString.call(array).slice(8,-1) == \"Array\") {\n\t\tfor (var i = 1; i < array.length; i++) {\n\t\t\tvar key = array[i]\n\t\t\t   ,left = 0\n\t\t\t   ,right = i-1;\n\n\t\t\twhile( left <= right ) {\n\t\t\t\tvar middle = parseInt((left+right)/2);\n\t\t\t\tif ( array[middle] < key ) {\n\t\t\t\t\tleft = middle+1;\n\t\t\t\t} else{\n\t\t\t\t\tright = middle-1;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (var j=i-1; j>=left; j--){\n\t\t\t\tarray[j+1] = array[j];\n\t\t\t}\n\n\t\t\tarray[left] = key;\n \t\t};\n\n \t\treturn array;\n\t} else{\n\t\treturn array + \" isn't a array\";\n\t};\n}\n\n\nvar array = [9,2,4,5,6,5,3,1,0];\n// var array = [1,4,1];\nconsole.log(binaryInsertionSort(array));","description":""},{"copy":0,"tags":[],"key":"31f2e1f9f3ab2c0f1ce5c2d7856ebfc3fbcfb528","createAt":1541638738684,"updateAt":1541638738684,"name":"bucketSort","lang":"JavaScript","value":"桶排序\n\n1）算法简介\n\n桶排序 (Bucket sort)的工作的原理：假设输入数据服从均匀分布，将数据分到有限数量的桶里，每个桶再分别排序（有可能再使用别的排序算法或是以递归方式继续使用桶排序进行排序）。\n\n2）算法描述和实现\n\n具体算法描述如下：\n\n设置一个定量的数组当作空桶；\n遍历输入数据，并且把数据一个一个放到对应的桶里去；\n对每个不是空的桶进行排序；\n从不是空的桶里把排好序的数据拼接起来。\nJavaScript代码实现：\n\n/*方法说明：桶排序\n@param  array 数组\n@param  num   桶的数量*/\nfunction bucketSort(array, num) {\n    if (array.length <= 1) {\n        return array;\n    }\n\n    var len = array.length, \n        buckets = [], \n        result = [], \n        min = max = array[0], \n        regex = '/^[1-9]+[0-9]*$/', \n        space, \n        n = 0;\n\n    num = num || ((num > 1 && regex.test(num)) ? num : (len-2));\n    //number of buckets must less than length of sorted array\n\n    for (var i = 1; i < len; i++) {\n        min = min <= array[i] ? min : array[i];\n        max = max >= array[i] ? max : array[i];\n    }\n\n    space = (max - min + 1) / num;\n\n    for (var j = 0; j < len; j++) {\n        var index = Math.floor((array[j] - min) / space);\n        if (buckets[index]) {   //  非空桶，插入排序\n            var k = buckets[index].length - 1;\n            while (k >= 0 && buckets[index][k] > array[j]) {\n                buckets[index][k + 1] = buckets[index][k];\n                k--;\n            }\n            buckets[index][k + 1] = array[j];\n        } else {    //空桶，初始化\n            buckets[index] = [];\n            buckets[index].push(array[j]);\n        }\n    }\n\n    while (n < num) {\n\t    if (bucket[n]){\n\t      result = bucket[n].concat(result);\n\t    } \n\t    n++;\n    }\n\n    return result;\n}\n3）算法分析\n\n桶排序最好情况下使用线性时间O(n)，桶排序的时间复杂度，取决与对各个桶之间数据进行排序的时间复杂度，因为其它部分的时间复杂度都为O(n)。很显然，桶划分的越小，各个桶之间的数据越少，排序所用的时间也会越少。但相应的空间消耗就会增大。","description":""},{"copy":0,"tags":[],"key":"7d8fd101a4aaefe6add4ac51b613dfa5414c57e0","createAt":1541638786704,"updateAt":1541638786704,"name":"countingSort","lang":"JavaScript","value":"/*\n1）算法简介\n\n计数排序(Counting sort)是一种稳定的排序算法。计数排序使用一个额外的数组C，其中第i个元素是待排序数组A中值等于i的元素的个数。然后根据数组C来将A中的元素排到正确的位置。它只能对整数进行排序。\n\n2）算法描述和实现\n\n具体算法描述如下：\n\n找出待排序的数组中最大和最小的元素；\n统计数组中每个值为i的元素出现的次数，存入数组C的第i项；\n对所有的计数累加（从C中的第一个元素开始，每一项和前一项相加）；\n反向填充目标数组：将每个元素i放在新数组的第C(i)项，每放一个元素就将C(i)减去1。\nJavaScript代码实现：\n*/\n\nfunction countingSort(array) {\n    var len = array.length, B = [], C = [], min = max = array[0];\n    for (var i = 0; i < len; i++) {\n        min = min <= array[i] ? min : array[i];\n        max = max >= array[i] ? max : array[i];\n        C[array[i]] = C[array[i]] ? C[array[i]] + 1 : 1;\n    }\n    for (var j = min; j < max; j++) {\n        C[j + 1] = (C[j + 1] || 0) + (C[j] || 0);\n    }\n    for (var k = len - 1; k >=0; k--) {\n        B[C[array[k]] - 1] = array[k];\n        C[array[k]]--;\n    }\n    return B;\n}\n\n/*\n3）算法分析\n\n当输入的元素是n 个0到k之间的整数时，它的运行时间是 O(n + k)。计数排序不是比较排序，排序的速度快于任何比较排序算法。由于用来计数的数组C的长度取决于待排序数组中数据的范围（等于待排序数组的最大值与最小值的差加上1），这使得计数排序对于数据范围很大的数组，需要大量时间和内存。\n*/\n","description":""},{"copy":0,"tags":[],"key":"d470ee79bf0640eceef764981083d74c4fd2eb9a","createAt":1541638817976,"updateAt":1541638817976,"name":"heapSort","lang":"JavaScript","value":"/*方法说明：堆排序\n\n1）算法简介\n\n堆排序（Heapsort）是指利用堆这种数据结构所设计的一种排序算法。堆积是一个近似完全二叉树的结构，并同时满足堆积的性质：即子结点的键值\n或索引总是小于（或者大于）它的父节点。\n\n2）算法描述和实现\n\n具体算法描述如下：\n\n将初始待排序关键字序列(R1,R2....Rn)构建成大顶堆，此堆为初始的无序区；\n将堆顶元素R[1]与最后一个元素R[n]交换，此时得到新的无序区(R1,R2,......Rn-1)和新的有序区(Rn),且满足R[1,2...n-1]<=R[n]；\n由于交换后新的堆顶R[1]可能违反堆的性质，因此需要对当前无序区(R1,R2,......Rn-1)调整为新堆，然后再次将R[1]与无序区最后一个元素交换，\n得到新的无序区(R1,R2....Rn-2)和新的有序区(Rn-1,Rn)。不断重复此过程直到有序区的元素个数为n-1，则整个排序过程完成。\n\n@param  array 待排序数组*/           \nfunction heapSort(array){\n\tvar temp,\n\t\theapSize=array.length;\n\n\tfor(var i=Math.floor(heapSize/2); i>=0; i--){\n\t\theapify(array, i, heapSize);\n\t}\n\n\tfor(var j=heapSize-1; j>=0; j--){\n\t\ttemp=array[0];\n\t\tarray[0]=array[j];\n\t\tarray[j]=temp;\n\t\theapify(array, 0, --heapSize);\n\t}\n}\n\n/*方法说明：维护堆的性质\n@param  arr 数组\n@param  x   数组下标\n@param  len 堆大小*/\nfunction heapify(arr, x, len){\n\tvar l = x * 2,\n\t\tr = x * 2 + 1,\n\t\tlargest = x,\n\t\ttemp;\n\n\tif ( l<len && arr[l]>arr[largest] ) largest=l;\n\tif ( r<len && arr[r]>arr[largest] ) largest=r;\n\n\tif ( x!==largest ){\n\t\ttemp=arr[x];\n\t\tarr[x]=arr[largest];\n\t\tarr[largest]=temp;\n\t\theapify(arr, largest, len);\n\t}\n}\n\nvar array = [5,4,6,0,2,3,1,7];\n\nconsole.log(array);\nheapSort(array);\nconsole.log(array);","description":""},{"copy":0,"tags":[],"key":"26d61ea2ab3ba65167ff1bfa0d29a2b38f5895a1","createAt":1541638840768,"updateAt":1541638840768,"name":"mergeSort","lang":"JavaScript","value":"function mergeSort(arr, p, r){\n  if(p<r){\n    var q = Math.floor((p+r)/2);\n    mergeSort(arr, p, q);\n    mergeSort(arr, q+1, r);\n    merge(arr, p, q, r);\n  }\n}\n\nfunction merge(arr, p, q, r){\n  var n1 = q - p + 1,\n      n2 = r - q,\n      left = [],\n      right = [],\n      m = n = 0;\n\n  for(var i=0; i<n1; i++){\n    left[i]=arr[p+i];\n  }\n\n  for(var j=0; j<n2; j++){\n    right[j]=arr[q+1+j];\n  }\n\n  left[n1]=right[n2]=Number.MAX_VALUE;\n\n  for(var k=p; k<=r; k++){\n    if (left[m]<right[n]){\n      arr[k]=left[m];\n      m++;\n    } else {\n      arr[k]=right[n];\n      n++;\n    }\n  }\n}","description":""},{"copy":0,"tags":[],"key":"90e40a9af638fd17ca7a158793e50f033bc7fb97","createAt":1541638865044,"updateAt":1541638865044,"name":"bubble_sort","lang":"JavaScript","value":"// $('body form table div img').attr('src','clock.jpg');\n// class=\"l-right-col\"\n// $('div').addClass(function(n){return \"div\"+n;});\n//$('#fontdiv').removeClass(\"font-red\");\n\nfunction bubble_sort(array){\n\tvar length = array.length\n\t   ,temp;\n\tfor(var i=0; i<length; i++) {\n\t\tfor(var j=length-1; j>i; j--){\n\t\t\tif (array[i]>array[j]){\n\t\t\t\ttemp = array[i];\n\t\t\t\tarray[i] = array[j];\n\t\t\t\tarray[j] = temp;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn array;\n}\n\nvar array = [2,34,5,90,12,87,0,23,76,34,15,23,12];\n\ndocument.write(\"<p>\" + array);\ndocument.write(\"<p>\" + bubble_sort(array));","description":""},{"copy":0,"tags":[],"key":"89dad544f88c23f7580f2e8f3bfae1aa878bc28e","createAt":1541638892106,"updateAt":1541638892106,"name":"insert_sort","lang":"JavaScript","value":"/**\n * 从第一个元素开始，该元素可以认为已经被排序；\n * 取出下一个元素，在已经排序的元素序列中从后向前扫描；\n * 如果该元素（已排序）大于新元素，将该元素移到下一位置；\n * 重复步骤3，直到找到已排序的元素小于或者等于新元素的位置；\n * 将新元素插入到该位置后；\n * 重复步骤2~5。\n **/\n\nfunction insert_sort(array){\n\tif (Object.prototype.toString.call(array).slice(8,-1) == \"Array\") {\n\t\tfor (var i = 0; i < array.length; i++) {\n\t\t\tvar key = array[i];\n\t\t\tvar j = i - 1;\n\t\t\twhile ( j>=0 && array[j]>key ) {\n\t\t\t\tarray[j+1] = array[j];\n\t\t\t\tj--;\n\t\t\t}\n\t\t\tarray[j+1] = key;\n\t\t};\n\t\treturn array;\n\t} else{\n\t\treturn array + \"is not a array\";\n\t};\n}\n\n///////////////////////////////\n//var array = [0,1,2,3,4,5]; //\n//var array = [5,4,3,2,1,0]; //\n//var array = [0,2,1,3,5,4]; //\n///////////////////////////////\nvar array = [1,1,3,2,1,5];\nconsole.log(insert_sort(array));","description":""},{"copy":0,"tags":[],"key":"eda68717a485a7a49940e095a3ed912ebebe528a","createAt":1541638914190,"updateAt":1541638914190,"name":"quick_sort1","lang":"JavaScript","value":"// 从数列中挑出一个元素，称为 \"基准\"（pivot）；在此算法中必须是最右边的元素\n// 重新排序数列，所有元素比基准值小的摆放在基准前面，所有元素比基准值大的摆在基准的后面（相同的数可以到任一边）。\n// 在这个分区退出之后，该基准就处于数列的中间位置。这个称为分区（partition）操作；\n// 递归地（recursive）把小于基准值元素的子数列和大于基准值元素的子数列排序。\n\nfunction quick_sort1(array,left,right){\n\tif (left<=right){\n\t\tvar x = array[right]\n\t\t   ,i = left - 1\n\t\t   ,temp;\n\t\tfor ( var j=left; j<=right; j++){\n\t\t\tif (array[j]<=x) {\n\t\t\t\ti++;\n\t\t\t\ttemp = array[j];\n\t\t\t\tarray[j] = array[i];\n\t\t\t\tarray[i] = temp;\n\t\t\t}\n\t\t}\n\n\t\tquick_sort1(array,left,i-1);\n\t\tquick_sort1(array,i+1,right);\n\t}\n}\n\nvar array = [2,34,5,90,12,87,0,23,76,34,15,23,12,2];\n\ndocument.write(\"<p>\" + array);\nquick_sort1(array,0,(array.length-1));\ndocument.write(\"<p>\" + array);","description":""},{"copy":0,"tags":[],"key":"ca4f10253cc96a9da2f13bc5693796cd4bf52798","createAt":1541638936326,"updateAt":1541638936326,"name":"selectSort","lang":"JavaScript","value":"// 初始状态：无序区为R[1..n]，有序区为空；\n// 第i趟排序(i=1,2,3…n-1)开始时，当前有序区和无序区分别为R[1..i-1]和R(i..n）。\n// 该趟排序从当前无序区中选出关键字最小的记录 R[k]，将它与无序区的第1个记录R交换，使R[1..i]和R[i+1..n)分别变为记录个数增加1个的\n// 新有序区和记录个数减少1个的新无序区；\n// n-1趟结束，数组有序化了。\n\nfunction selectSort(array){\n\tif ( Object.prototype.toString.call(array).slice(8,-1) == \"Array\") {\n\t\tvar length = array.length;\n\t\tfor (var i = 0; i <length-1; i++) {\n\t\t\tvar min = array[i];\n\n\t\t\tfor(var j=i+1; j<length; j++) {\n\n\t\t\t\tif (array[j]<min) {\n\t\t\t\t\tvar temp = array[j];\n\t\t\t\t\t\tarray[j] = min;\n\t\t\t\t\t\tmin = temp;\n\t\t\t\t\t};\t\t\t\t\n\t\t\t}\n\n\t\t\tarray[i] = min;\n\t\t};\n\n\t\treturn array;\n\t} else{\n\t\treturn array + \" isn't a array\";\n\t};\n}\nvar array = [7,2,9,0,1,2,6,4,2,9,8,1]\n\nconsole.log(array);\nconsole.log(selectSort(array));","description":""},{"copy":0,"tags":[],"key":"014e5e160953ba3a336767f7f4927cd85a753444","createAt":1541639079742,"updateAt":1541639079742,"name":"arsync-response-order-dispaly   0-closure-solution","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\n\n\t\t<script type=\"text/javascript\">\n\t\t\tfunction xss_ajax(url, callback)\n\t\t\t{\n\t\t\t\tvar script_id = null;\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.setAttribute('type', 'text/javascript');\n\t\t\t\tscript.setAttribute('src', url);\n\t\t\t\tscript.setAttribute('id', 'coolshell_script_id');\n\n\t\t\t\tscript.onload = script.onreadystatechange = function(){\n\t\t\t\t\tif((!this.readyState || this.readyState === \"loaded\" || this.readyState === \"complete\")){\n\t\t\t\t\t\tcallback && callback();\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tscript_id = document.getElementById('coolshell_script_id');\n\t\t\t\tif(script_id){\n\t\t\t\t\tdocument.getElementsByTagName('head')[0].removeChild(script_id);\n\t\t\t\t}\n\n\t\t\t\t// Insert <script> into DOM\n\t\t\t\tdocument.getElementsByTagName('head')[0].appendChild(script);\n\t\t\t}\n\n\n\t\t\tfunction xss_rpc_call(n, callback)\n\t\t\t{\n\t\t\t\tvar callbackName=\"xss_rpc_callback\"  + Math.round(Math.random() * 10000);\n\t\t\t\tvar url = \"http://coolshell.cn/t.php?n=\"+n+\"&callback=\"+callbackName;\n\t\t\t\txss_ajax(url);\n\n\t\t\t\twindow[callbackName] = function(result){\n\t\t\t\t\tvar timeout = Math.round(Math.random() * 1000)\n\t\t\t\t\tcallback && setTimeout( function(){callback(result);}, timeout );\n\t\t\t\t\t//callback && callback(result) ;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar total = 20;\n\n\t\t\tfor(var i = 0; i< total; i++){\n\t\t\t\t(function(x){\n\t\t\t\t\txss_rpc_call(x,function(result){\n\t\t\t\t\t\tconsole.log(x + \",\" + result);\n\t\t\t\t\t});\n\t\t\t\t})(i);\n\t\t\t}\n\n\t\t</script>\n\n\t</body>\n</html>","description":"arsync-response-order-dispaly   0-closure-solution"},{"copy":0,"tags":[],"key":"142eed484356941863abbdd5766a8adfd0633366","createAt":1541639145316,"updateAt":1541639145316,"name":"arsync-response-order-dispaly 1-recursive-solution","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\n\n\t\t<script type=\"text/javascript\">\n\t\t\tfunction xss_ajax(url, callback)\n\t\t\t{\n\t\t\t\tvar script_id = null;\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.setAttribute('type', 'text/javascript');\n\t\t\t\tscript.setAttribute('src', url);\n\t\t\t\tscript.setAttribute('id', 'coolshell_script_id');\n\n\t\t\t\tscript.onload = script.onreadystatechange = function(){\n\t\t\t\t\tif((!this.readyState || this.readyState === \"loaded\" || this.readyState === \"complete\")){\n\t\t\t\t\t\tcallback && callback();\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tscript_id = document.getElementById('coolshell_script_id');\n\t\t\t\tif(script_id){\n\t\t\t\t\tdocument.getElementsByTagName('head')[0].removeChild(script_id);\n\t\t\t\t}\n\n\t\t\t\t// Insert <script> into DOM\n\t\t\t\tdocument.getElementsByTagName('head')[0].appendChild(script);\n\t\t\t}\n\n\n\t\t\tfunction xss_rpc_call(n, callback)\n\t\t\t{\n\t\t\t\tvar callbackName=\"xss_rpc_callback\"  + Math.round(Math.random() * 10000);\n\t\t\t\tvar url = \"http://coolshell.cn/t.php?n=\"+n+\"&callback=\"+callbackName;\n\t\t\t\txss_ajax(url);\n\n\t\t\t\twindow[callbackName] = function(result){\n\t\t\t\t\tvar timeout = Math.round(Math.random() * 1000)\n\t\t\t\t\tcallback && setTimeout( function(){callback(result);}, timeout );\n\t\t\t\t\t//callback && callback(result) ;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar total = 10;\n\t\t\t\n\t\t\trecursive_solution = function(i){\n\t\t\t\t\n\t\t\t\tif (i > total) return;\n\t\t\t\n\t\t\t\txss_rpc_call(i,function(result){\n\t\t\t\t\t\t\tconsole.log(i + \",\" + result);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\trecursive_solution(++i);\t\n\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t       \t\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\n\t\t\trecursive_solution(0);\n\n\t\t</script>\n\n\t</body>\n</html>","description":""},{"copy":0,"tags":[],"key":"e439fc2f8ee1a387d81a90b0d8e6b42f72e10dbf","createAt":1541639183186,"updateAt":1541639199093,"name":"arsync-response-order-dispaly  2-temp-array-storage-solution","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\n\n\t\t<script type=\"text/javascript\">\n\t\t\tfunction xss_ajax(url, callback)\n\t\t\t{\n\t\t\t\tvar script_id = null;\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.setAttribute('type', 'text/javascript');\n\t\t\t\tscript.setAttribute('src', url);\n\t\t\t\tscript.setAttribute('id', 'coolshell_script_id');\n\n\t\t\t\tscript.onload = script.onreadystatechange = function(){\n\t\t\t\t\tif((!this.readyState || this.readyState === \"loaded\" || this.readyState === \"complete\")){\n\t\t\t\t\t\tcallback && callback();\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tscript_id = document.getElementById('coolshell_script_id');\n\t\t\t\tif(script_id){\n\t\t\t\t\tdocument.getElementsByTagName('head')[0].removeChild(script_id);\n\t\t\t\t}\n\n\t\t\t\t// Insert <script> into DOM\n\t\t\t\tdocument.getElementsByTagName('head')[0].appendChild(script);\n\t\t\t}\n\n\n\t\t\tfunction xss_rpc_call(n, callback)\n\t\t\t{\n\t\t\t\tvar callbackName=\"xss_rpc_callback\"  + Math.round(Math.random() * 10000);\n\t\t\t\tvar url = \"http://coolshell.cn/t.php?n=\"+n+\"&callback=\"+callbackName;\n\t\t\t\txss_ajax(url);\n\n\t\t\t\twindow[callbackName] = function(result){\n\t\t\t\t\tvar timeout = Math.round(Math.random() * 1000)\n\t\t\t\t\tcallback && setTimeout( function(){callback(result);}, timeout );\n\t\t\t\t\t//callback && callback(result) ;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar total = 10;\n\n\t\t\tfunction array_solution(){\n\t\t\t\tvar array_msg =[total];\n\t\t\t\tvar callback;\n\t\t\t\tvar n =  total;\n\t\t\t\t\n\t\t\t\tfor(var i = 0; i<total; i++){\n\t\t\t\t\t(function(x){\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\treturn callback = function(msg){\n\n\t\t\t\t\t\t\tarray_msg[x] = msg;\n\t\t\t\t\t\t\tn--;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (n == 0){\n\t\t\t\t\t\t\t\tfor(var j = 0; j < array_msg.length; j++)\n\t\t\t\t\t\t\t\t\tconsole.log(j + \",\" + array_msg[j]);\n\t\t\t\t\t\t\t}\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})(i);\n\t\t\t\t  \n\t\t\t\t  xss_rpc_call(i,callback);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tarray_solution();\n\n\t\t</script>\n\n\t</body>\n</html>","description":""},{"copy":0,"tags":[],"key":"910e3c28f23a37d707eb816fddcc0cd6d3c11b98","createAt":1541639251946,"updateAt":1541639251946,"name":"arsync-response-order-dispaly 3-temp-array-storage-solution-optimize1","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\n\n\t\t<script type=\"text/javascript\">\n\t\t\tfunction xss_ajax(url, callback)\n\t\t\t{\n\t\t\t\tvar script_id = null;\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.setAttribute('type', 'text/javascript');\n\t\t\t\tscript.setAttribute('src', url);\n\t\t\t\tscript.setAttribute('id', 'coolshell_script_id');\n\n\t\t\t\tscript.onload = script.onreadystatechange = function(){\n\t\t\t\t\tif((!this.readyState || this.readyState === \"loaded\" || this.readyState === \"complete\")){\n\t\t\t\t\t\tcallback && callback();\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tscript_id = document.getElementById('coolshell_script_id');\n\t\t\t\tif(script_id){\n\t\t\t\t\tdocument.getElementsByTagName('head')[0].removeChild(script_id);\n\t\t\t\t}\n\n\t\t\t\t// Insert <script> into DOM\n\t\t\t\tdocument.getElementsByTagName('head')[0].appendChild(script);\n\t\t\t}\n\n\n\t\t\tfunction xss_rpc_call(n, callback)\n\t\t\t{\n\t\t\t\tvar callbackName=\"xss_rpc_callback\"  + Math.round(Math.random() * 10000);\n\t\t\t\tvar url = \"http://coolshell.cn/t.php?n=\"+n+\"&callback=\"+callbackName;\n\t\t\t\txss_ajax(url);\n\n\t\t\t\twindow[callbackName] = function(result){\n\t\t\t\t\tvar timeout = Math.round(Math.random() * 1000)\n\t\t\t\t\tcallback && setTimeout( function(){callback(result);}, timeout );\n\t\t\t\t\t//callback && callback(result) ;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t/*\n\t\t\t* 前面解决方案 2-temp-array-storage-solution 以及包括下面的方案都有一个共性的问题\n\t\t\t* 因为<script>是下载完执行，因此什么时候执行是不能控制。因此回调函数执行按顺序打印的代码时，有可能response[]已经返回，有可能还没有返回\n\t\t\t* 现在这个方案array_asap_solution当遇到response[]为undefined是就停止显示\n\t\t\t*/\n\n\t\t\tvar total = 10;\n\t\t\tvar start,end;\n\n\t\t\tfunction array_asap_solution ()\n\t\t\t{\n\t\t\t\tvar response = [total];\n\t\t\t\t\n\t\t\t\tfor(var i=0; i < total; i++)\n\t\t\t\t{\n\t\t\t\t\t(function(x){\n\t\t\t\t\t\txss_rpc_call(x, function(res){\n\t\t\t\t\t\t\t\tresponse[x] = res;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif ( x==0 ) {\n\t\t\t\t\t\t\t\t\tdisplay(x);\n\t\t\t\t\t\t\t\t} \n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t})(i);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfunction display(i)\t{\n\t\t\t\t\t\n\t\t\t\t\tif (i == total)\t{\n\t\t\t\t\t\t\n\t\t\t\t\t}\telse if (response[i])\t{\n\t\t\t\t\t\t\n\t\t\t\t\t\tconsole.log(i + ',' + response[i]);\n\t\t\t\t\t\t\n\t\t\t\t\t\tdisplay(i+1);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t\n\t\t\t}\n\n\t\t\tstart = new Date().getTime();\n\t\t\t\n\t\t\tarray_asap_solution();\n\t\t\t\n\t\t\t\n\n\t\t</script>\n\n\t</body>\n</html>","description":""},{"copy":0,"tags":[],"key":"4a4a3d056f8abd82ff28813ba141d446a134a3bd","createAt":1541639331198,"updateAt":1541639331198,"name":"arsync-response-order-dispaly 4-temp-array-storage-solution-optimize2","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\n\n\t\t<script type=\"text/javascript\">\n\t\t\tfunction xss_ajax(url, callback)\n\t\t\t{\n\t\t\t\tvar script_id = null;\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.setAttribute('type', 'text/javascript');\n\t\t\t\tscript.setAttribute('src', url);\n\t\t\t\tscript.setAttribute('id', 'coolshell_script_id');\n\n\t\t\t\tscript.onload = script.onreadystatechange = function(){\n\t\t\t\t\tif((!this.readyState || this.readyState === \"loaded\" || this.readyState === \"complete\")){\n\t\t\t\t\t\tcallback && callback();\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tscript_id = document.getElementById('coolshell_script_id');\n\t\t\t\tif(script_id){\n\t\t\t\t\tdocument.getElementsByTagName('head')[0].removeChild(script_id);\n\t\t\t\t}\n\n\t\t\t\t// Insert <script> into DOM\n\t\t\t\tdocument.getElementsByTagName('head')[0].appendChild(script);\n\t\t\t}\n\n\n\t\t\tfunction xss_rpc_call(n, callback)\n\t\t\t{\n\t\t\t\tvar callbackName=\"xss_rpc_callback\"  + Math.round(Math.random() * 10000);\n\t\t\t\tvar url = \"http://coolshell.cn/t.php?n=\"+n+\"&callback=\"+callbackName;\n\t\t\t\txss_ajax(url);\n\n\t\t\t\twindow[callbackName] = function(result){\n\t\t\t\t\tvar timeout = Math.round(Math.random() * 1000)\n\t\t\t\t\tcallback && setTimeout( function(){callback(result);}, timeout );\n\t\t\t\t\t//callback && callback(result) ;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * 相对于3-temp-array-storage-solution-optimize1 方案，通过在每个callback函数上都调用显示结果之前\n\t\t\t * 判断response[]数组里的除undefined之外的值是否达接近total的值(这里判断二者之差是否小于2)\n\t\t\t * 如果是就调用显示结果的函数\n\t\t\t * 但这里处理结果仍然不理想，当total过大时(实测超过200时)，会不调用显示结果的函数\n\t\t\t */\n\t\t\t \n\t\t\tvar total = 180;\n\t\t\tvar start, end;\n\n\t\t\tfunction array_asap_solution ()\n\t\t\t{\n\t\t\t\tvar response = [total];\n\t\t\t\t\n\t\t\t\tfor(var i=0; i < total; i++)\n\t\t\t\t{\n\t\t\t\t\t(function(x){\n\t\t\t\t\t\txss_rpc_call(x, function(res){\n\t\t\t\t\t\t\t\tresponse[x] = res;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif ( (total - response.filter(function(value) { return value !== undefined }).length) < 2  ) {\n\t\t\t\t\t\t\t\t\tdisplay(0);\n\t\t\t\t\t\t\t\t} \n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t})(i);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfunction display(i)\t{\n\t\t\t\t\t\n\t\t\t\t\tif (i == total)\t{\n\t\t\t\t\t\tend = new Date().getTime();\n\t\t\t\t\t\tconsole.log('exec escape time:' + (end - start));\n\t\t\t\t\t}\telse if (response[i])\t{\n\t\t\t\t\t\t\n\t\t\t\t\t\tconsole.log(i + ',' + response[i]);\n\t\t\t\t\t\t\n\t\t\t\t\t\tdisplay(i+1);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t\n\t\t\t}\n\n\t\t\tstart = new Date().getTime();\n\t\t\t\n\t\t\tarray_asap_solution();\n\t\t\t\n\t\t\t\n\n\t\t</script>\n\n\t</body>\n</html>","description":""},{"copy":0,"tags":[],"key":"20e06fbd09b4c73cb4646b1424c7a34578e30e60","createAt":1541639369762,"updateAt":1541639369762,"name":"arsync-response-order-dispaly 5-judge-previous-timeout","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\n\n\t\t<script type=\"text/javascript\">\n\t\t\tfunction xss_ajax(url, callback)\n\t\t\t{\n\t\t\t\tvar script_id = null;\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.setAttribute('type', 'text/javascript');\n\t\t\t\tscript.setAttribute('src', url);\n\t\t\t\tscript.setAttribute('id', 'coolshell_script_id');\n\n\t\t\t\tscript.onload = script.onreadystatechange = function(){\n\t\t\t\t\tif((!this.readyState || this.readyState === \"loaded\" || this.readyState === \"complete\")){\n\t\t\t\t\t\tcallback && callback();\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tscript_id = document.getElementById('coolshell_script_id');\n\t\t\t\tif(script_id){\n\t\t\t\t\tdocument.getElementsByTagName('head')[0].removeChild(script_id);\n\t\t\t\t}\n\n\t\t\t\t// Insert <script> into DOM\n\t\t\t\tdocument.getElementsByTagName('head')[0].appendChild(script);\n\t\t\t}\n\n\n\t\t\tfunction xss_rpc_call(n, callback)\n\t\t\t{\n\t\t\t\tvar callbackName=\"xss_rpc_callback\"  + Math.round(Math.random() * 10000);\n\t\t\t\tvar url = \"http://coolshell.cn/t.php?n=\"+n+\"&callback=\"+callbackName;\n\t\t\t\txss_ajax(url);\n\n\t\t\t\twindow[callbackName] = function(result){\n\t\t\t\t\tvar timeout = Math.round(Math.random() * 1000)\n\t\t\t\t\tcallback && setTimeout( function(){callback(result);}, timeout );\n\t\t\t\t\t//callback && callback(result) ;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * 相对于3-temp-array-storage-solution-optimize1 方案，通过在每个callback函数上都调用显示结果之前\n\t\t\t * 判断response[]数组里的除undefined之外的值是否达接近total的值(这里判断二者之差是否小于2)\n\t\t\t * 如果是就调用显示结果的函数\n\t\t\t * 但这里处理结果仍然不理想，当total过大时(实测超过200时)，会不调用显示结果的函数\n\t\t\t */\n\t\t\t \n\t\t\tvar total = 180;\n\t\t\tvar start, end;\n\n\t\t\tfunction array_asap_solution ()\n\t\t\t{\n\t\t\t\tvar response = [total];\n\t\t\t\t\n\t\t\t\tfor(var i=0; i < total; i++)\n\t\t\t\t{\n\t\t\t\t\t(function(x){\n\t\t\t\t\t\txss_rpc_call(x, function(res){\n\t\t\t\t\t\t\t\tresponse[x] = res;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif ( (total - response.filter(function(value) { return value !== undefined }).length) < 2  ) {\n\t\t\t\t\t\t\t\t\tdisplay(0);\n\t\t\t\t\t\t\t\t} \n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t})(i);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfunction display(i)\t{\n\t\t\t\t\t\n\t\t\t\t\tif (i == total)\t{\n\t\t\t\t\t\tend = new Date().getTime();\n\t\t\t\t\t\tconsole.log('exec escape time:' + (end - start));\n\t\t\t\t\t}\telse if (response[i])\t{\n\t\t\t\t\t\t\n\t\t\t\t\t\tconsole.log(i + ',' + response[i]);\n\t\t\t\t\t\t\n\t\t\t\t\t\tdisplay(i+1);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t\n\t\t\t}\n\n\t\t\tstart = new Date().getTime();\n\t\t\t\n\t\t\tarray_asap_solution();\n\t\t\t\n\t\t\t\n\n\t\t</script>\n\n\t</body>\n</html>","description":""},{"copy":0,"tags":[],"key":"99a7a2c23e3d5f71c7da3faf71f0a9c16146513d","createAt":1541639410504,"updateAt":1541639410504,"name":"arsync-response-order-dispaly 6-stability","lang":"JavaScript","value":"<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n\t<meta charset=\"UTF-8\">\n\t<title>Document</title>\n</head>\n<body>\n\t<script>\n\t/*\n\t * 这个解决方案的思路贴切现实中的自然原理.\n\t * 每个response 回调自己的 callback 函数，先判断response有没有返回并存入到temp[]数组中，并且上一个元素是否已经打印\n\t * 如果满足上述两个条件就打印，如果不满足，就延时执行\n\t * 这个解决方案非常稳定，但是需要修改服务端的API，增加返回值n\n\t * 相对于方案5，这个解决方案稳定性有了质的提升，当n=5000时依然不会停止响应，这个解决方案做了如下修改：\n\t * (1)将xss_rpc_call定义的全局函数callbakname由n个变为1个，减少了全局变量；\n\t * (2)在函数xss_rpc_call,rpc,cb,judge, handler, timeout中的i改使用传入参数,在调用callback时传递\n\t */\n\tfunction xss_ajax(url){\n\t\tvar script_el = document.createElement('script');\n\t\tvar script_node = null;\n\n\t\tscript_el.setAttribute('src',url);\n\t\tscript_el.setAttribute('type','text/javascript');\n\t\tscript_el.setAttribute('id','script_el');\n\n\t\tscript_node = document.getElementById('script_el');\n\n\t\tif (script_node) {\n\t\t\tdocument.getElementsByTagName('head')[0].removeChild(script_node);\n\t\t}\n\n\t\tdocument.getElementsByTagName('head')[0].appendChild(script_el);\n\t}\n\n\tfunction xss_rpc_call(w, callback, n){\n\t\t/*var callbakname = 'callback' + Math.round( Math.random() * 100 );*/\n\t\tvar callbakname = 'callback';\n\t\tvar url = 'http://127.0.0.1/exchange.php?n=' + n + '&callback=' + callbakname;\n\n\t\txss_ajax(url);\n\n\t\tw[callbakname] = function(msg,n){\n\t\t\tcallback && callback(msg,n);\n\t\t};\n\t}\n\n\tvar total = 1000;\n\n\tfor (var i = 0; i < total; i++) {\n\t\t(function(i){\n\t\t\tvar temp = new Array(total);\n\n\t\t\tfunction rpc(judge, handler, limit, timeout,i){\n\t\t\t\tvar t = 0\n\t\t\t\t\t,c\n\t\t\t\t\t,stoper = function(){\n\t\t\t\t\t\tclearTimeout(c);\n\t\t\t\t\t}\n\t\t\t\t\t,runner = function(){\n\t\t\t\t\t\tif (judge(i)) {\n\t\t\t\t\t\t\thandler(i);\n\t\t\t\t\t\t\tstoper(i);\n\t\t\t\t\t\t}else if(t>limit) {\n\t\t\t\t\t\t\ttimeout(i);\n\t\t\t\t\t\t\tstoper(i);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t else{\n\t\t\t\t\t\t\tc = setTimeout( runner, Math.round( Math.random() * 100 ) );\n\t\t\t\t\t\t\t++t;\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\trunner();\n\t\t\t}\n\n\t\t\tvar cb = function(result,i){\n\t\t\t\ttemp[i] = result;\n\n\t\t\t\tif (i==0) {\n\t\t\t\t\tconsole.log(i + ':' + result);\n\t\t\t\t\ttemp[i] = \"done\";\n\t\t\t\t} else{\n\t\t\t\t\trpc(\n\t\t\t\t\t\tfunction(i){\n\t\t\t\t\t\t\tif (temp[i] && temp[i-1] == \"done\") {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t,function(i){\n\t\t\t\t\t\t\tconsole.log(i + ':' + result);\n\t\t\t\t\t\t\ttemp[i] = \"done\";\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t,100\n\n\t\t\t\t\t\t,function(i){\n\t\t\t\t\t\t\tconsole.log('time is out ...');\n\t\t\t\t\t\t\ttemp[i] = \"done\";\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t,i\n\t\t\t\t\t);\n\t\t\t\t};\n\t\t\t}\n\n\t\t\txss_rpc_call(window, cb, i);\n\t\t}(i));\n\t}\n\t\t\n\t</script>\n</body>\n</html>","description":""},{"copy":0,"tags":[],"key":"3a96117d5552146d7c396858820be17226e270ce","createAt":1541639590494,"updateAt":1541639590494,"name":"js-Class-composition","description":"","files":[{"key":"e08bcc6e54656223a6f13e1ac29a1067b39f997f","name":"composition.html","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>test</title>\n\t</head>\n\t<body>\n\t<script src=\"set.js\"></script>\n\t<script type=\"text/javascript\">\n\tfunction extend(o, p){\n\t\tfor(var prop in p){\n\t\t\to[prop] = p[prop];\n\t\t}\n\t\treturn o;\n\t}\n\n\tfunction inherit(p){\n\t\tif (p==null) throw TypeError();\n\t\t\tvar t = typeof p;\n\t\t\tif ( t !== \"function\" && t !== \"object\") throw TypeError();\n\t\t\t\tif (Object.create) return Object.create(p);\n\t\t\t\t\tfunction fn(){};\n\t\t\t\t\tfn.prototype = p;\n\t\t\t\t\treturn new fn();\n\t}\n\n\tfunction defineSubClass(subclass, superclass, methods, statics){\n\t\tsubclass.prototype = inherit(superclass.prototype);\n\t\tsubclass.prototype.construct = subclass;\n\t\tif (methods) extend(subclass.prototype, methods);\n\t\tif (statics) extend(subclass, statics);\n\t\treturn subclass;\n\t}\n\n\t// We can also do this as a method of the superclass constructor\n\tFunction.prototype.extend = function(constructor, methods, statics) {\n\t    return defineSubclass(this, constructor, methods, statics);\n\t};\n\n\t/*\n\t * A FilteredSet wraps a specified set object and applies a specified filter\n\t * to values passed to its add() method.  All of the other core set methods\n\t * simply forward to the wrapped set instance.\n\t */\n\tvar FilteredSet = Set.extend(\n\t    function FilteredSet(set, filter) {  // The constructor\n\t        this.set = set;\n\t        this.filter = filter;\n\t    },\n\t    {  // The instance methods\n\t        add: function() {\n\t            // If we have a filter, apply it\n\t            if (this.filter) {\n\t                for(var i = 0; i < arguments.length; i++) {\n\t                    var v = arguments[i];\n\t                    if (!this.filter(v))\n\t                        throw new Error(\"FilteredSet: value \" + v +\n\t                                        \" rejected by filter\");\n\t                }\n\t            }\n\t            // Now forward the add() method to this.set.add()\n\t            this.set.add.apply(this.set, arguments);\n\t            return this;\n\t        },\n\t        // The rest of the methods just forward to this.set and do nothing else.\n\t        remove: function() {\n\t            this.set.remove.apply(this.set, arguments);\n\t            return this;\n\t        },\n\t        contains: function(v) { return this.set.contains(v); },\n\t        size: function() { return this.set.size(); },\n\t        foreach: function(f,c) { this.set.foreach(f,c); }\n\t    });\n\n\n\t</script>\n\n\t</body>\n</html>\n"},{"key":"268948fa36f28ced942eaee636ad25074f0ecd02","name":"set.js","value":"\tfunction Set() {\n\t    this.values = {};\n\t    this.n = 0;\n\t    this.add.apply(this, arguments);\n\t}\n\n\tSet._v2s = function(val) {\n\t    switch (val) {\n\t        case undefined:\n\t            return 'u';\n\t        case null:\n\t            return 'n';\n\t        case true:\n\t            return 't';\n\t        case false:\n\t            return 'f';\n\t        default:\n\t            switch (typeof val) {\n\t                case 'number':\n\t                    return '#' + val;\n\t                case 'string':\n\t                    return '\"' + val;\n\t                default:\n\t                    return '@' + objectId(val);\n\t            }\n\t    }\n\n\t    function objectId(o) {\n\t        var prop = \"|**objectid**|\";\n\t        if (!o.hasOwnProperty(prop))\n\t            o[prop] = Set._v2s.next++;\n\t        return o[prop];\n\t    }\n\t}\n\n\tSet.prototype.add = function() {\n\t    for (var i = 0; i < arguments.length; i++) {\n\t        var val = arguments[i];\n\t        var str = Set._v2s(val);\n\t        if (!this.values.hasOwnProperty[str]) {\n\t            this.values[str] = val;\n\t            this.n++;\n\t        }\n\t    }\n\t    return this;\n\t}\n\n\tSet.prototype.remove = function() {\n\t    for (var i = 0; i < arguments.length; i++) {\n\t        var str = Set._v2s(arguments[i]);\n\t        if (this.values.hasOwnProperty(str)) {\n\t            delete this.values[str];\n\t            this.n--;\n\t        }\n\t    }\n\t    return this;\n\t}\n\n\tSet.prototype.contains = function(value) {\n\t    return this.values.hasOwnProperty(Set._v2s(value));\n\t}\n\n\tSet.prototype.foreach = function(f, context) {\n\t    for (var s in this.values) {\n\t        if (this.values.hasOwnProperty(s)) {\n\t            f.call(context, this.values[s]);\n\t        }\n\t    }\n\t}\n\n\tSet._v2s.next = 100;"}]},{"copy":0,"tags":[],"key":"a8486ed2e8a0566e78d7e54ce6f4a37fc70ed74e","createAt":1541639884333,"updateAt":1541639884333,"name":"client-server-parse-requestResponse","description":"","files":[{"key":"23db21494f7460d191664de6948be62ecfe8c973","name":"client.html","value":"<html>\n\t<head>\n\t</head>\n\t<body>\n\t\t<script>\nfunction getTextSync(url) {\n    var request = new XMLHttpRequest();  // Create new request\n    request.open(\"GET\", url, false);     // Pass false for synchronous\n\n    request.send(null);                  // Send the request now\n    // Throw an error if the request was not 200 OK\n    if (request.status !== 200) throw new Error(request.statusText);\n   \n    // Throw an error if the type was wrong\n    var type = request.getResponseHeader(\"Content-Type\");\n    if (!type.match(/^text/))\n        throw new Error(\"Expected textual response; got: \" + type);\n   \n    return request.responseText;\n}\n\ngetTextSync(\"http://127.0.0.1/server.php\");\n\t\t</script>\n\t</body>\n</html>"},{"key":"354cd8ac7d45646d9b33aae5b38ccc5e1d04d3c2","name":"server.php","value":"<?php\n/*\nheader('content-Type:text/javascript');\necho 'alert(\"test parse response\")';\nheader('content-Type:text/xml');\necho '<xml><name>kursk</name><age>35</age></xml>';\n*/\nheader('content-Type:application/json');\necho '{\"x\":1,\"y\":2,\"z\":3}';\n?>\n\n"}]},{"copy":0,"tags":[],"key":"50dede03571912c2f7865c0f8beb380dfaf684e5","createAt":1541640161411,"updateAt":1541640161411,"name":"Event","description":"","files":[{"key":"e9dee371a9b45c5740bb0243dca3605a3e469eb0","name":"callFn_DragAndDrop.js","value":"/*\n * The DnD API is quite complicated, and browsers are not fully interoperable.\n * This example gets the basics right, but each browser is a little different\n * and each one seems to have its own unique bugs. This code does not attempt\n * browser-specific workarounds.\n */\n /*\n  * 为什么dragenter/dragleave event需要注意 bubble?本例中使用entered变量的作用是什么?\n  * 因为当用户拖动element进入target时，会触发 ondrayenter 事件。如果像本例中，ondrayenter事件是注册在ul上，\n  * 而这个ul又包含了若干个li,设想一下这种情况，用户的鼠标先进入了一个li，又进入另一个li，\n  * 这两个li上的ondrayenter都会引起bubble。导致 ul 上的ondrayenter 事件被触发，\n  * 而我们希望实现当鼠标进入第一个li时，这个li高亮，当鼠标离开时，这个li恢复之前的状态。\n  * 所以需要区别对待每个 li。\n  * 所以这个问题可以总结为：一个注册在一堆elementes的父节点上的event handler，如何分别对待每个elementes？\n  * 答案是通过entered. entered 初始值是0，当第一次进入一个 li 时，entered+1, 再次进入另一个 li ，entered会再+1\n  * 这里也利用闭包特性 closure ,每次进入的 li 对应着各个 entered ，所以我们可以通过 entered 的值判断现在鼠标是否是第一次进入\n  * 如果是第一次进入，需要判断dataTransfer.types 来判断是否需要做出反应\n  * 如果不是第一次进入，就直接返回false .\n  */\nwhenReady(\n    function() {  // Run this function when the document is ready\n    // Find all <ul class='dnd'> elements and call the dnd() function on them\n    var lists = document.getElementsByTagName(\"ul\");\n    var regexp = /\\bdnd\\b/;\n    for(var i = 0; i < lists.length; i++)\n        if (regexp.test(lists[i].className)) dnd(lists[i]);\n    // Add drag-and-drop handlers to a list element\n    function dnd(list) {\n        var original_class = list.className;  // Remember original CSS class\n        var entered = 0;                      // Track enters and leaves\n        // This handler is invoked when a drag first enters the list. It checks\n        // that the drag contains data in a format it can process and, if so,\n        // returns false to indicate interest in a drop. In that case, it also\n        // highlights the drop target to let the user know of that interest.\n        list.ondragenter = function(e) {\n            e = e || window.event;  // Standard or IE event\n            var from = e.relatedTarget; \n            // dragenter and dragleave events bubble, which makes it tricky to\n            // know when to highlight or unhighlight the element in a case like\n            // this where the <ul> element has <li> children. In browsers that\n            // define relatedTarget we can track that.\n            // Otherwise, we count enter/leave pairs\n            // If we entered from outside the list or if\n            // this is the first entrance then we need to do some stuff\n            entered++;\n            if ((from && !ischild(from, list)) || entered == 1) {\n                // All the DnD info is in this dataTransfer object\n                var dt = e.dataTransfer; \n                // The dt.types object lists the types or formats that the data\n                // being dragged is available in. HTML5 says the type has a\n                // contains() method. In some browsers it is an array with an\n                // indexOf method. In IE8 and before, it simply doesn't exist.\n                var types = dt.types;    // What formats data is available in\n                // If we don't have any type data or if data is\n                // available in plain text format, then highlight the\n                // list to let the user know we're listening for drop\n                // and return false to let the browser know.\n                if (!types ||                                           // IE\n                    (types.contains && types.contains(\"text/plain\")) || //HTML5\n                    (types.indexOf && types.indexOf(\"text/plain\")!=-1)) //Webkit\n                {\n                    list.className = original_class + \"droppable\";\n                    return false;\n                }\n                // If we don't recognize the data type, we don't want a drop\n                return;   // without canceling\n            }\n            return false; // If not the first enter, we're still interested\n        };\n        // This handler is invoked as the mouse moves over the list.\n        // We have to define this handler and return false or the drag\n        // will be canceled.\n        list.ondragover = function(e) { return false; };\n        // This handler is invoked when the drag moves out of the list\n        // or out of one of its children. If we are actually leaving the list\n        // (not just going from one list item to another), then unhighlight it.\n        list.ondragleave = function(e) {\n            e = e || window.event;\n            var to = e.relatedTarget;\n            // If we're leaving for something outside the list or if this leave\n            // balances out the enters, then unhighlight the list\n            entered--;\n            if ((to && !ischild(to,list)) || entered <= 0) {\n                list.className = original_class;\n                entered = 0;\n            }\n            return false;\n        };\n        // This handler is invoked when a drop actually happens.\n        // We take the dropped text and make it into a new <li> element\n        list.ondrop = function(e) {\n            e = e || window.event;       // Get the event\n            // Get the data that was dropped in plain text format.\n            // \"Text\" is a nickname for \"text/plain\". \n            // IE does not support \"text/plain\", so we use \"Text\" here.\n            var dt = e.dataTransfer;       // dataTransfer object\n            var text = dt.getData(\"Text\"); // Get dropped data as plain text.\n            // If we got some text, turn it into a new item at list end.\n            if (text) {\n                var item = document.createElement(\"li\"); // Create new <li>\n                item.draggable = true;                   // Make it draggable\n                item.appendChild(document.createTextNode(text)); // Add text\n                list.appendChild(item);                  // Add it to the list\n                // Restore the list's original style and reset the entered count\n                list.className = original_class;\n                entered = 0;\n                return false;\n            }\n        };\n        // Make all items that were originally in the list draggable\n        var items = list.getElementsByTagName(\"li\");\n        for(var i = 0; i < items.length; i++)\n            items[i].draggable = true;\n        // And register event handlers for dragging list items.\n        // Note that we put these handlers on the list and let events\n        // bubble up from the items.\n        // This handler is invoked when a drag is initiated within the list.\n        list.ondragstart = function(e) {\n            var e = e || window.event;\n            var target = e.target || e.srcElement;\n            // If it bubbled up from something other than a <li>, ignore it\n            if (target.tagName !== \"LI\") return false;\n            // Get the all-important dataTransfer object\n            var dt = e.dataTransfer;\n            // Tell it what data we have to drag and what format it is in\n            dt.setData(\"Text\", target.innerText || target.textContent) ;\n            // Tell it we know how to allow copies or moves of the data\n            dt.effectAllowed = \"copyMove\";\n        };\n        // This handler is invoked after a successful drop occurs\n        list.ondragend = function(e) {\n            e = e || window.event;\n            var target = e.target || e.srcElement;\n            // If the drop was a move, then delete the list item.\n            // In IE8, this will be \"none\" unless you explicitly set it to\n            // move in the ondrop handler above.  But forcing it to \"move\" for\n            // IE prevents other browsers from giving the user a choice of a\n            // copy or move operation.\n            if (e.dataTransfer.dropEffect === \"move\")\n                target.parentNode.removeChild(target);\n        }\n        // This is the utility function we used in ondragenter and ondragleave.\n        // Return true if a is a child of b.\n        function ischild(a,b) {\n            for(; a; a = a.parentNode) if (a === b) return true;\n            return false;\n        }\n    }\n});"},{"key":"52b9e566ada39ab0bd5e986aa40b88e221b1bcbb","name":"callFn_text.js","value":"/**\n * InputFilter.js: unobtrusive filtering of keystrokes for <input> elements\n *\n * This module finds all <input type=\"text\"> elements in the document that\n * have an \"data-allowed-chars\" attribute. It registers keypress, textInput, and\n * textinput event handlers for any such element to restrict the user's input\n * so that only characters that appear in the value of the attribute may be\n * entered. If the <input> element also has an attribute named \"data-messageid\",\n * the value of that attribute is taken to be the id of another document\n * element. If the user types a character that is not allowed, the message\n * element is made visible. If the user types a character that is allowed, the\n * message element is hidden. This message id element is intended to offer\n * an explanation to the user of why her keystroke was rejected. It should\n * typically be styled with CSS so that it is initially invisible.\n *\n * Here is sample HTML that uses this module.\n *   Zipcode: <input id=\"zip\" type=\"text\"\n *                   data-allowed-chars=\"0123456789\" data-messageid=\"zipwarn\">\n *   <span id=\"zipwarn\" style=\"color:red;visibility:hidden\">Digits only</span>\n *\n * This module is purely unobtrusive: it does not define any symbols in\n * the global namespace.\n */\nwhenReady(function () {  // Run this function when the document is loaded\n    // Find all <input> elements\n    var inputelts = document.getElementsByTagName(\"input\");\n    // Loop through them all\n    for(var i = 0 ; i < inputelts.length; i++) {\n        var elt = inputelts[i];\n        // Skip those that aren't text fields or that don't have\n        // a data-allowed-chars attribute.\n        if (elt.type != \"text\" || !elt.getAttribute(\"data-allowed-chars\"))\n            continue;\n       \n        // Register our event handler function on this input element\n        // keypress is a legacy event handler that works everywhere.\n        // textInput (mixed-case) is supported by Safari and Chrome in 2010.\n        // textinput (lowercase) is the version in the DOM Level 3 Events draft.\n        if (elt.addEventListener) {\n            elt.addEventListener(\"keypress\", filter, false);\n            elt.addEventListener(\"textInput\", filter, false);\n            elt.addEventListener(\"textinput\", filter, false);\n        }\n        else { // textinput not supported versions of IE w/o addEventListener()\n            elt.attachEvent(\"onkeypress\", filter);\n        }\n    }\n    // This is the keypress and textInput handler that filters the user's input\n    function filter(event) {\n        // Get the event object and the target element target\n        var e = event || window.event;         // Standard or IE model\n        var target = e.target || e.srcElement; // Standard or IE model\n        var text = null;                       // The text that was entered\n        // Get the character or text that was entered\n        if (e.type === \"textinput\" || e.type === \"textInput\") text = e.data;\n        else {  // This was a legacy keypress event\n            // Firefox uses charCode for printable key press events\n            var code = e.charCode || e.keyCode;\n            // If this keystroke is a function key of any kind, do not filter it\n            if (code < 32 ||           // ASCII control character\n                e.charCode == 0 ||     // Function key (Firefox only)\n                e.ctrlKey || e.altKey) // Modifier key held down\n                return;                // Don't filter this event\n            // Convert character code into a string\n            var text = String.fromCharCode(code);\n        }\n       \n        // Now look up information we need from this input element\n        var allowed = target.getAttribute(\"data-allowed-chars\"); // Legal chars\n        var messageid = target.getAttribute(\"data-messageid\");   // Message id\n        if (messageid)  // If there is a message id, get the element\n            var messageElement = document.getElementById(messageid);\n       \n        // Loop through the characters of the input text\n        for(var i = 0; i < text.length; i++) {\n            var c = text.charAt(i);\n            if (allowed.indexOf(c) == -1) { // Is this a disallowed character?\n                // Display the message element, if there is one\n                if (messageElement) messageElement.style.visibility = \"visible\";\n                // Cancel the default action so the text isn't inserted\n                if (e.preventDefault) e.preventDefault();\n                if (e.returnValue) e.returnValue = false;\n                return false;\n            }\n        }\n        // If all the characters were legal, hide the message if there is one.\n        if (messageElement) messageElement.style.visibility = \"hidden\";\n    }\n});"},{"key":"e9732314d48497738a3d3aa8ff243ad4ccd1ac49","name":"Enclose.js","value":"// Enclose the content element in a frame or viewport of the specified width\n// and height (minimum 50x50). The optional contentX and contentY arguments\n// specify the initial offset of the content relative to the frame. (If\n// specified, they must be <= 0.) The frame has mousewheel event handlers that\n// allow the user to pan the element, and to shrink or enlarge the frame.\nfunction enclose(content, framewidth, frameheight, contentX, contentY) {\n\t// These arguments aren't just the initial values: they maintain the\n\t// current state and are used and modified by the mousewheel handler.\n\tframewidth = Math.max(framewidth, 50);\n\tframeheight = Math.max(frameheight, 50);\n\tcontentX = Math.min(contentX, 0) || 0;\n\tcontentY = Math.min(contentY, 0) || 0;\n\t// Create the frame element and set a CSS classname and styles\n\tvar frame = document.createElement(\"div\");\n\tframe.className = \"enclosure\"; // So we can define styles in a stylesheet\n\tframe.style.width = framewidth + \"px\";       // Set the frame size.\n\tframe.style.height = frameheight + \"px\";\n\tframe.style.overflow = \"hidden\";             // No scrollbars, no overflow\n\tframe.style.boxSizing = \"border-box\";        // Border-box simplifies the\n\tframe.style.webkitBoxSizing = \"border-box\";  // calculations for resizing\n\tframe.style.MozBoxSizing = \"border-box\";     // the frame.\n\n\t// Put the frame in the document and move the content elt into the frame.\n\tcontent.parentNode.insertBefore(frame, content);\n\tframe.appendChild(content);\n\t// Position the element relative to the frame\n\tcontent.style.position = \"relative\";\n\tcontent.style.left = contentX + \"px\";\n\tcontent.style.top = contentY + \"px\";\n\t// We'll need to work around some browser-specific quirks below\n\tvar isMacWebkit = (navigator.userAgent.indexOf(\"Macintosh\") !== -1 &&\n\tnavigator.userAgent.indexOf(\"WebKit\") !== -1);\n\tvar isFirefox = (navigator.userAgent.indexOf(\"Gecko\") !== -1);\n\t// Register mousewheel event handlers.\n\tframe.onwheel = wheelHandler;       // Future browsers\n\tframe.onmousewheel = wheelHandler;  // Most current browsers\n\tif (isFirefox)                      // Firefox only\n\tframe.addEventListener(\"DOMMouseScroll\", wheelHandler, false);\n\tfunction wheelHandler(event) {\n\t\tvar e = event || window.event;  // Standard or IE event object\n\t\t// Extract the amount of rotation from the event object, looking\n\t\t// for properties of a wheel event object, a mousewheel event object\n\t\t// (in both its 2D and 1D forms), and the Firefox DOMMouseScroll event.\n\t\t// Scale the deltas so that one \"click\" toward the screen is 30 pixels.\n\t\t// If future browsers fire both \"wheel\" and \"mousewheel\" for the same\n\t\t// event, we'll end up double-counting it here. Hopefully, however,\n\t\t// cancelling the wheel event will prevent generation of mousewheel.\n\t\tvar deltaX = e.deltaX*-10 ||  // wheel event\n\t\te.wheelDeltaX/4 ||  // mousewheel\n\t\t0;    // property not defined\n\t\tvar deltaY = e.deltaY*-10 ||  // wheel event\n\t\te.wheelDeltaY/4 ||  // mousewheel event in Webkit\n\t\t(e.wheelDeltaY===undefined &&      // if there is no 2D property then\n\t\te.wheelDelta/4) ||  // use the 1D wheel property\n\t\te.detail*-10 ||  // Firefox DOMMouseScroll event\n\t\t0;     // property not defined\n\t\t// Most browsers generate one event with delta 120 per mousewheel click.\n\t\t// On Macs, however, the mousewheels seem to be velocity-sensitive and\n\t\t// the delta values are often larger multiples of 120, at\n\t\t// least with the Apple Mouse. Use browser-testing to defeat this.\n\t\tif (isMacWebkit) {\n\t\t\tdeltaX /= 30;\n\t\t\tdeltaY /= 30;\n\t\t}\n\t\t// If we ever get a mousewheel or wheel event in (a future version of)\n\t\t// Firefox, then we don't need DOMMouseScroll anymore.\n\t\tif (isFirefox && e.type !== \"DOMMouseScroll\")\n\t\tframe.removeEventListener(\"DOMMouseScroll\", wheelHandler, false);\n\t\t// Get the current dimensions of the content element\n\t\tvar contentbox = content.getBoundingClientRect();\n\n\t\tvar contentwidth = contentbox.right - contentbox.left;\n\t\tvar contentheight = contentbox.bottom - contentbox.top;\n\t\tif (e.altKey) {  // If Alt key is held down, resize the frame\n\t\t\tif (deltaX) {\n\t\t\t\tframewidth -= deltaX; // New width, but not bigger than the\n\t\t\t\tframewidth = Math.min(framwidth, contentwidth);  // content\n\t\t\t\tframewidth = Math.max(framewidth,50);   // and no less than 50.\n\t\t\t\tframe.style.width = framewidth + \"px\";  // Set it on frame\n\t\t\t}\n\t\t\tif (deltaY) {\n\t\t\t\tframeheight -= deltaY;  // Do the same for the frame height\n\t\t\t\tframeheight = Math.min(frameheight, contentheight);\n\t\t\t\tframeheight = Math.max(frameheight-deltaY, 50);\n\t\t\t\tframe.style.height = frameheight + \"px\";\n\t\t\t}\n\t\t}\n\t\telse { // Without the Alt modifier, pan the content within the frame\n\t\t\tif (deltaX) {\n\t\t\t\t// Don't scroll more than this\n\t\t\t\tvar minoffset = Math.min(framewidth-contentwidth, 0);\n\t\t\t\t// Add deltaX to contentX, but don't go lower than minoffset\n\t\t\t\tcontentX = Math.max(contentX + deltaX, minoffset);\n\t\t\t\tcontentX = Math.min(contentX, 0);     // or higher than 0\n\t\t\t\tcontent.style.left = contentX + \"px\"; // Set new offset\n\t\t\t}\n\t\t\tif (deltaY) {\n\t\t\t\tvar minoffset = Math.min(frameheight - contentheight, 0);\n\t\t\t\t// Add deltaY to contentY, but don't go lower than minoffset\n\t\t\t\tcontentY = Math.max(contentY + deltaY, minoffset);\n\t\t\t\tcontentY = Math.min(contentY, 0);     // Or higher than 0\n\t\t\t\tcontent.style.top = contentY + \"px\";  // Set the new offset.\n\t\t\t}\n\t\t}\n\t\t// Don't let this event bubble. Prevent any default action.\n\t\t// This stops the browser from using the mousewheel event to scroll\n\t\t// the document. Hopefully calling preventDefault() on a wheel event\n\t\t// will also prevent the generation of a mousewheel event for the\n\t\t// same rotation.\n\t\tif (e.preventDefault) e.preventDefault();\n\t\tif (e.stopPropagation) e.stopPropagation();\n\t\te.cancelBubble = true;  // IE events\n\t\te.returnValue = false;  // IE events\n\t\treturn false;\n\t}\n}"},{"key":"cbe8c913c57fdf7540bacd8cd0d281fb42d3a44c","name":"Event-drag.html","value":"<html>\n\t<head>\n\t</head>\n\t<body>\n\n\n\n\t</body>\n\t<script type=\"text/javascript\" >\n\t\t\n\t\tfor (var i=0; i<200; i++) {\n\t\t\n\t\tvar brick_div = document.createElement('div');\n\t\tvar brick = document.createElement('div');\n\t\t\n\t\tbrick_div.setAttribute('style','position:absolute; left:200px;top:200px; width:150px;background-color:white;border: solid black;');\n\t\tbrick.setAttribute('style','background-color: gray; border-bottom: dotted black;padding: 3px; font-family: sans-serif; font-weight: bold;');\n\t\tbrick.textContent = 'brick_brick';\n\t\tbrick.addEventListener('mousedown',function(){ drag(this.parentNode, event);});\n\t\t//brick.onmousedown = function(){ drag(this.parentNode, event);};\n\t\t\n\t\tbrick_div.appendChild(brick);\n\t\tdocument.body.appendChild(brick_div);\n\t\t\n\t}\n\n\t\tfunction getScrollOffsets(w) {\n\t\t\t// Use the specified window or the current window if no argument\n\t\t\tw = w || window;\n\t\t\t// This works for all browsers except IE versions 8 and before\n\t\t\tif (w.pageXOffset != null) return {x: w.pageXOffset, y:w.pageYOffset};\n\t\t\t// For IE (or any browser) in Standards mode\n\t\t\tvar d = w.document;\n\t\t\tif (document.compatMode == \"CSS1Compat\")\n\t\t\treturn {x:d.documentElement.scrollLeft, y:d.documentElement.scrollTop};\n\t\t\t// For browsers in Quirks mode\n\t\t\treturn { x: d.body.scrollLeft, y: d.body.scrollTop };\n\t\t}\n\n\t\t/**\n\t\t* Drag.js: drag absolutely positioned HTML elements.\n\t\t*\n\t\t* This module defines a single drag() function that is designed to be called\n\t\t* from an onmousedown event handler. Subsequent mousemove events will\n\t\t* move the specified element. A mouseup event will terminate the drag.\n\t\t* This implementation works with both the standard and IE event models.\n\t\t* It requires the getScrollOffsets() function from elsewhere in this book.\n\t\t*\n\t\t* Arguments:\n\t\t*\n\t\t*   elementToDrag: the element that received the mousedown event or\n\t\t*     some containing element. It must be absolutely positioned. Its\n\t\t*     style.left and style.top values will be changed based on the user's\n\t\t*     drag.\n\t\t*\n\t\t*   event: the Event object for the mousedown event.\n\t\t**/\n\t\tfunction drag(elementToDrag, event) {\n\n\t\t\t// The initial mouse position, converted to document coordinates\n\t\t\tvar scroll = getScrollOffsets();  // A utility function from elsewhere\n\t\t\tvar startX = event.clientX + scroll.x;\n\t\t\tvar startY = event.clientY + scroll.y;\n\n\t\t\t// The original position (in document coordinates) of the element\n\t\t\t// that is going to be dragged.  Since elementToDrag is absolutely\n\t\t\t// positioned, we assume that its offsetParent is the document body.\n\t\t\tvar origX = elementToDrag.offsetLeft;\n\t\t\tvar origY = elementToDrag.offsetTop;\n\n\t\t\t// Compute the distance between the mouse down event and the upper-left\n\t\t\t// corner of the element. We'll maintain this distance as the mouse moves.\n\t\t\tvar deltaX = startX - origX;\n\t\t\tvar deltaY = startY - origY;\n\n\t\t\t// Register the event handlers that will respond to the mousemove events\n\t\t\t// and the mouseup event that follow this mousedown event.\n\t\t\tif (document.addEventListener) {  // Standard event model\n\t\t\t\t// Register capturing event handlers on the document\n\t\t\t\tdocument.addEventListener(\"mousemove\", moveHandler, true);\n\t\t\t\tdocument.addEventListener(\"mouseup\", upHandler, true);\n\t\t\t}\telse if (document.attachEvent) {  // IE Event Model for IE5-8\n\t\t\t\t// In the IE event model, we capture events by calling\n\t\t\t\t// setCapture() on the element to capture them.\n\t\t\t\telementToDrag.setCapture();\n\t\t\t\telementToDrag.attachEvent(\"onmousemove\", moveHandler);\n\t\t\t\telementToDrag.attachEvent(\"onmouseup\", upHandler);\n\t\t\t\t// Treat loss of mouse capture as a mouseup event.\n\t\t\t\telementToDrag.attachEvent(\"onlosecapture\", upHandler);\n\t\t\t}\n\n\t\t\t// We've handled this event. Don't let anybody else see it.\n\t\t\tif (event.stopPropagation) event.stopPropagation();  // Standard model\n\t\t\telse event.cancelBubble = true;                      // IE\n\t\t\t\n\t\t\t// Now prevent any default action.\n\t\t\tif (event.preventDefault) event.preventDefault();   // Standard model\n\t\t\telse event.returnValue = false;                     // IE\n\t\t\t\t\n\t\t\t/**\n\t\t\t* This is the handler that captures mousemove events when an element\n\t\t\t* is being dragged. It is responsible for moving the element.\n\t\t\t**/\n\t\t\tfunction moveHandler(e) {\n\t\t\t\tif (!e) e = window.event;  // IE event Model\n\t\t\t\t// Move the element to the current mouse position, adjusted by the\n\t\t\t\t// position of the scrollbars and the offset of the initial click.\n\t\t\t\tvar scroll = getScrollOffsets();\n\t\t\t\telementToDrag.style.left = (e.clientX + scroll.x - deltaX) + \"px\";\n\t\t\t\telementToDrag.style.top = (e.clientY + scroll.y - deltaY) + \"px\";\n\t\t\t\t// And don't let anyone else see this event.\n\t\t\t\tif (e.stopPropagation) e.stopPropagation();  // Standard\n\t\t\t\telse e.cancelBubble = true;                  // IE\n\t\t\t\t}\n\n\t\t\t\t/**\n\t\t\t\t* This is the handler that captures the final mouseup event that\n\t\t\t\t* occurs at the end of a drag.\n\t\t\t\t**/\n\t\t\t\tfunction upHandler(e) {\n\t\t\t\t\tif (!e) e = window.event;  // IE Event Model\n\t\t\t\t\t// Unregister the capturing event handlers.\n\t\t\t\t\tif (document.removeEventListener) {  // DOM event model\n\t\t\t\t\t\tdocument.removeEventListener(\"mouseup\", upHandler, true);\n\t\t\t\t\t\tdocument.removeEventListener(\"mousemove\", moveHandler, true);\n\t\t\t\t\t}\n\t\t\t\t\telse if (document.detachEvent) {  // IE 5+ Event Model\n\t\t\t\t\t\telementToDrag.detachEvent(\"onlosecapture\", upHandler);\n\t\t\t\t\t\telementToDrag.detachEvent(\"onmouseup\", upHandler);\n\t\t\t\t\t\telementToDrag.detachEvent(\"onmousemove\", moveHandler);\n\t\t\t\t\t\telementToDrag.releaseCapture();\n\t\t\t\t\t}\n\t\t\t\t\t// And don't let the event propagate any further.\n\t\t\t\t\tif (e.stopPropagation) e.stopPropagation();  // Standard model\n\t\t\t\t\telse e.cancelBubble = true;                  // IE\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\n\n\n\t\t\t\t\t</script>\n\t\t\t\t</html>\n\n\n\n"},{"key":"c4d8156fd67f96b890842f85b66674bd1a507190","name":"Event-DragAndDrop.html","value":"<html lang = \"en\" >\n    <head >\n        <meta charset = \"UTF-8\" >\n        <title >Document</title>\n    </head >\n    <body >\n        <h4 >An Unordered List:</h4>\n        <ul class=\"dnd\">\n          <li>Coffee</li>\n          <li>Tea</li>\n          <li>Milk</li>\n        </ul>\n        <h4>drag target</h4>\n        <ul class=\"dnd\">\n            <li></li>\n        </ul>\n        <script src = \"whenReady.js\" ></script>\n        <script src = \"callFn_DragAndDrop.js\"></script>\n        <style>\n            .dnddroppable {\n                background-color: yellow;\n            }\n        </style>\n    </body >\n</html>"},{"key":"e120b2a3c5d5f71c2c511df16d4b0cd18d67fdb7","name":"keymap.js","value":"/*\n * Keymap.js: bind key events to handler functions.\n *\n * This module defines a Keymap class. An instance of this class represents a\n * mapping of key identifiers (defined below) to handler functions. A Keymap\n * can be installed on an HTML element to handle keydown events. When such an\n * event occurs, the Keymap uses its mapping to invoke the appropriate handler.\n *\n * When you create a Keymap, you can pass a JavaScript object that represents\n * the initial set of bindings for the Keymap. The property names of this object\n * are key identifers, and the property values are the handler functions.\n * After a Keymap has been created, you can add new bindings by passing a key\n * identifer and handler function to the bind() method. You can remove a\n * binding by passing a key identifier to the unbind() method.\n *\n * To make use of a Keymap, call its install() method, passing an HTML element,\n * such as the document object. install() adds an onkeydown event handler to\n * the specified object. When this handler is invoked, it determines the key\n * identifier of the pressed key and invokes the handler function, if any,\n * bound to that key identifier. A single Keymap may be installed on more than\n * one HTML element.\n *\n * Key Identifiers\n *\n * A key identifier is a case-insensitive string representation of a key plus\n * any modifier keys that are held down at the same time. The key name is\n * usually the (unshifted) text on the key. Legal key names include \"A\", \"7\",\n * \"F2\", \"PageUp\", \"Left\", \"Backspace\", and \"Esc\".\n *\n * See the Keymap.keyCodeToKeyName object in this module for a list of names.\n * These are a subset of the names defined by the DOM Level 3 standard and\n * this class will use the key property of the event object when implemented.\n *\n * A key identifier may also include modifier key prefixes. These prefixes are\n * Alt, Ctrl, Meta, and Shift. They are case-insensitive, and must be separated\n * from the key name and from each other with spaces or with an underscore,\n * hyphen, or +. For example: \"SHIFT+A\", \"Alt_F2\", \"meta-v\", and \"ctrl alt left\".\n * On Macs, Meta is the Command key and Alt is the Option key. Some browsers\n * map the Windows key to the Meta modifier.\n *\n * Handler Functions\n *\n * Handlers are invoked as methods of the document or document element on which\n * the keymap is installed and are passed two arguments:\n *   1) the event object for the keydown event\n *   2) the key identifier of the key that was pressed\n * The handler return value becomes the return value of the keydown handler.\n * If a handler function returns false, the keymap will stop bubbling and\n * cancel any default action associated with the keydown event.\n *\n * Limitations\n *\n * It is not possible to bind a handler function to all keys. The operating\n * system traps some key sequences (Alt-F4, for example). And the browser\n * itself may trap others (Ctrl-S, for example). This code is browser, OS,\n * and locale-dependent. Function keys and modified function keys work well,\n * and unmodified alphanumeric keys work well. The combination of Ctrl and Alt\n * with alphanumeric characters is less robust.\n *\n * Most punctuation characters that do not require the Shift key (`=[];',./\\\n * but not hyphen) on standard US keyboard layouts are supported. But they are\n * not particularly portable to other keyboard layouts and should be avoided.\n * e.g\n * var key_o ={\"CTRL+SHIFT+F4\":function(){console.log('CTRL+SHIFT+F4');},\"Alt_F3\":function(){console.log('Alt_F3')}}\n * var keymap_instance = new Keymap(key_o);\n * keymap_instance.install(document);\n */\n// This is the constructor function\nfunction Keymap(bindings) {\n    this.map = {};    // Define the key identifier->handler map\n    if (bindings) {   // Copy initial bindings into it\n        for(name in bindings) \n            this.bind(name, bindings[name]);\n    }\n}\n// Bind the specified key identifier to the specified handler function\nKeymap.prototype.bind = function(key, func) {\n    this.map[Keymap.normalize(key)] = func;\n};\n// Delete the binding for the specified key identifier\nKeymap.prototype.unbind = function(key) {\n    delete this.map[Keymap.normalize(key)];\n};\n// Install this Keymap on the specified HTML element\nKeymap.prototype.install = function(element) {\n    // This is the event-handler function\n    var keymap = this;\n    function handler(event) { return keymap.dispatch(event, element); }\n    // Now install it\n    if (element.addEventListener)\n        element.addEventListener(\"keydown\", handler, false);\n    else if (element.attachEvent)\n        element.attachEvent(\"onkeydown\", handler);\n};\n// This method dispatches key events based on the keymap bindings.\nKeymap.prototype.dispatch = function(event, element) {\n    // We start off with no modifiers and no key name\n    var modifiers = \"\"\n    var keyname = null;\n    // Build the modifier string in canonical lowercase alphabetical order.\n    if (event.altKey) modifiers += \"alt_\";     \n    if (event.ctrlKey) modifiers += \"ctrl_\";\n    if (event.metaKey) modifiers += \"meta_\";\n    if (event.shiftKey) modifiers += \"shift_\";\n    // The keyname is easy if the DOM Level 3 key property is implemented:\n    if (event.key) keyname = event.key;\n    // Use the keyIdentifier on Safari and Chrome for function key names\n    else if (event.keyIdentifier && event.keyIdentifier.substring(0,2) !== \"U+\")\n        keyname = event.keyIdentifier;\n    // Otherwise, use the keyCode property and the code-to-name map below\n    else keyname = Keymap.keyCodeToKeyName[event.keyCode];\n    // If we couldn't figure out a key name, just return and ignore the event.\n    if (!keyname) return;\n    // The canonical key id is modifiers plus lowercase key name\n    var keyid = modifiers + keyname.toLowerCase();\n    // Now see if the key identifier is bound to anything\n    var handler = this.map[keyid];\n    if (handler) {  // If there is a handler for this key, handle it\n        // Invoke the handler function\n        var retval = handler.call(element, event, keyid);\n        // If the handler returns false, cancel default and prevent bubbling\n        if (retval === false) {\n            if (event.stopPropagation) event.stopPropagation();  // DOM model\n            else event.cancelBubble = true;                      // IE model\n            if (event.preventDefault) event.preventDefault();    // DOM\n            else event.returnValue = false;                      // IE\n        }\n        // Return whatever the handler returned\n        return retval;\n    }\n};\n// Utility function to convert a key identifier to canonical form.\n// On non-Macintosh hardware, we could map \"meta\" to \"ctrl\" here, so that\n// Meta-C would be \"Command-C\" on the Mac and \"Ctrl-C\" everywhere else.\nKeymap.normalize = function(keyid) {\n    keyid = keyid.toLowerCase();           // Everything lowercase\n    var words = keyid.split(/\\s+|[\\-+_]/); // Split modifiers from name\n    var keyname = words.pop();             // keyname is the last word\n    keyname = Keymap.aliases[keyname] || keyname; // Is it an alias?\n    words.sort();                          // Sort remaining modifiers\n    words.push(keyname);                   // Add the normalized name back\n    return words.join(\"_\");                // Concatenate them all\n};\nKeymap.aliases = {        // Map common key aliases to their \"official\"\n    \"escape\":\"esc\",       // key names used by DOM Level 3 and by\n    \"delete\":\"del\",       // the key code to key name map below.\n    \"return\":\"enter\",     // Both keys and values must be lowercase here.\n    \"ctrl\":\"control\",\n    \"space\":\"spacebar\",\n    \"ins\":\"insert\"\n};\n// The legacy keyCode property of the keydown event object is not standardized\n// But the following values seem to work for most browsers and OSes.\nKeymap.keyCodeToKeyName = {\n    // Keys with words or arrows on them\n    8:\"Backspace\", 9:\"Tab\", 13:\"Enter\", 16:\"Shift\", 17:\"Control\", 18:\"Alt\",\n    19:\"Pause\", 20:\"CapsLock\", 27:\"Esc\", 32:\"Spacebar\", 33:\"PageUp\", \n    34:\"PageDown\", 35:\"End\", 36:\"Home\", 37:\"Left\", 38:\"Up\", 39:\"Right\",\n    40:\"Down\", 45:\"Insert\", 46:\"Del\",\n    // Number keys on main keyboard (not keypad)\n    48:\"0\",49:\"1\",50:\"2\",51:\"3\",52:\"4\",53:\"5\",54:\"6\",55:\"7\",56:\"8\",57:\"9\",\n    // Letter keys. Note that we don't distinguish upper and lower case\n    65:\"A\", 66:\"B\", 67:\"C\", 68:\"D\", 69:\"E\", 70:\"F\", 71:\"G\", 72:\"H\", 73:\"I\",\n    74:\"J\", 75:\"K\", 76:\"L\", 77:\"M\", 78:\"N\", 79:\"O\", 80:\"P\", 81:\"Q\", 82:\"R\",\n    83:\"S\", 84:\"T\", 85:\"U\", 86:\"V\", 87:\"W\", 88:\"X\", 89:\"Y\", 90:\"Z\",\n    // Keypad numbers and punctuation keys. (Opera does not support these.)\n    96:\"0\",97:\"1\",98:\"2\",99:\"3\",100:\"4\",101:\"5\",102:\"6\",103:\"7\",104:\"8\",105:\"9\",\n    106:\"Multiply\", 107:\"Add\", 109:\"Subtract\", 110:\"Decimal\", 111:\"Divide\",\n    // Function keys\n    112:\"F1\", 113:\"F2\", 114:\"F3\", 115:\"F4\", 116:\"F5\", 117:\"F6\",\n    118:\"F7\", 119:\"F8\", 120:\"F9\", 121:\"F10\", 122:\"F11\", 123:\"F12\",\n    124:\"F13\", 125:\"F14\", 126:\"F15\", 127:\"F16\", 128:\"F17\", 129:\"F18\",\n    130:\"F19\", 131:\"F20\", 132:\"F21\", 133:\"F22\", 134:\"F23\", 135:\"F24\",\n    // Punctuation keys that don't require holding down Shift\n    // Hyphen is nonportable: FF returns same code as Subtract\n    59:\";\", 61:\"=\", 186:\";\", 187:\"=\", // Firefox and Opera return 59,61\n    188:\",\", 190:\".\", 191:\"/\", 192:\"`\", 219:\"[\", 220:\"\\\\\", 221:\"]\", 222:\"'\"\n};"},{"key":"6f4df56c46f8626495d2a8abe3a6d37b8b6ad470","name":"textinput.html","value":"<html lang = \"en\" >\n    <head >\n        <meta charset = \"UTF-8\" >\n        <title >Document</title>\n    </head >\n    <body >\n        <input id=\"zip\" type=\"text\"  data-allowed-chars=\"0123456789\" data-messageid=\"zipwarn\">\n        <span id=\"zipwarn\" style=\"color:red;visibility:hidden\">Digits only</span>\n        <script src = \"whenReady.js\" ></script>\n        <script src = \"callFn_text.js\"></script>\n    </body >\n</html>"},{"key":"a82c2ecf00de4b93b52415384ca30b2858592368","name":"wheel.html","value":"<html>\n\t<head>\n\t</head>\n\t<body>\n\t\t<script src=\"whenReady.js\"></script>\n\t\t<script src=\"Enclose.js\"></script>\n\t\t<script>\n\t\t\twhenReady(function() {\n\t\t\t\tenclose(document.getElementById(\"content\"),600,400,-200,-300);\n\t\t\t});\n\t\t</script>\n\t\t<style>div.enclosure {  border: solid black 10px; margin: 10px; }</style>\n\t\t<img id=\"content\" src=\"images.jpg\"/>\n\t</body>\n</html>\n\n\n\n"},{"key":"a35e72519da2a1716d455810d4e01cd832c25577","name":"whenReady.js","value":"/*\n* Pass a function to whenReady() and it will be invoked (as a method of the\n* document) when the document is parsed and ready for manipulation. Registered\n* functions are triggered by the first DOMContentLoaded, readystatechange, or\n* load event that occurs. Once the document is ready and all functions have\n* been invoked, any functions passed to whenReady() will be invoked\n* immediately.\n*/\nvar whenReady = ( function() { // This function returns the whenReady() function\n\tvar funcs = [];    // The functions to run when we get an event\n\tvar ready = false; // Switches to true when the handler is triggered\n\n\t// The event handler invoked when the document becomes ready\n\tfunction handler(e) {\n\t\t// If we've already run once, just return\n\t\tif (ready) return;\n\t\t// If this was a readystatechange event where the state changed to\n\t\t// something other than \"complete\", then we're not ready yet\n\t\tif (e.type === \"readystatechange\" && document.readyState !== \"complete\")\n\t\treturn;\n\n\t\t// Run all registered functions.\n\t\t// Note that we look up funcs.length each time, in case calling\n\t\t// one of these functions causes more functions to be registered.\n\t\tfor(var i = 0; i < funcs.length; i++)\n\t\tfuncs[i].call(document);\n\t\t// Now set the ready flag to true and forget the functions\n\t\tready = true;\n\t\tfuncs = null;\n\t}\n\n\t// Register the handler for any event we might receive\n\tif (document.addEventListener) {\n\t\tdocument.addEventListener(\"DOMContentLoaded\", handler, false);\n\t\tdocument.addEventListener(\"readystatechange\", handler, false);\n\t\twindow.addEventListener(\"load\", handler, false);\n\t}\n\telse if (document.attachEvent) {\n\t\tdocument.attachEvent(\"onreadystatechange\", handler);\n\t\twindow.attachEvent(\"onload\", handler);\n\t}\n\n\t// Return the whenReady function\n\treturn function whenReady2(f) {\n\t\tif (ready) f.call(document); // If already ready, just run it\n\t\telse funcs.push(f);          // Otherwise, queue it for later.\n\t\t}\n\t}()\n\t);"}]},{"copy":0,"tags":[],"key":"f241a73df5dd987f45b3bc4e96dfb4015c3d9750","createAt":1541640321561,"updateAt":1541640321561,"name":"Ajax-josnP","lang":"JavaScript","value":"// Make a JSONP request to the specified URL and pass the parsed response\n// data to the specified callback. Add a query parameter named \"jsonp\" to\n// the URL to specify the name of the callback function for the request.\n// follow coding in client-side\nfunction getJSONP(url, callback) {\n\t// Create a unique callback name just for this request\n\tvar cbnum = \"cb\" + getJSONP.counter++; // Increment counter each time\n\tvar cbname = \"getJSONP.\" + cbnum;      // As a property of this function\n\n\t// Add the callback name to the url query string using form-encoding\n\t// We use the parameter name \"jsonp\".  Some JSONP-enabled services\n\t// may require a different parameter name, such as \"callback\".\n\tif (url.indexOf(\"?\") === -1)   // URL doesn't already have a query section\n\turl += \"?jsonp=\" + cbname; // add parameter as the query section\n\telse                           // Otherwise,\n\t\turl += \"&jsonp=\" + cbname; // add it as a new parameter.\n\t\t// Create the script element that will send this request\n\t\tvar script = document.createElement(\"script\");\n\t\t// Define the callback function that will be invoked by the script\n\t\tgetJSONP[cbnum] = function(response) {\n\t\t\ttry {\n\t\t\t\tcallback(response); // Handle the response data\n\t\t\t}\n\t\t\tfinally {               // Even if callback or response threw an error\n\t\t\t\tdelete getJSONP[cbnum];                // Delete this function\n\t\t\t\tscript.parentNode.removeChild(script); // Remove script\n\t\t\t}\n\t\t};\n\t\t// Now trigger the HTTP request\n\t\tscript.src = url;                  // Set script url\n\t\tdocument.body.appendChild(script); // Add it to the document\n\t}\n\tgetJSONP.counter = 0;  // A counter we use to create unique callback names","description":""},{"copy":0,"tags":[],"key":"32ba07ba2dea04388eabc2e8e828a128fd9496e7","createAt":1541640412453,"updateAt":1541640412453,"name":"Ajax-jsfile-preload-anyWhen-execute","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\t\t<script>\n\t\t\t/*\n\t\t\t * 利用object元素的特点，预先下载js文件，但不会执行。\n\t\t\t * 然后再等到需要时执行添加<script>元素，src和Object元素的src相同,这样就可以直接使用预先下载的js文件\n\t\t\t*/\n\t\t\tfunction addObjectElement(file_name){\n\t\t\t\tvar cache = document.createElement('object');\n\t\t\t\tcache.date = file_name;\n\t\t\t\tcache.id =  'object_cache_id';\n\t\t\t\tcache.width = 0;\n\t\t\t\tcache.height = 0;\n\t\t\t\tdocument.body.appendChild(cache);\n\t\t\t}\n\t\t\t\n\t\t\tfunction loadjs(file_name){\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.setAttribute('src',file_name);\n\t\t\t\tscript.setAttribute('type','text/javascript');\n\t\t\t\tscript.setAttribute('id','script_id');\n\t\t\t\t\n\t\t\t\tvar script_ele = document.getElementById('script_id');\n\t\t\t\tif (script_ele)\n\t\t\t\t\tdocument.body.removeChild(script_ele);\n\t\t\t\tdocument.body.appendChild(script);\n\t\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t</script>\n\t\t\n\t\t<button onclick = 'loadjs(\"./alert.js\")' > click me </button>\n\t\t\n\t\t<script>\n\t\t\t\n\t\t\taddObjectElement('./alert.js');\n\t\t\t\n\t  </script>\n\n\t</body>\n</html>","description":""},{"copy":0,"tags":[],"key":"46d9dc5cd6b3251dd0ef6723e862b3c1bbd0eef6","createAt":1541640417307,"updateAt":1541640417307,"name":"Ajax-jsfile-preload-anyWhen-execute","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\t\t<script>\n\t\t\t/*\n\t\t\t * 利用object元素的特点，预先下载js文件，但不会执行。\n\t\t\t * 然后再等到需要时执行添加<script>元素，src和Object元素的src相同,这样就可以直接使用预先下载的js文件\n\t\t\t*/\n\t\t\tfunction addObjectElement(file_name){\n\t\t\t\tvar cache = document.createElement('object');\n\t\t\t\tcache.date = file_name;\n\t\t\t\tcache.id =  'object_cache_id';\n\t\t\t\tcache.width = 0;\n\t\t\t\tcache.height = 0;\n\t\t\t\tdocument.body.appendChild(cache);\n\t\t\t}\n\t\t\t\n\t\t\tfunction loadjs(file_name){\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.setAttribute('src',file_name);\n\t\t\t\tscript.setAttribute('type','text/javascript');\n\t\t\t\tscript.setAttribute('id','script_id');\n\t\t\t\t\n\t\t\t\tvar script_ele = document.getElementById('script_id');\n\t\t\t\tif (script_ele)\n\t\t\t\t\tdocument.body.removeChild(script_ele);\n\t\t\t\tdocument.body.appendChild(script);\n\t\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t</script>\n\t\t\n\t\t<button onclick = 'loadjs(\"./alert.js\")' > click me </button>\n\t\t\n\t\t<script>\n\t\t\t\n\t\t\taddObjectElement('./alert.js');\n\t\t\t\n\t  </script>\n\n\t</body>\n</html>","description":""},{"copy":0,"tags":[],"key":"75fbfc7d368ab37d3517109054a5ab8f7a5e7d1d","createAt":1541640422408,"updateAt":1541640422408,"name":"Ajax-jsfile-preload-anyWhen-execute","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\t\t<script>\n\t\t\t/*\n\t\t\t * 利用object元素的特点，预先下载js文件，但不会执行。\n\t\t\t * 然后再等到需要时执行添加<script>元素，src和Object元素的src相同,这样就可以直接使用预先下载的js文件\n\t\t\t*/\n\t\t\tfunction addObjectElement(file_name){\n\t\t\t\tvar cache = document.createElement('object');\n\t\t\t\tcache.date = file_name;\n\t\t\t\tcache.id =  'object_cache_id';\n\t\t\t\tcache.width = 0;\n\t\t\t\tcache.height = 0;\n\t\t\t\tdocument.body.appendChild(cache);\n\t\t\t}\n\t\t\t\n\t\t\tfunction loadjs(file_name){\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.setAttribute('src',file_name);\n\t\t\t\tscript.setAttribute('type','text/javascript');\n\t\t\t\tscript.setAttribute('id','script_id');\n\t\t\t\t\n\t\t\t\tvar script_ele = document.getElementById('script_id');\n\t\t\t\tif (script_ele)\n\t\t\t\t\tdocument.body.removeChild(script_ele);\n\t\t\t\tdocument.body.appendChild(script);\n\t\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t</script>\n\t\t\n\t\t<button onclick = 'loadjs(\"./alert.js\")' > click me </button>\n\t\t\n\t\t<script>\n\t\t\t\n\t\t\taddObjectElement('./alert.js');\n\t\t\t\n\t  </script>\n\n\t</body>\n</html>","description":""},{"copy":0,"tags":[],"key":"75681a6e10df349ba66117a447ea88b53b84fe1e","createAt":1541640427764,"updateAt":1541640427764,"name":"Ajax-jsfile-preload-anyWhen-execute","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\t\t<script>\n\t\t\t/*\n\t\t\t * 利用object元素的特点，预先下载js文件，但不会执行。\n\t\t\t * 然后再等到需要时执行添加<script>元素，src和Object元素的src相同,这样就可以直接使用预先下载的js文件\n\t\t\t*/\n\t\t\tfunction addObjectElement(file_name){\n\t\t\t\tvar cache = document.createElement('object');\n\t\t\t\tcache.date = file_name;\n\t\t\t\tcache.id =  'object_cache_id';\n\t\t\t\tcache.width = 0;\n\t\t\t\tcache.height = 0;\n\t\t\t\tdocument.body.appendChild(cache);\n\t\t\t}\n\t\t\t\n\t\t\tfunction loadjs(file_name){\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.setAttribute('src',file_name);\n\t\t\t\tscript.setAttribute('type','text/javascript');\n\t\t\t\tscript.setAttribute('id','script_id');\n\t\t\t\t\n\t\t\t\tvar script_ele = document.getElementById('script_id');\n\t\t\t\tif (script_ele)\n\t\t\t\t\tdocument.body.removeChild(script_ele);\n\t\t\t\tdocument.body.appendChild(script);\n\t\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t</script>\n\t\t\n\t\t<button onclick = 'loadjs(\"./alert.js\")' > click me </button>\n\t\t\n\t\t<script>\n\t\t\t\n\t\t\taddObjectElement('./alert.js');\n\t\t\t\n\t  </script>\n\n\t</body>\n</html>","description":""},{"copy":0,"tags":[],"key":"b97c906e9a31e2f6d1696b0b889774d50d34e990","createAt":1541640433004,"updateAt":1541640433004,"name":"Ajax-jsfile-preload-anyWhen-execute","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\t\t<script>\n\t\t\t/*\n\t\t\t * 利用object元素的特点，预先下载js文件，但不会执行。\n\t\t\t * 然后再等到需要时执行添加<script>元素，src和Object元素的src相同,这样就可以直接使用预先下载的js文件\n\t\t\t*/\n\t\t\tfunction addObjectElement(file_name){\n\t\t\t\tvar cache = document.createElement('object');\n\t\t\t\tcache.date = file_name;\n\t\t\t\tcache.id =  'object_cache_id';\n\t\t\t\tcache.width = 0;\n\t\t\t\tcache.height = 0;\n\t\t\t\tdocument.body.appendChild(cache);\n\t\t\t}\n\t\t\t\n\t\t\tfunction loadjs(file_name){\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.setAttribute('src',file_name);\n\t\t\t\tscript.setAttribute('type','text/javascript');\n\t\t\t\tscript.setAttribute('id','script_id');\n\t\t\t\t\n\t\t\t\tvar script_ele = document.getElementById('script_id');\n\t\t\t\tif (script_ele)\n\t\t\t\t\tdocument.body.removeChild(script_ele);\n\t\t\t\tdocument.body.appendChild(script);\n\t\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t</script>\n\t\t\n\t\t<button onclick = 'loadjs(\"./alert.js\")' > click me </button>\n\t\t\n\t\t<script>\n\t\t\t\n\t\t\taddObjectElement('./alert.js');\n\t\t\t\n\t  </script>\n\n\t</body>\n</html>","description":""},{"copy":0,"tags":[],"key":"91b5aee048783cb7672db38f085e3f8e45c08cdb","createAt":1541640438754,"updateAt":1541640438754,"name":"Ajax-jsfile-preload-anyWhen-execute","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\t\t<script>\n\t\t\t/*\n\t\t\t * 利用object元素的特点，预先下载js文件，但不会执行。\n\t\t\t * 然后再等到需要时执行添加<script>元素，src和Object元素的src相同,这样就可以直接使用预先下载的js文件\n\t\t\t*/\n\t\t\tfunction addObjectElement(file_name){\n\t\t\t\tvar cache = document.createElement('object');\n\t\t\t\tcache.date = file_name;\n\t\t\t\tcache.id =  'object_cache_id';\n\t\t\t\tcache.width = 0;\n\t\t\t\tcache.height = 0;\n\t\t\t\tdocument.body.appendChild(cache);\n\t\t\t}\n\t\t\t\n\t\t\tfunction loadjs(file_name){\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.setAttribute('src',file_name);\n\t\t\t\tscript.setAttribute('type','text/javascript');\n\t\t\t\tscript.setAttribute('id','script_id');\n\t\t\t\t\n\t\t\t\tvar script_ele = document.getElementById('script_id');\n\t\t\t\tif (script_ele)\n\t\t\t\t\tdocument.body.removeChild(script_ele);\n\t\t\t\tdocument.body.appendChild(script);\n\t\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t</script>\n\t\t\n\t\t<button onclick = 'loadjs(\"./alert.js\")' > click me </button>\n\t\t\n\t\t<script>\n\t\t\t\n\t\t\taddObjectElement('./alert.js');\n\t\t\t\n\t  </script>\n\n\t</body>\n</html>","description":""},{"copy":0,"tags":[],"key":"ed012e691fc8cbd8271b2351006f16128d8d74dd","createAt":1541640444514,"updateAt":1541640444514,"name":"Ajax-jsfile-preload-anyWhen-execute","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\t\t<script>\n\t\t\t/*\n\t\t\t * 利用object元素的特点，预先下载js文件，但不会执行。\n\t\t\t * 然后再等到需要时执行添加<script>元素，src和Object元素的src相同,这样就可以直接使用预先下载的js文件\n\t\t\t*/\n\t\t\tfunction addObjectElement(file_name){\n\t\t\t\tvar cache = document.createElement('object');\n\t\t\t\tcache.date = file_name;\n\t\t\t\tcache.id =  'object_cache_id';\n\t\t\t\tcache.width = 0;\n\t\t\t\tcache.height = 0;\n\t\t\t\tdocument.body.appendChild(cache);\n\t\t\t}\n\t\t\t\n\t\t\tfunction loadjs(file_name){\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.setAttribute('src',file_name);\n\t\t\t\tscript.setAttribute('type','text/javascript');\n\t\t\t\tscript.setAttribute('id','script_id');\n\t\t\t\t\n\t\t\t\tvar script_ele = document.getElementById('script_id');\n\t\t\t\tif (script_ele)\n\t\t\t\t\tdocument.body.removeChild(script_ele);\n\t\t\t\tdocument.body.appendChild(script);\n\t\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t</script>\n\t\t\n\t\t<button onclick = 'loadjs(\"./alert.js\")' > click me </button>\n\t\t\n\t\t<script>\n\t\t\t\n\t\t\taddObjectElement('./alert.js');\n\t\t\t\n\t  </script>\n\n\t</body>\n</html>","description":""},{"copy":0,"tags":[],"key":"ebb9a37a7496848913ba3cbf5e8e380ff5d32dbf","createAt":1541640450696,"updateAt":1541640450696,"name":"Ajax-jsfile-preload-anyWhen-execute","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\t\t<script>\n\t\t\t/*\n\t\t\t * 利用object元素的特点，预先下载js文件，但不会执行。\n\t\t\t * 然后再等到需要时执行添加<script>元素，src和Object元素的src相同,这样就可以直接使用预先下载的js文件\n\t\t\t*/\n\t\t\tfunction addObjectElement(file_name){\n\t\t\t\tvar cache = document.createElement('object');\n\t\t\t\tcache.date = file_name;\n\t\t\t\tcache.id =  'object_cache_id';\n\t\t\t\tcache.width = 0;\n\t\t\t\tcache.height = 0;\n\t\t\t\tdocument.body.appendChild(cache);\n\t\t\t}\n\t\t\t\n\t\t\tfunction loadjs(file_name){\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.setAttribute('src',file_name);\n\t\t\t\tscript.setAttribute('type','text/javascript');\n\t\t\t\tscript.setAttribute('id','script_id');\n\t\t\t\t\n\t\t\t\tvar script_ele = document.getElementById('script_id');\n\t\t\t\tif (script_ele)\n\t\t\t\t\tdocument.body.removeChild(script_ele);\n\t\t\t\tdocument.body.appendChild(script);\n\t\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t</script>\n\t\t\n\t\t<button onclick = 'loadjs(\"./alert.js\")' > click me </button>\n\t\t\n\t\t<script>\n\t\t\t\n\t\t\taddObjectElement('./alert.js');\n\t\t\t\n\t  </script>\n\n\t</body>\n</html>","description":""},{"copy":0,"tags":[],"key":"57480a429a644a05c6776ed95e9196de62bc19a2","createAt":1541640456746,"updateAt":1541640456746,"name":"Ajax-jsfile-preload-anyWhen-execute","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\t\t<script>\n\t\t\t/*\n\t\t\t * 利用object元素的特点，预先下载js文件，但不会执行。\n\t\t\t * 然后再等到需要时执行添加<script>元素，src和Object元素的src相同,这样就可以直接使用预先下载的js文件\n\t\t\t*/\n\t\t\tfunction addObjectElement(file_name){\n\t\t\t\tvar cache = document.createElement('object');\n\t\t\t\tcache.date = file_name;\n\t\t\t\tcache.id =  'object_cache_id';\n\t\t\t\tcache.width = 0;\n\t\t\t\tcache.height = 0;\n\t\t\t\tdocument.body.appendChild(cache);\n\t\t\t}\n\t\t\t\n\t\t\tfunction loadjs(file_name){\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.setAttribute('src',file_name);\n\t\t\t\tscript.setAttribute('type','text/javascript');\n\t\t\t\tscript.setAttribute('id','script_id');\n\t\t\t\t\n\t\t\t\tvar script_ele = document.getElementById('script_id');\n\t\t\t\tif (script_ele)\n\t\t\t\t\tdocument.body.removeChild(script_ele);\n\t\t\t\tdocument.body.appendChild(script);\n\t\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t</script>\n\t\t\n\t\t<button onclick = 'loadjs(\"./alert.js\")' > click me </button>\n\t\t\n\t\t<script>\n\t\t\t\n\t\t\taddObjectElement('./alert.js');\n\t\t\t\n\t  </script>\n\n\t</body>\n</html>","description":""},{"copy":0,"tags":[],"key":"6304d7999790ed413be3ddfb844b920f06b868f7","createAt":1541640462828,"updateAt":1541640462828,"name":"Ajax-jsfile-preload-anyWhen-execute","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\t\t<script>\n\t\t\t/*\n\t\t\t * 利用object元素的特点，预先下载js文件，但不会执行。\n\t\t\t * 然后再等到需要时执行添加<script>元素，src和Object元素的src相同,这样就可以直接使用预先下载的js文件\n\t\t\t*/\n\t\t\tfunction addObjectElement(file_name){\n\t\t\t\tvar cache = document.createElement('object');\n\t\t\t\tcache.date = file_name;\n\t\t\t\tcache.id =  'object_cache_id';\n\t\t\t\tcache.width = 0;\n\t\t\t\tcache.height = 0;\n\t\t\t\tdocument.body.appendChild(cache);\n\t\t\t}\n\t\t\t\n\t\t\tfunction loadjs(file_name){\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.setAttribute('src',file_name);\n\t\t\t\tscript.setAttribute('type','text/javascript');\n\t\t\t\tscript.setAttribute('id','script_id');\n\t\t\t\t\n\t\t\t\tvar script_ele = document.getElementById('script_id');\n\t\t\t\tif (script_ele)\n\t\t\t\t\tdocument.body.removeChild(script_ele);\n\t\t\t\tdocument.body.appendChild(script);\n\t\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t</script>\n\t\t\n\t\t<button onclick = 'loadjs(\"./alert.js\")' > click me </button>\n\t\t\n\t\t<script>\n\t\t\t\n\t\t\taddObjectElement('./alert.js');\n\t\t\t\n\t  </script>\n\n\t</body>\n</html>","description":""},{"copy":0,"tags":[],"key":"a03e9312fb32ed707abc4eb7de05e809efafb8dc","createAt":1541640469464,"updateAt":1541640469464,"name":"Ajax-jsfile-preload-anyWhen-execute","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\t\t<script>\n\t\t\t/*\n\t\t\t * 利用object元素的特点，预先下载js文件，但不会执行。\n\t\t\t * 然后再等到需要时执行添加<script>元素，src和Object元素的src相同,这样就可以直接使用预先下载的js文件\n\t\t\t*/\n\t\t\tfunction addObjectElement(file_name){\n\t\t\t\tvar cache = document.createElement('object');\n\t\t\t\tcache.date = file_name;\n\t\t\t\tcache.id =  'object_cache_id';\n\t\t\t\tcache.width = 0;\n\t\t\t\tcache.height = 0;\n\t\t\t\tdocument.body.appendChild(cache);\n\t\t\t}\n\t\t\t\n\t\t\tfunction loadjs(file_name){\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.setAttribute('src',file_name);\n\t\t\t\tscript.setAttribute('type','text/javascript');\n\t\t\t\tscript.setAttribute('id','script_id');\n\t\t\t\t\n\t\t\t\tvar script_ele = document.getElementById('script_id');\n\t\t\t\tif (script_ele)\n\t\t\t\t\tdocument.body.removeChild(script_ele);\n\t\t\t\tdocument.body.appendChild(script);\n\t\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t</script>\n\t\t\n\t\t<button onclick = 'loadjs(\"./alert.js\")' > click me </button>\n\t\t\n\t\t<script>\n\t\t\t\n\t\t\taddObjectElement('./alert.js');\n\t\t\t\n\t  </script>\n\n\t</body>\n</html>","description":""},{"copy":0,"tags":[],"key":"d27eb7c9c4a093c5a1fcb41b3093f32970697399","createAt":1541640476011,"updateAt":1541640476011,"name":"Ajax-jsfile-preload-anyWhen-execute","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\t\t<script>\n\t\t\t/*\n\t\t\t * 利用object元素的特点，预先下载js文件，但不会执行。\n\t\t\t * 然后再等到需要时执行添加<script>元素，src和Object元素的src相同,这样就可以直接使用预先下载的js文件\n\t\t\t*/\n\t\t\tfunction addObjectElement(file_name){\n\t\t\t\tvar cache = document.createElement('object');\n\t\t\t\tcache.date = file_name;\n\t\t\t\tcache.id =  'object_cache_id';\n\t\t\t\tcache.width = 0;\n\t\t\t\tcache.height = 0;\n\t\t\t\tdocument.body.appendChild(cache);\n\t\t\t}\n\t\t\t\n\t\t\tfunction loadjs(file_name){\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.setAttribute('src',file_name);\n\t\t\t\tscript.setAttribute('type','text/javascript');\n\t\t\t\tscript.setAttribute('id','script_id');\n\t\t\t\t\n\t\t\t\tvar script_ele = document.getElementById('script_id');\n\t\t\t\tif (script_ele)\n\t\t\t\t\tdocument.body.removeChild(script_ele);\n\t\t\t\tdocument.body.appendChild(script);\n\t\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t</script>\n\t\t\n\t\t<button onclick = 'loadjs(\"./alert.js\")' > click me </button>\n\t\t\n\t\t<script>\n\t\t\t\n\t\t\taddObjectElement('./alert.js');\n\t\t\t\n\t  </script>\n\n\t</body>\n</html>","description":""},{"copy":0,"tags":[],"key":"64911b66034c17a4c15406936d1c6be55c4678f0","createAt":1541640482779,"updateAt":1541640482779,"name":"Ajax-jsfile-preload-anyWhen-execute","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\t\t<script>\n\t\t\t/*\n\t\t\t * 利用object元素的特点，预先下载js文件，但不会执行。\n\t\t\t * 然后再等到需要时执行添加<script>元素，src和Object元素的src相同,这样就可以直接使用预先下载的js文件\n\t\t\t*/\n\t\t\tfunction addObjectElement(file_name){\n\t\t\t\tvar cache = document.createElement('object');\n\t\t\t\tcache.date = file_name;\n\t\t\t\tcache.id =  'object_cache_id';\n\t\t\t\tcache.width = 0;\n\t\t\t\tcache.height = 0;\n\t\t\t\tdocument.body.appendChild(cache);\n\t\t\t}\n\t\t\t\n\t\t\tfunction loadjs(file_name){\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.setAttribute('src',file_name);\n\t\t\t\tscript.setAttribute('type','text/javascript');\n\t\t\t\tscript.setAttribute('id','script_id');\n\t\t\t\t\n\t\t\t\tvar script_ele = document.getElementById('script_id');\n\t\t\t\tif (script_ele)\n\t\t\t\t\tdocument.body.removeChild(script_ele);\n\t\t\t\tdocument.body.appendChild(script);\n\t\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t</script>\n\t\t\n\t\t<button onclick = 'loadjs(\"./alert.js\")' > click me </button>\n\t\t\n\t\t<script>\n\t\t\t\n\t\t\taddObjectElement('./alert.js');\n\t\t\t\n\t  </script>\n\n\t</body>\n</html>","description":""},{"copy":0,"tags":[],"key":"f5d3fae18f2b833709e31bba544c726f581ef664","createAt":1541640489882,"updateAt":1541640489882,"name":"Ajax-jsfile-preload-anyWhen-execute","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\t\t<script>\n\t\t\t/*\n\t\t\t * 利用object元素的特点，预先下载js文件，但不会执行。\n\t\t\t * 然后再等到需要时执行添加<script>元素，src和Object元素的src相同,这样就可以直接使用预先下载的js文件\n\t\t\t*/\n\t\t\tfunction addObjectElement(file_name){\n\t\t\t\tvar cache = document.createElement('object');\n\t\t\t\tcache.date = file_name;\n\t\t\t\tcache.id =  'object_cache_id';\n\t\t\t\tcache.width = 0;\n\t\t\t\tcache.height = 0;\n\t\t\t\tdocument.body.appendChild(cache);\n\t\t\t}\n\t\t\t\n\t\t\tfunction loadjs(file_name){\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.setAttribute('src',file_name);\n\t\t\t\tscript.setAttribute('type','text/javascript');\n\t\t\t\tscript.setAttribute('id','script_id');\n\t\t\t\t\n\t\t\t\tvar script_ele = document.getElementById('script_id');\n\t\t\t\tif (script_ele)\n\t\t\t\t\tdocument.body.removeChild(script_ele);\n\t\t\t\tdocument.body.appendChild(script);\n\t\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t</script>\n\t\t\n\t\t<button onclick = 'loadjs(\"./alert.js\")' > click me </button>\n\t\t\n\t\t<script>\n\t\t\t\n\t\t\taddObjectElement('./alert.js');\n\t\t\t\n\t  </script>\n\n\t</body>\n</html>","description":""},{"copy":0,"tags":[],"key":"aba31911c9501e859ff78f35f4f2510478352efe","createAt":1541640497259,"updateAt":1541640497259,"name":"Ajax-jsfile-preload-anyWhen-execute","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\t\t<script>\n\t\t\t/*\n\t\t\t * 利用object元素的特点，预先下载js文件，但不会执行。\n\t\t\t * 然后再等到需要时执行添加<script>元素，src和Object元素的src相同,这样就可以直接使用预先下载的js文件\n\t\t\t*/\n\t\t\tfunction addObjectElement(file_name){\n\t\t\t\tvar cache = document.createElement('object');\n\t\t\t\tcache.date = file_name;\n\t\t\t\tcache.id =  'object_cache_id';\n\t\t\t\tcache.width = 0;\n\t\t\t\tcache.height = 0;\n\t\t\t\tdocument.body.appendChild(cache);\n\t\t\t}\n\t\t\t\n\t\t\tfunction loadjs(file_name){\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.setAttribute('src',file_name);\n\t\t\t\tscript.setAttribute('type','text/javascript');\n\t\t\t\tscript.setAttribute('id','script_id');\n\t\t\t\t\n\t\t\t\tvar script_ele = document.getElementById('script_id');\n\t\t\t\tif (script_ele)\n\t\t\t\t\tdocument.body.removeChild(script_ele);\n\t\t\t\tdocument.body.appendChild(script);\n\t\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t</script>\n\t\t\n\t\t<button onclick = 'loadjs(\"./alert.js\")' > click me </button>\n\t\t\n\t\t<script>\n\t\t\t\n\t\t\taddObjectElement('./alert.js');\n\t\t\t\n\t  </script>\n\n\t</body>\n</html>","description":""},{"copy":0,"tags":[],"key":"0e900874b24294de2251267a2161b8dedca1abf1","createAt":1541640504542,"updateAt":1541640504542,"name":"Ajax-jsfile-preload-anyWhen-execute","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\t\t<script>\n\t\t\t/*\n\t\t\t * 利用object元素的特点，预先下载js文件，但不会执行。\n\t\t\t * 然后再等到需要时执行添加<script>元素，src和Object元素的src相同,这样就可以直接使用预先下载的js文件\n\t\t\t*/\n\t\t\tfunction addObjectElement(file_name){\n\t\t\t\tvar cache = document.createElement('object');\n\t\t\t\tcache.date = file_name;\n\t\t\t\tcache.id =  'object_cache_id';\n\t\t\t\tcache.width = 0;\n\t\t\t\tcache.height = 0;\n\t\t\t\tdocument.body.appendChild(cache);\n\t\t\t}\n\t\t\t\n\t\t\tfunction loadjs(file_name){\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.setAttribute('src',file_name);\n\t\t\t\tscript.setAttribute('type','text/javascript');\n\t\t\t\tscript.setAttribute('id','script_id');\n\t\t\t\t\n\t\t\t\tvar script_ele = document.getElementById('script_id');\n\t\t\t\tif (script_ele)\n\t\t\t\t\tdocument.body.removeChild(script_ele);\n\t\t\t\tdocument.body.appendChild(script);\n\t\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t</script>\n\t\t\n\t\t<button onclick = 'loadjs(\"./alert.js\")' > click me </button>\n\t\t\n\t\t<script>\n\t\t\t\n\t\t\taddObjectElement('./alert.js');\n\t\t\t\n\t  </script>\n\n\t</body>\n</html>","description":""},{"copy":0,"tags":[],"key":"f5b637c532f523cde0d55af3a6b615d560a845ff","createAt":1541640584555,"updateAt":1541640584555,"name":"ArrayFlatten","lang":"JavaScript","value":"//数组的展开/扁平\n//[1,2,[2,3,[4,5]]]--->[1,2,2,3,4,5]\n\nfunction flatten(arr) {\n    if(!isArray(arr) || !arr.length) {\n        return [];\n    } else {\n        return Array.prototype.concat.apply([], arr.map(function(val) {\n            return isArray(val) ? flatten(val) : val;\n        }));\n    }\n\n    function isArray(arr) {\n        return Object.prototype.toString.call(arr).slice(8, -1).toLowerCase() === 'array';\n    }\n}","description":""},{"copy":0,"tags":[],"key":"8959f49305f058cc86146bfce5d97846b991f34f","createAt":1541640622519,"updateAt":1541640622519,"name":"Canvas-utilities","lang":"JavaScript","value":"// Revert to the last saved graphics state, but don't pop the stack.\nCanvasRenderingContext2D.prototype.revert = function() {\n    this.restore();  // Restore the old graphics state.\n    this.save();     // Save it again so we can go back to it.\n    return this;     // Allow method chaining.\n};\n// Set the graphics attributes specified by the properties of the object o.\n// Or, if no argument is passed, return the current attributes as an object.\n// Note that this does not handle the transformation or clipping region.\nCanvasRenderingContext2D.prototype.attrs = function(o) {\n    if (o) {\n        for(var a in o)       // For each property in o\n            this[a] = o[a];   // Set it as a graphics attribute\n        return this;          // Enable method chaining\n    }\n    else return {\n        fillStyle: this.fillStyle, font: this.font,\n        globalAlpha: this.globalAlpha,\n        globalCompositeOperation: this.globalCompositeOperation,\n        lineCap: this.lineCap, lineJoin: this.lineJoin,\n        lineWidth: this.lineWidth, miterLimit: this.miterLimit,\n        textAlign: this.textAlign, textBaseline: this.textBaseline,\n        shadowBlur: this.shadowBlur, shadowColor: this.shadowColor,\n        shadowOffsetX: this.shadowOffsetX, shadowOffsetY: this.shadowOffsetY,\n        strokeStyle: this.strokeStyle\n    };\n};","description":""},{"copy":0,"tags":[],"key":"bcc9c3d17039fccf241fd2e60d65b88c97e3bc4a","createAt":1541640667489,"updateAt":1541640667489,"name":"Class-add-properties-method-on-Object","lang":"JavaScript","value":"/*\n * Define a properties() method in Object.prototype that returns an\n * object representing the named properties of the object on which it\n * is invoked (or representing all own properties of the object, if\n * invoked with no arguments).  The returned object defines four useful\n * methods: toString(), descriptors(), hide(), and show().\n */\n(function namespace() {  // Wrap everything in a private function scope\n     // This is the function that becomes a method of all object\n     function properties() {\n         var names;  // An array of property names\n         if (arguments.length == 0)  // All own properties of this\n             names = Object.getOwnPropertyNames(this);\n         else if (arguments.length == 1 && Array.isArray(arguments[0]))\n             names = arguments[0];   // Or an array of names\n         else                        // Or the names in the argument list\n             names = Array.prototype.splice.call(arguments, 0);\n         // Return a new Properties object representing the named properties\n         return new Properties(this, names);\n     }\n     // Make it a new nonenumerable property of Object.prototype.\n     // This is the only value exported from this private function scope.\n     Object.defineProperty(Object.rototype, \"properties\", {\n         value: properties, \n         enumerable: false, writable: true, configurable: true\n     });\n\n     // This constructor function is invoked by the properties() function above.\n     // The Properties class represents a set of properties of an object.\n     function Properties(o, names) {\n         this.o = o;            // The object that the properties belong to\n         this.names = names;    // The names of the properties\n     }\n    \n     // Make the properties represented by this object nonenumerable\n     Properties.prototype.hide = function() {\n         var o = this.o, hidden = { enumerable: false };\n         this.names.forEach(function(n) {\n                                if (o.hasOwnProperty(n))\n                                    Object.defineProperty(o, n, hidden);\n                            });\n         return this;\n     };\n\n     // Make these properties read-only and nonconfigurable\n     Properties.prototype.freeze = function() {\n         var o = this.o, frozen = { writable: false, configurable: false };\n         this.names.forEach(function(n) {\n                                if (o.hasOwnProperty(n))\n                                    Object.defineProperty(o, n, frozen);\n                            });\n         return this;\n     };\n     // Return an object that maps names to descriptors for these properties.\n     // Use this to copy properties along with their attributes:\n     //   Object.defineProperties(dest, src.properties().descriptors());\n     Properties.prototype.descriptors = function() {\n         var o = this.o, desc = {};\n         this.names.forEach(function(n) {\n             if (!o.hasOwnProperty(n)) return;\n             desc[n] = Object.getOwnPropertyDescriptor(o,n);\n         });\n         return desc;\n     };\n\n     // Return a nicely formatted list of properties, listing the\n     // name, value and attributes. Uses the term \"permanent\" to mean\n     // nonconfigurable, \"readonly\" to mean nonwritable, and \"hidden\"\n     // to mean nonenumerable. Regular enumerable, writable, configurable\n     // properties have no attributes listed.\n     Properties.prototype.toString = function() {\n         var o = this.o; // Used in the nested function below\n         var lines = this.names.map(nameToString);\n         return \"{\\n  \" + lines.join(\",\\n  \") + \"\\n}\";\n        \n         function nameToString(n) {\n             var s = \"\", desc = Object.getOwnPropertyDescriptor(o, n);\n             if (!desc) return \"nonexistent \" + n + \": undefined\";\n             if (!desc.configurable) s += \"permanent \";\n             if ((desc.get && !desc.set) || !desc.writable) s += \"readonly \";\n             if (!desc.enumerable) s += \"hidden \";\n             if (desc.get || desc.set) s += \"accessor \" + n\n             else s += n + \": \" + ((typeof desc.value===\"function\")?\"function\"\n                                                                   :desc.value);\n             return s;\n         }\n     };\n     // Finally, make the instance methods of the prototype object above\n     // nonenumerable, using the methods we've defined here.\n     Properties.prototype.properties().hide();\n}()); // Invoke the enclosing function as soon as we're done defining it.","description":""},{"copy":0,"tags":[],"key":"6b5fbc2eac3de8ab39db35586d5b60b49134caa0","createAt":1541640703253,"updateAt":1541640703253,"name":"Class-cards","lang":"JavaScript","value":"function inherit(p) {\n    if (p == null) throw TypeError(); // p must be a non-null object\n    if (Object.create)                // If Object.create() is defined...\n        return Object.create(p);      //    then just use it.\n    var t = typeof p;                 // Otherwise do some more type checking\n    if (t !== \"object\" && t !== \"function\") throw TypeError();\n    function f() {};                  // Define a dummy constructor function.\n    f.prototype = p;                  // Set its prototype property to p.\n    return new f();                   // Use f() to create an \"heir\" of p.\n}\n\n// This function creates a new enumerated type.  The argument object specifies\n// the names and values of each instance of the class. The return value\n// is a constructor function that identifies the new class.  Note, however\n// that the constructor throws an exception: you can't use it to create new\n// instances of the type.  The returned constructor has properties that\n// map the name of a value to the value itself, and also a values array,\n// a foreach() iterator function\nfunction enumeration(namesToValues) {\n    // This is the dummy constructor function that will be the return value.\n    var enumeration = function() { throw \"Can't Instantiate Enumerations\"; };\n    \n    // Enumerated values inherit from this object.\n    var proto = enumeration.prototype = {\n        constructor: enumeration,                   // Identify type\n        toString: function() { return this.name; }, // Return name\n        valueOf: function() { return this.value; }, // Return value\n        toJSON: function() { return this.name; }    // For serialization\n    };\n    \n    enumeration.values = [];  // An array of the enumerated value objects\n    \n    // Now create the instances of this new type.\n    for(name in namesToValues) {         // For each value\n        var e = inherit(proto);          // Create an object to represent it\n        e.name = name;                   // Give it a name\n        e.value = namesToValues[name];   // And a value\n        enumeration[name] = e;           // Make it a property of constructor\n        enumeration.values.push(e);      // And store in the values array\n    }\n    \n    // A class method for iterating the instances of the class\n    enumeration.foreach = function(f,c) {\n        for(var i = 0; i < this.values.length; i++) f.call(c, this.values[i]);\n    };\n    \n    // Return the constructor that identifies the new type\n    return enumeration;\n}\n\n\nfunction Card(suit, rank) {\n    this.suit = suit;         // Each card has a suit\n    this.rank = rank;         // and a rank\n}\n\n\n// These enumerated types define the suit and rank values\nCard.Suit = enumeration({Clubs: 1, Diamonds: 2, Hearts:3, Spades:4});\nCard.Rank = enumeration({Two: 2, Three: 3, Four: 4, Five: 5, Six: 6, Seven: 7, Eight: 8, Nine: 9, Ten: 10, Jack: 11, Queen: 12, King: 13, Ace: 14});\n\n// Define a textual representation for a card\nCard.prototype.toString = function() {\n    return this.rank.toString() + \" of \" + this.suit.toString();\n};\n\n// Compare the value of two cards as you would in poker\nCard.prototype.compareTo = function(that) {\n    if (this.rank < that.rank) return -1;\n    if (this.rank > that.rank) return 1;\n    return 0;\n};\n\n// A function for ordering cards as you would in poker\nCard.orderByRank = function(a,b) { return a.compareTo(b); };\n\n// A function for ordering cards as you would in bridge\nCard.orderBySuit = function(a,b) {\n    if (a.suit < b.suit) return -1;\n    if (a.suit > b.suit) return 1;\n    if (a.rank < b.rank) return -1;\n    if (a.rank > b.rank) return  1;\n    return 0;\n};\n\n// Define a class to represent a standard deck of cards\nfunction Deck() {\n    var cards = this.cards = [];     // A deck is just an array of cards\n    Card.Suit.foreach(function(s) {  // Initialize the array\n    \tCard.Rank.foreach(function(r) {\n      \tcards.push(new Card(s,r));\n        \t});\n          \t});\n}\n\n// Shuffle method: shuffles cards in place and returns the deck\nDeck.prototype.shuffle = function() {\n    // For each element in the array, swap with a randomly chosen lower element\n    var deck = this.cards, len = deck.length;\n    for( var i = len-1; i > 0; i-- ) {\n        var r = Math.floor(Math.random()*(i+1)), temp;     // Random number\n        temp = deck[i], deck[i] = deck[r], deck[r] = temp; // Swap\n    }\n    return this;\n};\n\n// Deal method: returns an array of cards\nDeck.prototype.deal = function(n) { \n    if (this.cards.length < n) throw \"Out of cards\";\n    return this.cards.splice(this.cards.length-n, n);\n};\n\n// Create a new deck of cards, shuffle it, and deal a bridge hand\nvar deck = (new Deck()).shuffle();\nvar hand = deck.deal(13).sort(Card.orderBySuit);","description":""},{"copy":0,"tags":[],"key":"f0d392df5f1809c1b7f7067a763b62dde16fcb64","createAt":1541640736207,"updateAt":1541640736207,"name":"Class-define-property-set-attributes","lang":"JavaScript","value":"// Wrap our code in a function so we can define variables in the function scope\n// 这个例子在Object.prototype下增加一个\"objectId\"属性，并且设置了这个property的attribute\n// 当创建一个Object类型的对象时就会增加这个\"objectId\"属性\n// 访问这个属性的值通过get方法\n(function() {\n     // Define objectId as a nonenumerable property inherited by all objects.\n     // When this property is read, the getter function is invoked.\n     // It has no setter, so it is read-only.\n     // It is nonconfigurable, so it can't be deleted.\n     Object.defineProperty(Object.prototype, \"objectId\", {\n                               get: idGetter,       // Method to get value\n                               enumerable: false,   // Nonenumerable\n                               configurable: false  // Can't delete it\n                           });\n     // This is the getter function called when objectId is read\n     function idGetter() {             // A getter function to return the id\n         if (!(idprop in this)) {      // If object doesn't already have an id\n             if (!Object.isExtensible(this)) // And if we can add a property\n                 throw Error(\"Can't define id for nonextensible objects\");\n             Object.defineProperty(this, idprop, {         // Give it one now.\n                                       value: nextid++,    // This is the value\n                                       writable: false,    // Read-only\n                                       enumerable: false,  // Nonenumerable\n                                       configurable: false // Nondeletable\n                                   });\n         }\n         return this[idprop];          // Now return the existing or new value\n     };\n     // These variables are used by idGetter() and are private to this function\n     var idprop = \"**objectId**\";    // Assume this property isn't in use\n     var nextid = 1;                   // Start assigning ids at this #\n}()); // Invoke the wrapper function to run the code right away","description":""},{"copy":0,"tags":[],"key":"5e2d0ea979c53144d90dcde9abb9e427b5df0078","createAt":1541640805070,"updateAt":1541640805070,"name":"Class-defineSubClass","lang":"JavaScript","value":"function extend(o, p){\n\tfor(var prop in p){\n\t\to[prop] = p[prop];\n\t}\n\treturn o;\n}\n\nfunction inherit(p){\n\tif (p==null) throw TypeError();\n\t\tvar t = typeof p;\n\t\tif ( t !== \"function\" && t !== \"object\") throw TypeError();\n\t\t\tif (Object.create) return Object.create(p);\n\t\t\t\tfunction fn(){};\n\t\t\t\tfn.prototype = p;\n\t\t\t\treturn new fn();\n}\n\nfunction defineSubClass(superclass, constructor, methods, statics){\n\tconstructor.prototype = inherit(superclass.prototype);\n\tconstructor.prototype.constructor = superclass;\n\tif (methods) extend(constructor.prototype, methods);\n\tif (statics) extend(constructor, statics);\n\treturn constructor;\n}\n\n// We can also do this as a method of the superclass constructor\nFunction.prototype.extend = function(constructor, methods, statics) {\n    return defineSubclass(this, constructor, methods, statics);\n};","description":""},{"copy":0,"tags":[],"key":"13bb0a54e2a835ebce581b6a7b1d55d48e0256dc","createAt":1541640848147,"updateAt":1541640848147,"name":"Class-Factory-enumeration","lang":"JavaScript","value":"function inherit(p){\n\tif(p==null) throw TypeError();\n\t\tif(Object.create) return Object.create(p);\n\t\t\tvar t = typeof p;\n\t\t\tif ( p!==\"object\" && p!==\"function\") throw TypeError();\n\t\t\t\tfunction fn(){};\n\t\t\t\tfn.prototype = p;\n\t\t\t\treturn new fn();\n}\n\n// This function creates a new enumerated type.  The argument object specifies\n// the names and values of each instance of the class. The return value\n// is a constructor function that identifies the new class.  Note, however\n// that the constructor throws an exception: you can't use it to create new\n// instances of the type.  The returned constructor has properties that\n// map the name of a value to the value itself, and also a values array,\n// a foreach() iterator function\nfunction enumeration(namesToValues) {\n    // This is the dummy constructor function that will be the return value.\n    var enumeration = function() { throw \"Can't Instantiate Enumerations\"; };\n    // Enumerated values inherit from this object.\n    var proto = enumeration.prototype = {\n        constructor: enumeration,                   // Identify type\n        toString: function() { return this.name; }, // Return name\n        valueOf: function() { return this.value; }, // Return value\n        toJSON: function() { return this.name; }    // For serialization\n    };\n    enumeration.values = [];  // An array of the enumerated value objects\n    // Now create the instances of this new type.\n    for(name in namesToValues) {         // For each value\n        var e = inherit(proto);          // Create an object to represent it\n        e.name = name;                   // Give it a name\n        e.value = namesToValues[name];   // And a value\n        enumeration[name] = e;           // Make it a property of constructor\n        enumeration.values.push(e);      // And store in the values array\n    }\n    // A class method for iterating the instances of the class\n    enumeration.foreach = function(f,c) {\n        for(var i = 0; i < this.values.length; i++) f.call(c,this.values[i]);\n    };\n    // Return the constructor that identifies the new type\n    return enumeration;\n}","description":""},{"copy":0,"tags":[],"key":"f72cffb0f1c1995688649e576bc9dc5678e95c3f","createAt":1541640890026,"updateAt":1541640890026,"name":"Class-Factory-set-property-attribute","lang":"JavaScript","value":"// This function works with or without 'new': a constructor and factory function\nfunction Range(from,to) {\n    // These are descriptors for the read-only from and to properties.\n    var props = {\n        from: {value:from, enumerable:true, writable:false, configurable:false},\n        to: {value:to, enumerable:true, writable:false, configurable:false}\n    };\n   \n    if (this instanceof Range)                // If invoked as a constructor\n        Object.defineProperties(this, props); // Define the properties\n    else                                      // Otherwise, as a factory\n        return Object.create(Range.prototype, // Create and return a new\n                             props);          // Range object with props\n}\n\n// If we add properties to the Range.prototype object in the same way,\n// then we can set attributes on those properties.  Since we don't specify\n// enumerable, writable, or configurable, they all default to false.\nObject.defineProperties(Range.prototype, {\n    includes: {\n        value: function(x) { return this.from <= x && x <= this.to; }\n    },\n    foreach: {\n        value: function(f) {\n            for(var x = Math.ceil(this.from); x <= this.to; x++) f(x);\n        }\n    },\n    toString: {\n        value: function() { return \"(\" + this.from + \"...\" + this.to + \")\"; }\n    }\n});","description":""},{"copy":0,"tags":[],"key":"0e98abd4253bdcc19d6c1b3eca110d06571cb180","createAt":1541640927732,"updateAt":1541640927732,"name":"Class-get-set-encapsulate-state","lang":"JavaScript","value":"// Make the named (or all) properties of o nonenumerable, if configurable.\n/**\n * @param  {[type]}\n * @return {[type]}\n */\nfunction hideProps(o) {\n    var props = (arguments.length == 1)              // If 1 arg\n        ? Object.getOwnPropertyNames(o)              //  use all props\n        : Array.prototype.splice.call(arguments, 1); //  else named props\n    props.forEach(function(n) { // Hide each one from the for/in loop\n        // Ignore nonconfigurable properties\n        if (!Object.getOwnPropertyDescriptor(o,n).configurable) return;\n        Object.defineProperty(o, n, { enumerable: false });\n    });\n    return o;\n}\n\nfunction Range(from, to) {\n    // Verify that the invariant holds when we're created\n    if (from > to) throw new Error(\"Range: from must be <= to\");\n    // Define the accessor methods that maintain the invariant\n    function getFrom() {  return from; }\n    function getTo() {  return to; }\n    function setFrom(f) {  // Don't allow from to be set > to\n        if (f <= to) from = f;\n        else throw new Error(\"Range: from must be <= to\");\n    }\n    function setTo(t) {    // Don't allow to to be set < from\n        if (t >= from) to = t;\n        else throw new Error(\"Range: to must be >= from\");\n    }\n    // Create enumerable, nonconfigurable properties that use the accessors\n    Object.defineProperties(this, {\n        from: {get: getFrom, set: setFrom, enumerable:true, configurable:false},\n        to: { get: getTo, set: setTo, enumerable:true, configurable:false }\n    });\n}\n\n// The prototype object is unchanged from previous examples.\n// The instance methods read from and to as if they were ordinary properties.\nRange.prototype = hideProps({\n    constructor: Range,\n    includes: function(x) { return this.from <= x && x <= this.to; },\n    foreach: function(f) {for(var x=Math.ceil(this.from);x<=this.to;x++) f(x);},\n    toString: function() { return \"(\" + this.from + \"...\" + this.to + \")\"; }\n});","description":""},{"copy":0,"tags":[],"key":"5d6ac400cf3bb3fd5f309a067d6f7842bba81d05","createAt":1541640933420,"updateAt":1541640933420,"name":"Class-get-set-encapsulate-state","lang":"JavaScript","value":"// Make the named (or all) properties of o nonenumerable, if configurable.\n/**\n * @param  {[type]}\n * @return {[type]}\n */\nfunction hideProps(o) {\n    var props = (arguments.length == 1)              // If 1 arg\n        ? Object.getOwnPropertyNames(o)              //  use all props\n        : Array.prototype.splice.call(arguments, 1); //  else named props\n    props.forEach(function(n) { // Hide each one from the for/in loop\n        // Ignore nonconfigurable properties\n        if (!Object.getOwnPropertyDescriptor(o,n).configurable) return;\n        Object.defineProperty(o, n, { enumerable: false });\n    });\n    return o;\n}\n\nfunction Range(from, to) {\n    // Verify that the invariant holds when we're created\n    if (from > to) throw new Error(\"Range: from must be <= to\");\n    // Define the accessor methods that maintain the invariant\n    function getFrom() {  return from; }\n    function getTo() {  return to; }\n    function setFrom(f) {  // Don't allow from to be set > to\n        if (f <= to) from = f;\n        else throw new Error(\"Range: from must be <= to\");\n    }\n    function setTo(t) {    // Don't allow to to be set < from\n        if (t >= from) to = t;\n        else throw new Error(\"Range: to must be >= from\");\n    }\n    // Create enumerable, nonconfigurable properties that use the accessors\n    Object.defineProperties(this, {\n        from: {get: getFrom, set: setFrom, enumerable:true, configurable:false},\n        to: { get: getTo, set: setTo, enumerable:true, configurable:false }\n    });\n}\n\n// The prototype object is unchanged from previous examples.\n// The instance methods read from and to as if they were ordinary properties.\nRange.prototype = hideProps({\n    constructor: Range,\n    includes: function(x) { return this.from <= x && x <= this.to; },\n    foreach: function(f) {for(var x=Math.ceil(this.from);x<=this.to;x++) f(x);},\n    toString: function() { return \"(\" + this.from + \"...\" + this.to + \")\"; }\n});","description":""},{"copy":0,"tags":[],"key":"134e806e46efa5b7ac8bf92af0c280784d1239f3","createAt":1541640958334,"updateAt":1541640958334,"name":"Class-implement","lang":"JavaScript","value":"// Return true if o implements the methods specified by the remaining args.\nfunction quacks(o /*, ... */) {\n    for(var i = 1; i < arguments.length; i++) {  // for each argument after o\n        var arg = arguments[i];\n        switch(typeof arg) { // If arg is a:\n        case 'string':       // string: check for a method with that name\n            if (typeof o[arg] !== \"function\") return false;\n            continue;\n        case 'function':     // function: use the prototype object instead\n            // If the argument is a function, we use its prototype object\n            arg = arg.prototype;\n            // fall through to the next case\n        case 'object':       // object: check for matching methods\n            for(var m in arg) { // For each property of the object\n                if (typeof arg[m] !== \"function\") continue; // skip non-methods\n                if (typeof o[m] !== \"function\") return false;\n            }\n        }\n    }\n   \n    // If we're still here, then o implements everything\n    return true;\n}","description":""},{"copy":0,"tags":[],"key":"44eaf97234fd34ca055e76600dc93408477767a6","createAt":1541640989930,"updateAt":1541640989930,"name":"Class-new-inhert","lang":"JavaScript","value":"/*\n*通过new operate生成的object以后，prototype再增加一个方法，为什么这个已经生成object会有这个方法?\n*Answer:prototype chain\n*/\n\n    function Building(b_height,b_address,b_cost){\t\n    \tthis.b_height = b_height;\n    \tthis.b_address = b_address;\n    \tthis.b_cost = b_cost;\n    }\n    \n    Building.prototype = {\n    \tconstructor:Building,   //增加constructor property\n    \tdoBudget:function(){return this.b_cost},\n    \tdoLayFoundations:function(){return this.b_height},\n    \tdoBuild:function(){return this.b_address}\t\n    \t}\n    \t\n    var Station = new \tBuilding(10,\"new york\",\"500000$\"); //生成object TrainStation\n    \n    Building.prototype.doEraser = function(){this.b_height = 0, this.b_address = '', this.b_cost = '';}\n    \n    Station.doEraser();  //为什么已经生成的object TrainStation会有Building.prototype在object TrainStation 生成后再添加的方法？\n    \n    TrainStation.b_address;   //\"\" 方法的确有作用","description":""},{"copy":0,"tags":[],"key":"e492fb4a10ba6f01d1a372c34044d2e2f985c220","createAt":1541641014728,"updateAt":1541641014728,"name":"Class-prototype-object","lang":"JavaScript","value":"/*\n*execute 1\n*创建了一个building class,它有b_height,b_address,b_cost三个属性\n*b_height,b_address,b_cost三个属性是不共享的，这样每个instance的属性都可以不相同\n*building.build是一个prototype object,用于instance继承共享的属性\n*这是一个factory funtcion 的例子\n*/\nfunction inherit(p) {\n    if (p == null) throw TypeError(); // p must be a non-null object\n    if (Object.create)                // If Object.create() is defined...\n        return Object.create(p);      //    then just use it.\n    var t = typeof p;                 // Otherwise do some more type checking\n    if (t !== \"object\" && t !== \"function\") throw TypeError();\n    function f() {};                  // Define a dummy constructor function.\n    f.prototype = p;                  // Set its prototype property to p.\n    return new f();                   // Use f() to create an \"heir\" of p.\n}\n\nfunction building(b_height,b_address,b_cost){\n\tvar b = inherit(building.build);\n\tb.b_height = b_height;\n\tb.b_address = b_address;\n\tb.b_cost = b_cost;\n\t\n\treturn b;\n}\n\nbuilding.build = {\n\tdoBudget:function(){return this.b_cost},\n\tdoLayFoundations:function(){return this.b_height},\n\tdoBuild:function(){return this.b_address}\t\n}\n\nvar airfield = Building(100,\"beijing langfangqu\",\"2000000$\")\n\n//下面用constructor function 写法完成相同的内容\n\nfunction Building(b_height,b_address,b_cost){\t\n\tthis.b_height = b_height;\n\tthis.b_address = b_address;\n\tthis.b_cost = b_cost;\n}\n\nBuilding.prototype = {\n\tdoBudget:function(){return this.b_cost},\n\tdoLayFoundations:function(){return this.b_height},\n\tdoBuild:function(){return this.b_address}\t\n\t}\n\t\nvar TrainStation = new \tBuilding(10,\"tianjing\",\"500000$\");\n\n/*\n*execute 2\n对New 操作的理解\nMDN对New操作的解释 https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/new\nNew操作分为3个步骤：\n(1)A new object is created, inheriting from foo.prototype.\n(2)The constructor function foo is called with the specified arguments and this bound to the newly created object. new foo is equivalent to new foo(), i.e. if no argument list is specified, foo is called without arguments.\n(3)The object returned by the constructor function becomes the result of the whole new expression. If the constructor function doesn't explicitly return an object, the object created in step 1 is used instead. (Normally constructors don't return a value, but they can choose to do so if they want to override the normal object creation process.\n可以总结为，先产生了一个新的object,这个object继承了foo.prototype,然后this被绑定到这个新object(称为“prototype新object”),调用constructor function 为这个“prototype新object”初始化(须使用this关键字)。有趣的地方在后面――如果constructor function 有return 语句，则使用return 语句返回的object(这里称为\"return新object\"), 并用\"return新object\"替代“prototype新object”.但是一般constructor function不会有return语句。\n做一个试验，看是否的确如此\n*/\nfunction Building(b_height,b_address,b_cost){\n  var f = function(){}\t\t\n\tf.b_height = b_height; //这里使用f,而不是this,因为this指向了“prototype新object”\n\tf.b_address = b_address;\n\tf.b_cost = b_cost;\n\t\n\treturn f;\n\t\n}\n\nBuilding.prototype = {\n\tdoBudget:function(){return this.b_cost},\n\tdoLayFoundations:function(){return this.b_height},\n\tdoBuild:function(){return this.b_address}\t\n\t}\n\t\nvar station = new \tBuilding(10,\"tianjing\",\"500000$\");\n\n\nstation.doBudget;  //undefined,说明没有这个属性，说明\"return新object\"的确替代“prototype新object”.\n\n/*\n*execute 3\n*但是execute 1的第二部分代码这个例子没有体现contructor,prototype之间的关系，因为Building.prototype中并没有constructor property,\n*所以继承至Building.prototype的instance object也不会有constructor property,所以下面的例子更为完整\n*/\nfunction Building(b_height,b_address,b_cost){\t\n\tthis.b_height = b_height;\n\tthis.b_address = b_address;\n\tthis.b_cost = b_cost;\n}\n\nBuilding.prototype = {\n\tconstructor:Building,   //增加constructor property\n\tdoBudget:function(){return this.b_cost},\n\tdoLayFoundations:function(){return this.b_height},\n\tdoBuild:function(){return this.b_address}\t\n\t}\n\t\nvar TrainStation = new \tBuilding(10,\"tianjing\",\"500000$\");\n\nTrainStation.constructor === Building\n","description":""},{"copy":0,"tags":[],"key":"3dd60e0e1038dae18a8a601051cdd92aca6e6eeb","createAt":1541641051334,"updateAt":1541641067324,"name":"Class-set-toString","lang":"JavaScript","value":"function Set() {          // This is the constructor\n    this.values = {};     // The properties of this object hold the set\n    this.n = 0;           // How many values are in the set\n    this.add.apply(this, arguments);  // All arguments are values to add\n}\n// Add each of the arguments to the set.\nSet.prototype.add = function() {\n    for(var i = 0; i < arguments.length; i++) {  // For each argument\n        var val = arguments[i];                  // The value to add to the set\n        var str = Set._v2s(val);                 // Transform it to a string\n        if (!this.values.hasOwnProperty(str)) {  // If not already in the set\n            this.values[str] = val;              // Map string to value\n            this.n++;                            // Increase set size\n        }\n    }\n    return this;                                 // Support chained method calls\n};\n// Remove each of the arguments from the set.\nSet.prototype.remove = function() {\n    for(var i = 0; i < arguments.length; i++) {  // For each argument\n        var str = Set._v2s(arguments[i]);        // Map to a string\n        if (this.values.hasOwnProperty(str)) {   // If it is in the set\n            delete this.values[str];             // Delete it\n            this.n--;                            // Decrease set size\n        }\n    }\n    return this;                                 // For method chaining\n};\n// Return true if the set contains value; false otherwise.\nSet.prototype.contains = function(value) {\n    return this.values.hasOwnProperty(Set._v2s(value));\n};\n// Return the size of the set.\nSet.prototype.size = function() { return this.n; };\n// Call function f on the specified context for each element of the set.\nSet.prototype.foreach = function(f, context) {\n    for(var s in this.values)                 // For each string in the set\n        if (this.values.hasOwnProperty(s))    // Ignore inherited properties\n            f.call(context, this.values[s]);  // Call f on the value\n};\n// This internal function maps any JavaScript value to a unique string.\nSet._v2s = function(val) {\n    switch(val) {\n        case undefined:     return 'u';          // Special primitive\n        case null:          return 'n';          // values get single-letter\n        case true:          return 't';          // codes.\n        case false:         return 'f';\n        default: switch(typeof val) {\n            case 'number':  return '#' + val;    // Numbers get # prefix.\n            case 'string':  return '\"' + val;    // Strings get \" prefix.\n            default: return '@' + objectId(val); // Objs and funcs get @\n        }\n    }\n  }\n  \nfunction extend(o, p) {\n    for(prop in p) {                         // For all props in p.\n        o[prop] = p[prop];                   // Add the property to o.\n    }\n    return o;\n}  \n  \n// Add these methods to the Set prototype object.\nextend(Set.prototype, {\n           // Convert a set to a string\n           toString: function() {\n               var s = \"{\", i = 0;\n               this.foreach(function(v) { s += ((i++ > 0)?\", \":\"\") + v; });\n               return s + \"}\";\n           },\n           // Like toString, but call toLocaleString on all values\n           toLocaleString : function() {\n               var s = \"{\", i = 0;\n               this.foreach(function(v) {\n                                if (i++ > 0) s += \", \";\n                                if (v == null) s += v; // null & undefined\n                                else s += v.toLocaleString(); // all others\n                            });\n               return s + \"}\";\n           },\n           // Convert a set to an array of values\n           toArray: function() {\n               var a = [];\n               this.foreach(function(v) { a.push(v); });\n               return a;\n           }\n       });\n       \nvar set_o = new Set;\n\nset_o.toString();         ","description":""},{"copy":0,"tags":[],"key":"f63390569cf571616528d4fff268129d8bfc1c2d","createAt":1541641105538,"updateAt":1541641105538,"name":"Class-subclass-override-method","lang":"JavaScript","value":"function inherit(p){\n\tif (p == null) throw TypeError();\n\t\tvar t = typeof p;\n\t\tif ( t !== \"object\" && t !== \"function\")\tthrow TypeError();\n\t\t\tif (Object.create) Object.create(p);\n\t\t\t\tfunction fn(){};\n\t\t\t\tfn.prototype = p;\n\t\t\t\treturn new fn();\n}\n\nfunction filterSetSubclass(superclass, filter){\n\tvar constructor = function(){\n\t\tsuperclass.apply(this, arguments);\n\t}\n\n\tvar proto = constructor.prototype = inherit(superclass.prototype);\n\tproto.constructor = constructor;\n\tconstructor.superclass = superclass;\n\n\t//override add method of superclass\n\tproto.add = function(){\n\t\tfor(var i=0; i<arguments.length; i++){\n\t\t\tif (filter(arguments[i])) throw \"arguments refused by filter\";\n\t\t\tsuperclass.prototype.add.apply(this, arguments[i]);\n\t\t}\n\t}\n\treturn constructor;\n}","description":""},{"copy":0,"tags":[],"key":"37820060965f89a3f3290d63802d2462c3a12135","createAt":1541641132538,"updateAt":1541641132538,"name":"Class-type","lang":"JavaScript","value":"/**\n * Return the type of o as a string:\n *   -If o is null, return \"null\", if o is NaN, return \"nan\".\n *   -If typeof returns a value other than \"object\" return that value.\n *    (Note that some implementations identify regexps as functions.)\n *   -If the class of o is anything other than \"Object\", return that.\n *   -If o has a constructor and that constructor has a name, return it.\n *   -Otherwise, just return \"Object\".\n **/\nfunction type(o) {\n    var t, c, n;  // type, class, name\n    // Special case for the null value:\n    if (o === null) return \"null\";\n    // Another special case: NaN is the only value not equal to itself:\n    if (o !== o) return \"nan\";\n    // Use typeof for any value other than \"object\".\n    // This identifies any primitive value and also functions.\n    if ((t = typeof o) !== \"object\") return t;\n    // Return the class of the object unless it is \"Object\".\n    // This will identify most native objects.\n    if ((c = classof(o)) !== \"Object\") return c;\n    // Return the object's constructor name, if it has one\n    if (o.constructor && typeof o.constructor === \"function\" &&\n        (n = o.constructor.getName())) return n;\n    // We can't determine a more specific type, so return \"Object\"\n    return \"Object\";\n}\n// Return the class of an object.\nfunction classof(o) {\n    return Object.prototype.toString.call(o).slice(8,-1);\n};\n   \n// Return the name of a function (may be \"\") or null for nonfunctions\nFunction.prototype.getName = function() {\n    if (\"name\" in this) return this.name;\n    return this.name = this.toString().match(/function\\s*([^(]*)\\(/)[1];\n};","description":""},{"copy":0,"tags":[],"key":"475de798ed00b0e871f91e8203d1ed9bd52c6f2c","createAt":1541641169790,"updateAt":1541641169790,"name":"Class-Utilities-set-attribute-false","lang":"JavaScript","value":"// Make the named (or all) properties of o nonwritable and nonconfigurable.\nfunction freezeProps(o) {\n    var props = (arguments.length == 1)              // If 1 arg\n        ? Object.getOwnPropertyNames(o)              //  use all props\n        : Array.prototype.splice.call(arguments, 1); //  else named props\n    props.forEach(function(n) { // Make each one read-only and permanent\n        // Ignore nonconfigurable properties\n        if (!Object.getOwnPropertyDescriptor(o,n).configurable) return;\n        Object.defineProperty(o, n, { writable: false, configurable: false });\n    });\n    return o;  // So we can keep using it\n}\n\n// Make the named (or all) properties of o nonenumerable, if configurable.\nfunction hideProps(o) {\n    var props = (arguments.length == 1)              // If 1 arg\n        ? Object.getOwnPropertyNames(o)              //  use all props\n        : Array.prototype.splice.call(arguments, 1); //  else named props\n    props.forEach(function(n) { // Hide each one from the for/in loop\n        // Ignore nonconfigurable properties\n        if (!Object.getOwnPropertyDescriptor(o,n).configurable) return;\n        Object.defineProperty(o, n, { enumerable: false });\n    });\n    return o;\n}","description":""},{"copy":0,"tags":[],"key":"4950c2e62533c2574c5af81c725f93bb74cc6f35","createAt":1541641196290,"updateAt":1541641196290,"name":"DOM-AnyBrowser-getScrollOffsets-getViewportSize-coordinatesConvert","lang":"JavaScript","value":"function getScrollOffsets(w) {\n\t// Use the specified window or the current window if no argument\n\tw = w || window;\n\t// This works for all browsers except IE versions 8 and before\n\tif (w.pageXOffset != null) return {x: w.pageXOffset, y:w.pageYOffset};\n\t// For IE (or any browser) in Standards mode\n\tvar d = w.document;\n\tif (document.compatMode == \"CSS1Compat\")\n\treturn {x:d.documentElement.scrollLeft, y:d.documentElement.scrollTop};\n\t// For browsers in Quirks mode\n\treturn { x: d.body.scrollLeft, y: d.body.scrollTop };\n}\n\n// Return the viewport size as w and h properties of an object\nfunction getViewportSize(w) {\n    // Use the specified window or the current window if no argument\n    w = w || window;  \n    // This works for all browsers except IE8 and before\n    if (w.innerWidth != null) return {w: w.innerWidth, h:w.innerHeight};\n    // For IE (or any browser) in Standards mode\n    var d = w.document;\n    if (document.compatMode == \"CSS1Compat\")\n        return { w: d.documentElement.clientWidth,\n                 h: d.documentElement.clientHeight };\n    // For browsers in Quirks mode\n    return { w: d.body.clientWidth, h: d.body.clientWidth };\n}\n\n//convert document coordinates to viewport corrdinates\nvar box = e.getBoundingClientRect();  // Get position in viewport coordinates\nvar offsets = getScrollOffsets();     // Utility function defined above\nvar x = box.left + offsets.x;         // Convert to document coordinates\nvar y = box.top + offsets.y;\n\n//get width and height\nvar box = e.getBoundingClientRect();\nvar w = box.width || (box.right - box.left);\nvar h = box.height || (box.bottom - box.top);","description":""},{"copy":0,"tags":[],"key":"014ea864d887fe1be83f689c28d986830a24da1e","createAt":1541641232700,"updateAt":1541641232700,"name":"DOM-embolden","lang":"JavaScript","value":"// Replace the node n with a new <b> element and make n a child of that element.\nfunction embolden(n) {\n    // If we're passed a string instead of a node, treat it as an element id\n    if (typeof n == \"string\") n = document.getElementById(n);\n    var parent = n.parentNode;           // Get the parent of n\n    var b = document.createElement(\"b\"); // Create a <b> element\n    parent.replaceChild(b, n);           // Replace n with the <b> element\n    b.appendChild(n);                    // Make n a child of the <b> element\n}","description":""},{"copy":0,"tags":[],"key":"17f821fbc849ebdfff2e6c862894e81e12924217","createAt":1541641256828,"updateAt":1541641256828,"name":"DOM-Event-Cancellation","lang":"JavaScript","value":"<html>\n\t<head>\n\t</head>\n\t<body>\n\t\t<!--\n\t\t先给所有的button 注册事件\n\t\t再判断是哪个button，除btn1外，其他都cancel响应事件\n\t\t -->\n\t\t<button id=\"btn1\">click me</button>\n\t\t<button id=\"btn2\">click me</button>\n\t\t<button id=\"btn3\">click me</button>\n\t</body>\n\t<script type=\"text/javascript\" >\n\n\t\tvar btns = document.getElementsByTagName('button');\n\n\t\tfor (var i=0; i<btns.length; i++)\n\t\t\tbtns[i].addEventListener('click',clickBtn);\n\n\n\t\tfunction cancelHandler(event) {\n\t\t\tvar event = event || window.event;  // For IE\n\t\t\t/* Do something to handle the event here */\n\t\t\t// Now cancel the default action associated with the event\n\t\t\tif (event.preventDefault) event.preventDefault();  // Standard technique\n\t\t\tif (event.returnValue) event.returnValue = false;  // IE\n\t\t\treturn false;        // For handlers registered as object properties\n\t\t}\n\n\n\t\tfunction clickBtn(event){\n\t\t\tif (event.target.id == 'btn1') {\n\t\t\t\talert(event.target.id);\n\t\t\t} else {\n\t\t\t\tcancelHandler(event);\n\t\t\t}\n\n\t\t}\n\n\t</script>\n</html>","description":""},{"copy":0,"tags":[],"key":"86add51aee5d5dc9947ba1209db0ab5b70cb4801","createAt":1541641294208,"updateAt":1541641294208,"name":"DOM-get-TextNodeContent","lang":"JavaScript","value":"function textContent(e) {\n\tvar child, type, s = \"\";  // s holds the text of all children\n\tfor(child = e.firstChild; child != null; child = child.nextSibling) {\n\t\ttype = child.nodeType;\n\t\tif (type === 3 || type === 4)  // Text and CDATASection nodes\n\t\ts += child.nodeValue;\n\t\telse if (type === 1)           // Recurse for Element nodes\n\t\t\ts += textContent(child);\n\t\t}\n\t\treturn s;\n\t}","description":""},{"copy":0,"tags":[],"key":"258f6df4a56e61bfbc04321aa3dacec311550fa7","createAt":1541642063067,"updateAt":1541642063067,"name":"DOM-insert-node-at-specific-position","lang":"JavaScript","value":"function insertAt(parent, child, n) {\n    if (n < 0 || n > parent.childNodes.length) throw new Error(\"invalid index\");\n    else if (n == parent.childNodes.length) parent.appendChild(child);\n    else parent.insertBefore(child, parent.childNodes[n]);\n}","description":""},{"copy":0,"tags":[],"key":"b26d9d0b72113b3f3cdb808571d174b64a4906c9","createAt":1541642105391,"updateAt":1541642105391,"name":"DOM-lookup-select-context-on-URL","lang":"JavaScript","value":"<a href=\"javascript: var q;\n      if (window.getSelection) q = window.getSelection().toString();\n      else if (document.selection) q = document.selection.createRange().text;\n      void window.open('http://en.wikipedia.org/wiki/' + q);\">\n  Look Up Selected Text In Wikipedia\n</a>","description":""},{"copy":0,"tags":[],"key":"7dd55801be8fd7eec7cbd05c89257482cf37cf92","createAt":1541642151027,"updateAt":1541642151027,"name":"DOM-sort-table","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\t\t<table>\n\t\t\t<tbody>\n\t\t\t\t<tr>\n\t\t\t\t\t<th>name</th>\n\t\t\t\t\t<th>salary</th>\n\t\t\t\t\t<th>job</th>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>zhang</td>\n\t\t\t\t\t<td>1000</td>\n\t\t\t\t\t<td>dever</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>kursk</td>\n\t\t\t\t\t<td>20000</td>\n\t\t\t\t\t<td>dever</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>ligang</td>\n\t\t\t\t\t<td>500</td>\n\t\t\t\t\t<td>manager</td>\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>\n\n\n\t\t<script>\n\t\t\t// Sort the rows in first <tbody> of the specified table according to\n\t\t\t// the value of nth cell within each row. Use the comparator function\n\t\t\t// if one is specified. Otherwise, compare the values alphabetically.\n\t\t\t/*\n\t\t\t* table 被排序的table object\n\t\t\t* n 指定被排序的列\n\t\t\t* comparator 用于比较的函数,如果不指定，按字符比较\n\t\t\t*/\n\t\t\tfunction sortrows(table, n, comparator) {\n\t\t\t\tvar tbody = table.tBodies[0]; // First <tbody>; may be implicitly created\n\t\t\t\tvar rows = tbody.getElementsByTagName(\"tr\"); // All rows in the tbody\n\t\t\t\trows = Array.prototype.slice.call(rows,0);   // Snapshot in a true array\n\t\t\t\t// Now sort the rows based on the text in the nth <td> element\n\t\t\t\trows.sort(function(row1,row2) {\n\t\t\t\t\tvar cell1 = row1.getElementsByTagName(\"td\")[n];  // Get nth cell\n\t\t\t\t\tvar cell2 = row2.getElementsByTagName(\"td\")[n];  // of both rows\n\n\t\t\t\t\tif (!cell1) return -1; //first row is table head,should not to be sorted\n\n\t\t\t\t\tvar val1 = cell1.textContent || cell1.innerText; // Get text content\n\t\t\t\t\tvar val2 = cell2.textContent || cell2.innerText; // of the two cells\n\t\t\t\t\tif (comparator) return comparator(val1, val2);   // Compare them!\n\t\t\t\t\tif (val1 < val2) return -1;\n\t\t\t\t\telse if (val1 > val2) return 1;\n\t\t\t\t\t\telse return 0;\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// Now append the rows into the tbody in their sorted order.\n\t\t\t\t\t\t// This automatically moves them from their current location, so there\n\t\t\t\t\t\t// is no need to remove them first. If the <tbody> contains any\n\t\t\t\t\t\t// nodes other than <tr> elements, those nodes will float to the top.\n\t\t\t\t\t\tfor(var i = 0; i < rows.length; i++) tbody.appendChild(rows[i]);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Find the <th> elements of the table (assuming there is only one row of them)\n\t\t\t\t\t// and make them clickable so that clicking on a column header sorts\n\t\t\t\t\t// by that column.\n\t\t\t\t\tfunction makeSortable(table) {\n\t\t\t\t\t\tvar headers = table.getElementsByTagName(\"th\");\n\t\t\t\t\t\tfor(var i = 0; i < headers.length; i++) {\n\t\t\t\t\t\t\t(function(n) {  // Nested funtion to create a local scope\n\t\t\t\t\t\t\t\theaders[i].onclick = function() { sortrows(table, n, comparator); };\n\t\t\t\t\t\t\t}(i));          // Assign value of i to the local variable n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar comparator = function(val1, val2){\n\t\t\t\t\t\tif ( parseInt(val1) < val2) return -1;\n\t\t\t\t\t\telse if ( parseInt(val1) > val2) return 1;\n\t\t\t\t\t\t\telse return 0;\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tvar table = document.getElementsByTagName('table')[0];\n\n\t\t\t\t\t\t\tmakeSortable(table);\n\n\t\t\t\t\t\t</script>\n\t\t\t\t\t</body>\n\t\t\t\t</html>","description":""},{"copy":0,"tags":[],"key":"0ec876959db31bf562bcbf6efe4f1cbb2203f04b","createAt":1541642160328,"updateAt":1541642160328,"name":"DOM-sort-table","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\t\t<table>\n\t\t\t<tbody>\n\t\t\t\t<tr>\n\t\t\t\t\t<th>name</th>\n\t\t\t\t\t<th>salary</th>\n\t\t\t\t\t<th>job</th>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>zhang</td>\n\t\t\t\t\t<td>1000</td>\n\t\t\t\t\t<td>dever</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>kursk</td>\n\t\t\t\t\t<td>20000</td>\n\t\t\t\t\t<td>dever</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>ligang</td>\n\t\t\t\t\t<td>500</td>\n\t\t\t\t\t<td>manager</td>\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>\n\n\n\t\t<script>\n\t\t\t// Sort the rows in first <tbody> of the specified table according to\n\t\t\t// the value of nth cell within each row. Use the comparator function\n\t\t\t// if one is specified. Otherwise, compare the values alphabetically.\n\t\t\t/*\n\t\t\t* table 被排序的table object\n\t\t\t* n 指定被排序的列\n\t\t\t* comparator 用于比较的函数,如果不指定，按字符比较\n\t\t\t*/\n\t\t\tfunction sortrows(table, n, comparator) {\n\t\t\t\tvar tbody = table.tBodies[0]; // First <tbody>; may be implicitly created\n\t\t\t\tvar rows = tbody.getElementsByTagName(\"tr\"); // All rows in the tbody\n\t\t\t\trows = Array.prototype.slice.call(rows,0);   // Snapshot in a true array\n\t\t\t\t// Now sort the rows based on the text in the nth <td> element\n\t\t\t\trows.sort(function(row1,row2) {\n\t\t\t\t\tvar cell1 = row1.getElementsByTagName(\"td\")[n];  // Get nth cell\n\t\t\t\t\tvar cell2 = row2.getElementsByTagName(\"td\")[n];  // of both rows\n\n\t\t\t\t\tif (!cell1) return -1; //first row is table head,should not to be sorted\n\n\t\t\t\t\tvar val1 = cell1.textContent || cell1.innerText; // Get text content\n\t\t\t\t\tvar val2 = cell2.textContent || cell2.innerText; // of the two cells\n\t\t\t\t\tif (comparator) return comparator(val1, val2);   // Compare them!\n\t\t\t\t\tif (val1 < val2) return -1;\n\t\t\t\t\telse if (val1 > val2) return 1;\n\t\t\t\t\t\telse return 0;\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// Now append the rows into the tbody in their sorted order.\n\t\t\t\t\t\t// This automatically moves them from their current location, so there\n\t\t\t\t\t\t// is no need to remove them first. If the <tbody> contains any\n\t\t\t\t\t\t// nodes other than <tr> elements, those nodes will float to the top.\n\t\t\t\t\t\tfor(var i = 0; i < rows.length; i++) tbody.appendChild(rows[i]);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Find the <th> elements of the table (assuming there is only one row of them)\n\t\t\t\t\t// and make them clickable so that clicking on a column header sorts\n\t\t\t\t\t// by that column.\n\t\t\t\t\tfunction makeSortable(table) {\n\t\t\t\t\t\tvar headers = table.getElementsByTagName(\"th\");\n\t\t\t\t\t\tfor(var i = 0; i < headers.length; i++) {\n\t\t\t\t\t\t\t(function(n) {  // Nested funtion to create a local scope\n\t\t\t\t\t\t\t\theaders[i].onclick = function() { sortrows(table, n, comparator); };\n\t\t\t\t\t\t\t}(i));          // Assign value of i to the local variable n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar comparator = function(val1, val2){\n\t\t\t\t\t\tif ( parseInt(val1) < val2) return -1;\n\t\t\t\t\t\telse if ( parseInt(val1) > val2) return 1;\n\t\t\t\t\t\t\telse return 0;\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tvar table = document.getElementsByTagName('table')[0];\n\n\t\t\t\t\t\t\tmakeSortable(table);\n\n\t\t\t\t\t\t</script>\n\t\t\t\t\t</body>\n\t\t\t\t</html>","description":""},{"copy":0,"tags":[],"key":"426434f086e1f4d3bad51d41be7df4de2f262358","createAt":1541642169635,"updateAt":1541642169635,"name":"DOM-sort-table","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\t\t<table>\n\t\t\t<tbody>\n\t\t\t\t<tr>\n\t\t\t\t\t<th>name</th>\n\t\t\t\t\t<th>salary</th>\n\t\t\t\t\t<th>job</th>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>zhang</td>\n\t\t\t\t\t<td>1000</td>\n\t\t\t\t\t<td>dever</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>kursk</td>\n\t\t\t\t\t<td>20000</td>\n\t\t\t\t\t<td>dever</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>ligang</td>\n\t\t\t\t\t<td>500</td>\n\t\t\t\t\t<td>manager</td>\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>\n\n\n\t\t<script>\n\t\t\t// Sort the rows in first <tbody> of the specified table according to\n\t\t\t// the value of nth cell within each row. Use the comparator function\n\t\t\t// if one is specified. Otherwise, compare the values alphabetically.\n\t\t\t/*\n\t\t\t* table 被排序的table object\n\t\t\t* n 指定被排序的列\n\t\t\t* comparator 用于比较的函数,如果不指定，按字符比较\n\t\t\t*/\n\t\t\tfunction sortrows(table, n, comparator) {\n\t\t\t\tvar tbody = table.tBodies[0]; // First <tbody>; may be implicitly created\n\t\t\t\tvar rows = tbody.getElementsByTagName(\"tr\"); // All rows in the tbody\n\t\t\t\trows = Array.prototype.slice.call(rows,0);   // Snapshot in a true array\n\t\t\t\t// Now sort the rows based on the text in the nth <td> element\n\t\t\t\trows.sort(function(row1,row2) {\n\t\t\t\t\tvar cell1 = row1.getElementsByTagName(\"td\")[n];  // Get nth cell\n\t\t\t\t\tvar cell2 = row2.getElementsByTagName(\"td\")[n];  // of both rows\n\n\t\t\t\t\tif (!cell1) return -1; //first row is table head,should not to be sorted\n\n\t\t\t\t\tvar val1 = cell1.textContent || cell1.innerText; // Get text content\n\t\t\t\t\tvar val2 = cell2.textContent || cell2.innerText; // of the two cells\n\t\t\t\t\tif (comparator) return comparator(val1, val2);   // Compare them!\n\t\t\t\t\tif (val1 < val2) return -1;\n\t\t\t\t\telse if (val1 > val2) return 1;\n\t\t\t\t\t\telse return 0;\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// Now append the rows into the tbody in their sorted order.\n\t\t\t\t\t\t// This automatically moves them from their current location, so there\n\t\t\t\t\t\t// is no need to remove them first. If the <tbody> contains any\n\t\t\t\t\t\t// nodes other than <tr> elements, those nodes will float to the top.\n\t\t\t\t\t\tfor(var i = 0; i < rows.length; i++) tbody.appendChild(rows[i]);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Find the <th> elements of the table (assuming there is only one row of them)\n\t\t\t\t\t// and make them clickable so that clicking on a column header sorts\n\t\t\t\t\t// by that column.\n\t\t\t\t\tfunction makeSortable(table) {\n\t\t\t\t\t\tvar headers = table.getElementsByTagName(\"th\");\n\t\t\t\t\t\tfor(var i = 0; i < headers.length; i++) {\n\t\t\t\t\t\t\t(function(n) {  // Nested funtion to create a local scope\n\t\t\t\t\t\t\t\theaders[i].onclick = function() { sortrows(table, n, comparator); };\n\t\t\t\t\t\t\t}(i));          // Assign value of i to the local variable n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar comparator = function(val1, val2){\n\t\t\t\t\t\tif ( parseInt(val1) < val2) return -1;\n\t\t\t\t\t\telse if ( parseInt(val1) > val2) return 1;\n\t\t\t\t\t\t\telse return 0;\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tvar table = document.getElementsByTagName('table')[0];\n\n\t\t\t\t\t\t\tmakeSortable(table);\n\n\t\t\t\t\t\t</script>\n\t\t\t\t\t</body>\n\t\t\t\t</html>","description":""},{"copy":0,"tags":[],"key":"3085df3e7b62dedc50b2699784fd733738f6ac0d","createAt":1541642178699,"updateAt":1541642178699,"name":"DOM-sort-table","lang":"JavaScript","value":"<!DOCTYPE html>                 <!-- This is an HTML5 file -->\n<html>                          <!-- The root element -->\n\t<head>                          <!-- Title, scripts & styles go here -->\n\t\t<title>Digital Clock</title>\n\t</head>\n\t<body>\n\t\t<table>\n\t\t\t<tbody>\n\t\t\t\t<tr>\n\t\t\t\t\t<th>name</th>\n\t\t\t\t\t<th>salary</th>\n\t\t\t\t\t<th>job</th>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>zhang</td>\n\t\t\t\t\t<td>1000</td>\n\t\t\t\t\t<td>dever</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>kursk</td>\n\t\t\t\t\t<td>20000</td>\n\t\t\t\t\t<td>dever</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>ligang</td>\n\t\t\t\t\t<td>500</td>\n\t\t\t\t\t<td>manager</td>\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>\n\n\n\t\t<script>\n\t\t\t// Sort the rows in first <tbody> of the specified table according to\n\t\t\t// the value of nth cell within each row. Use the comparator function\n\t\t\t// if one is specified. Otherwise, compare the values alphabetically.\n\t\t\t/*\n\t\t\t* table 被排序的table object\n\t\t\t* n 指定被排序的列\n\t\t\t* comparator 用于比较的函数,如果不指定，按字符比较\n\t\t\t*/\n\t\t\tfunction sortrows(table, n, comparator) {\n\t\t\t\tvar tbody = table.tBodies[0]; // First <tbody>; may be implicitly created\n\t\t\t\tvar rows = tbody.getElementsByTagName(\"tr\"); // All rows in the tbody\n\t\t\t\trows = Array.prototype.slice.call(rows,0);   // Snapshot in a true array\n\t\t\t\t// Now sort the rows based on the text in the nth <td> element\n\t\t\t\trows.sort(function(row1,row2) {\n\t\t\t\t\tvar cell1 = row1.getElementsByTagName(\"td\")[n];  // Get nth cell\n\t\t\t\t\tvar cell2 = row2.getElementsByTagName(\"td\")[n];  // of both rows\n\n\t\t\t\t\tif (!cell1) return -1; //first row is table head,should not to be sorted\n\n\t\t\t\t\tvar val1 = cell1.textContent || cell1.innerText; // Get text content\n\t\t\t\t\tvar val2 = cell2.textContent || cell2.innerText; // of the two cells\n\t\t\t\t\tif (comparator) return comparator(val1, val2);   // Compare them!\n\t\t\t\t\tif (val1 < val2) return -1;\n\t\t\t\t\telse if (val1 > val2) return 1;\n\t\t\t\t\t\telse return 0;\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// Now append the rows into the tbody in their sorted order.\n\t\t\t\t\t\t// This automatically moves them from their current location, so there\n\t\t\t\t\t\t// is no need to remove them first. If the <tbody> contains any\n\t\t\t\t\t\t// nodes other than <tr> elements, those nodes will float to the top.\n\t\t\t\t\t\tfor(var i = 0; i < rows.length; i++) tbody.appendChild(rows[i]);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Find the <th> elements of the table (assuming there is only one row of them)\n\t\t\t\t\t// and make them clickable so that clicking on a column header sorts\n\t\t\t\t\t// by that column.\n\t\t\t\t\tfunction makeSortable(table) {\n\t\t\t\t\t\tvar headers = table.getElementsByTagName(\"th\");\n\t\t\t\t\t\tfor(var i = 0; i < headers.length; i++) {\n\t\t\t\t\t\t\t(function(n) {  // Nested funtion to create a local scope\n\t\t\t\t\t\t\t\theaders[i].onclick = function() { sortrows(table, n, comparator); };\n\t\t\t\t\t\t\t}(i));          // Assign value of i to the local variable n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar comparator = function(val1, val2){\n\t\t\t\t\t\tif ( parseInt(val1) < val2) return -1;\n\t\t\t\t\t\telse if ( parseInt(val1) > val2) return 1;\n\t\t\t\t\t\t\telse return 0;\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tvar table = document.getElementsByTagName('table')[0];\n\n\t\t\t\t\t\t\tmakeSortable(table);\n\n\t\t\t\t\t\t</script>\n\t\t\t\t\t</body>\n\t\t\t\t</html>","description":""},{"copy":0,"tags":[],"key":"cce3fd0c901b43696761d5c032206aeea0adc232","createAt":1541642218887,"updateAt":1541642218887,"name":"Form-Post-Get-Formdate-encodeURIComponent","lang":"JavaScript","value":"function encodeFormData(data) {\n\tif (!data) return \"\";    // Always return a string\n\tvar pairs = [];          // To hold name=value pairs\n\tfor(var name in data) {                                  // For each name\n\t\tif (!data.hasOwnProperty(name)) continue;            // Skip inherited\n\t\tif (typeof data[name] === \"function\") continue;      // Skip methods\n\t\tvar value = data[name].toString();                   // Value as string\n\t\tname = encodeURIComponent(name.replace(\" \", \"+\"));   // Encode name\n\t\tvalue = encodeURIComponent(value.replace(\" \", \"+\")); // Encode value\n\t\tpairs.push(name + \"=\" + value);   // Remember name=value pair\n\t}\n\treturn pairs.join('&'); // Return joined pairs separated with &\n}\n\nfunction postData(url, data, callback) {\n\tvar request = new XMLHttpRequest();\n\trequest.open(\"POST\", url);                    // POST to the specified url\n\trequest.onreadystatechange = function() {     // Simple event handler\n\t\tif (request.readyState === 4 && callback) // When response is complete\n\t\tcallback(request.responseText);                    // call the callback.\n\t};\n\trequest.setRequestHeader(\"Content-Type\",      // Set Content-Type\n\t\"application/x-www-form-urlencoded\");\n\trequest.send(encodeFormData(data));           // Send form-encoded data\n}\n\nfunction getData(url, data, callback) {\n\tvar request = new XMLHttpRequest();\n\trequest.open(\"GET\", url +                     // GET the specified url\n\t\"?\" + encodeFormData(data));     // with encoded data added\n\trequest.onreadystatechange = function() {     // Simple event handler\n\t\tif (request.readyState === 4 && callback) callback(request);\n\t};\n\trequest.send(null);                           // Send the request\n}\n\nvar data_temp = {find: \"pizza\",zipcode: 02134,radius: \"1km\"};\npostData(\"http://127.0.0.1/myClass.php\",data_temp,function(msg){\n\tdocument.getElementById('p_tag').innerText = msg;\n});","description":""},{"copy":0,"tags":[],"key":"653c2b9acbfcc9eaea6d6539c3411fe8b8f14bd4","createAt":1541642255773,"updateAt":1541642255773,"name":"Func-As-Namespaces","lang":"JavaScript","value":"// Define an extend function that copies the properties of its second and\n// subsequent arguments onto its first argument.\n// We work around an IE bug here: in many versions of IE, the for/in loop\n// won't enumerate an enumerable property of o if the prototype of o has\n// a nonenumerable property by the same name. This means that properties\n// like toString are not handled correctly unless we explicitly check for them.\nvar extend = (function() {  // Assign the return value of this function\n    // First check for the presence of the bug before patching it.\n    for(var p in {toString:null}) {\n        // If we get here, then the for/in loop works correctly and we return\n        // a simple version of the extend() function\n        return function extend(o) {\n            for(var i = 1; i < arguments.length; i++) {\n                var source = arguments[i];\n                for(var prop in source) o[prop] = source[prop];\n            }\n            return o;\n        };\n    }\n    // If we get here, it means that the for/in loop did not enumerate\n    // the toString property of the test object. So return a version\n    // of the extend() function that explicitly tests for the nonenumerable\n    // properties of Object.prototype.\n    return function patched_extend(o) {\n        for(var i = 1; i < arguments.length; i++) {\n            var source = arguments[i];\n            // Copy all the enumerable properties\n            for(var prop in source) o[prop] = source[prop];\n            // And now check the special-case properties\n            for(var j = 0; j < protoprops.length; j++) {\n                prop = protoprops[j];\n                if (source.hasOwnProperty(prop)) o[prop] = source[prop];\n            }\n        }\n        return o;\n    };\n    // This is the list of special-case properties we check for\n    var protoprops = [\"toString\", \"valueOf\", \"constructor\", \"hasOwnProperty\",\n                      \"isPrototypeOf\", \"propertyIsEnumerable\",\"toLocaleString\"];\n}());","description":""},{"copy":0,"tags":[],"key":"72bb527859912e7c8a05a2170a29792bde05d91e","createAt":1541642282599,"updateAt":1541642282599,"name":"Func-factory-function","lang":"JavaScript","value":"function inherit(p) {\n    if (p == null) throw TypeError(); // p must be a non-null object\n    if (Object.create)                // If Object.create() is defined...\n        return Object.create(p);      //    then just use it.\n    var t = typeof p;                 // Otherwise do some more type checking\n    if (t !== \"object\" && t !== \"function\") throw TypeError();\n    function f() {};                  // Define a dummy constructor function.\n    f.prototype = p;                  // Set its prototype property to p.\n    return new f();                   // Use f() to create an \"heir\" of p.\n}\n\n// This function creates a new enumerated type.  The argument object specifies\n// the names and values of each instance of the class. The return value\n// is a constructor function that identifies the new class.  Note, however\n// that the constructor throws an exception: you can't use it to create new\n// instances of the type.  The returned constructor has properties that\n// map the name of a value to the value itself, and also a values array,\n// a foreach() iterator function\nfunction enumeration(namesToValues) {\n    // This is the dummy constructor function that will be the return value.\n    var enumeration = function() { throw \"Can't Instantiate Enumerations\"; };\n    \n    // Enumerated values inherit from this object.\n    var proto = enumeration.prototype = {\n        constructor: enumeration,                   // Identify type\n        toString: function() { return this.name; }, // Return name\n        valueOf: function() { return this.value; }, // Return value\n        toJSON: function() { return this.name; }    // For serialization\n    };\n    \n    enumeration.values = [];  // An array of the enumerated value objects\n    \n    // Now create the instances of this new type.\n    for(name in namesToValues) {         // For each value\n        var e = inherit(proto);          // Create an object to represent it\n        e.name = name;                   // Give it a name\n        e.value = namesToValues[name];   // And a value\n        enumeration[name] = e;           // Make it a property of constructor\n        enumeration.values.push(e);      // And store in the values array\n    }\n    \n    // A class method for iterating the instances of the class\n    enumeration.foreach = function(f,c) {\n        for(var i = 0; i < this.values.length; i++) f.call(c, this.values[i]);\n    };\n    \n    // Return the constructor that identifies the new type\n    return enumeration;\n}\n\n\n// Create a new Coin class with four values: Coin.Penny, Coin.Nickel, etc.\nvar Coin = enumeration({Penny: 1, Nickel:5, Dime:10, Quarter:25});\nvar c = Coin.Dime;                   // This is an instance of the new class\nc instanceof Coin                    // => true: instanceof works\nc.constructor == Coin                // => true: constructor property works\nCoin.Quarter + 3*Coin.Nickel         // => 40: values convert to numbers\nCoin.Dime == 10                      // => true: more conversion to numbers\nCoin.Dime > Coin.Nickel              // => true: relational operators work\nString(Coin.Dime) + \":\" + Coin.Dime  // => \"Dime:10\": coerce to string","description":""},{"copy":0,"tags":[],"key":"eabaf4f184be26348fa1b430d04b78b6123253cc","createAt":1541642293041,"updateAt":1541642293041,"name":"Func-factory-function","lang":"JavaScript","value":"function inherit(p) {\n    if (p == null) throw TypeError(); // p must be a non-null object\n    if (Object.create)                // If Object.create() is defined...\n        return Object.create(p);      //    then just use it.\n    var t = typeof p;                 // Otherwise do some more type checking\n    if (t !== \"object\" && t !== \"function\") throw TypeError();\n    function f() {};                  // Define a dummy constructor function.\n    f.prototype = p;                  // Set its prototype property to p.\n    return new f();                   // Use f() to create an \"heir\" of p.\n}\n\n// This function creates a new enumerated type.  The argument object specifies\n// the names and values of each instance of the class. The return value\n// is a constructor function that identifies the new class.  Note, however\n// that the constructor throws an exception: you can't use it to create new\n// instances of the type.  The returned constructor has properties that\n// map the name of a value to the value itself, and also a values array,\n// a foreach() iterator function\nfunction enumeration(namesToValues) {\n    // This is the dummy constructor function that will be the return value.\n    var enumeration = function() { throw \"Can't Instantiate Enumerations\"; };\n    \n    // Enumerated values inherit from this object.\n    var proto = enumeration.prototype = {\n        constructor: enumeration,                   // Identify type\n        toString: function() { return this.name; }, // Return name\n        valueOf: function() { return this.value; }, // Return value\n        toJSON: function() { return this.name; }    // For serialization\n    };\n    \n    enumeration.values = [];  // An array of the enumerated value objects\n    \n    // Now create the instances of this new type.\n    for(name in namesToValues) {         // For each value\n        var e = inherit(proto);          // Create an object to represent it\n        e.name = name;                   // Give it a name\n        e.value = namesToValues[name];   // And a value\n        enumeration[name] = e;           // Make it a property of constructor\n        enumeration.values.push(e);      // And store in the values array\n    }\n    \n    // A class method for iterating the instances of the class\n    enumeration.foreach = function(f,c) {\n        for(var i = 0; i < this.values.length; i++) f.call(c, this.values[i]);\n    };\n    \n    // Return the constructor that identifies the new type\n    return enumeration;\n}\n\n\n// Create a new Coin class with four values: Coin.Penny, Coin.Nickel, etc.\nvar Coin = enumeration({Penny: 1, Nickel:5, Dime:10, Quarter:25});\nvar c = Coin.Dime;                   // This is an instance of the new class\nc instanceof Coin                    // => true: instanceof works\nc.constructor == Coin                // => true: constructor property works\nCoin.Quarter + 3*Coin.Nickel         // => 40: values convert to numbers\nCoin.Dime == 10                      // => true: more conversion to numbers\nCoin.Dime > Coin.Nickel              // => true: relational operators work\nString(Coin.Dime) + \":\" + Coin.Dime  // => \"Dime:10\": coerce to string","description":""},{"copy":0,"tags":[],"key":"66041a7136f2cae7287958f4682afe304bafb2f6","createAt":1541642319037,"updateAt":1541642319037,"name":"Func-function-factorial","lang":"JavaScript","value":"// Compute factorials and cache results as properties of the function itself.\n//通过property将每次的值存起来，factorial既是一个function，又像一个数组\nfunction factorial(n) {\n    if (isFinite(n) && n>0 && n==Math.round(n)) { // Finite, positive ints only\n        if (!(n in factorial))                    // If no cached result\n            factorial[n] = n * factorial(n-1);    // Compute and cache it\n        return factorial[n];                      // Return the cached result\n    }\n    else return NaN;                              // If input was bad\n}\nfactorial[1] = 1;  // Initialize the cache to hold this base case.\nfactorial(5);\n\n//这个函数的有趣之处在于，将中间过程变量factorial[n] 存储了下来\n//也可以换一种写法，下面是用high-order function\nfunction memoize(f){\n\tvar cache={};\n\t\n\treturn function(){\n\t\tvar key=arguments.length + Array.prototype.join.call(arguments,\",\");\n\t\tif (key in cache) return cache[key];\n\t\telse return cache[key] = f.apply(this,arguments);\n\t}\n}\n\nvar factorial = memoize(function(n) {\n                            return (n <= 1) ? 1 : n * factorial(n-1);\n                        });\n                        \nfactorial(5)      // => 120                        ","description":""},{"copy":0,"tags":[],"key":"e5d033036b0fce18dce7f904d10f8c15d91316a6","createAt":1541642431471,"updateAt":1541642431471,"name":"Func-high-order-function-pass-parameter","lang":"JavaScript","value":"// Return a function that expects an array argument and applies f to\n// each element, returning the array of return values.\n// Contrast this with the map() function from earlier.\nfunction mapper(f) {\n    return function(a) { return map(a, f); };\n}\n\nvar increment = function(x) { return x+1; };\nvar incrementer = mapper(increment);\nincrementer([1,2,3])  // => [2,3,4]   注意参数是怎么传递的","description":""},{"copy":0,"tags":[],"key":"06a6bc457442e8f33ef0219402416c545cd15835","createAt":1541642487671,"updateAt":1541642487671,"name":"Func-high-order-functio-return-logic-negation","lang":"JavaScript","value":"// This higher-order function returns a new function that passes its\n// arguments to f and returns the logical negation of f's return value;\nfunction not(f) {\n    return function() {                        // Return a new function\n        var result = f.apply(this, arguments); // that calls f\n        return !result;                        // and negates its result.\n    };\n}\nvar even = function(x) { // A function to determine if a number is even\n    return x % 2 === 0;\n};   \n\nvar odd = not(even);     // A new function that does the opposite\n[1,1,3,5,5].every(odd);  // => true: every element of the array is odd","description":""},{"copy":0,"tags":[],"key":"3e45cc0a1c9c6f809b26fc2ed1691cbd6d4d1a65","createAt":1541642498490,"updateAt":1541642498490,"name":"Func-high-order-functio-return-logic-negation","lang":"JavaScript","value":"// This higher-order function returns a new function that passes its\n// arguments to f and returns the logical negation of f's return value;\nfunction not(f) {\n    return function() {                        // Return a new function\n        var result = f.apply(this, arguments); // that calls f\n        return !result;                        // and negates its result.\n    };\n}\nvar even = function(x) { // A function to determine if a number is even\n    return x % 2 === 0;\n};   \n\nvar odd = not(even);     // A new function that does the opposite\n[1,1,3,5,5].every(odd);  // => true: every element of the array is odd","description":""},{"copy":0,"tags":[],"key":"2120fae2059370063532b7d09a913047dc9b6518","createAt":1541642509901,"updateAt":1541642509901,"name":"Func-high-order-functio-return-logic-negation","lang":"JavaScript","value":"// This higher-order function returns a new function that passes its\n// arguments to f and returns the logical negation of f's return value;\nfunction not(f) {\n    return function() {                        // Return a new function\n        var result = f.apply(this, arguments); // that calls f\n        return !result;                        // and negates its result.\n    };\n}\nvar even = function(x) { // A function to determine if a number is even\n    return x % 2 === 0;\n};   \n\nvar odd = not(even);     // A new function that does the opposite\n[1,1,3,5,5].every(odd);  // => true: every element of the array is odd","description":""},{"copy":0,"tags":[],"key":"c6103919d63ca97a1fa7d0e7fe33a01f92aed618","createAt":1541642552591,"updateAt":1541642552591,"name":"getMaxNumberOfChar","lang":"JavaScript","value":"//找出字符串中出现最多的字母\nfunction getMaxNumberOfChar(str) {\n    return (str + '').split('').reduce(function(pre, cur, index, arr) {\n        cur in pre ? pre[cur]++ : (pre[cur] = 1);\n        pre[cur] > pre.value && (pre.char = cur, pre.value = pre[cur]);\n        return pre;\n    }, {value: 0});\n}","description":""},{"copy":0,"tags":[],"key":"d224fab1ee18425f155de988f6e58e6925786081","createAt":1541642584163,"updateAt":1541642584163,"name":"HTML5-polygon","lang":"HTML","value":"<!doctype html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"utf-8\">\n  <title>on demo</title>\n  <script src=\"jquery-1.11.1.js\"></script>\n</head>\n<body>\n<h2></h2>\n<canvas id=\"my_canvas_id\" width=1000 height=500  style=\"border:1px solid #aaa;display:block;margin:50px auto;\"></canvas>\n<script>\nvar canvas = document.getElementById(\"my_canvas_id\");\nvar c = canvas.getContext('2d');\n\n// Define a regular polygon with n sides, centered at (x,y) with radius r.\n// The vertices are equally spaced along the circumference of a circle.\n// Put the first vertex straight up or at the specified angle.\n// Rotate clockwise, unless the last argument is true.\nfunction polygon(c,n,x,y,r,angle,counterclockwise) {\n    angle = angle || 0;\n    counterclockwise = counterclockwise || false;\n    c.moveTo(x + r*Math.sin(angle),  // Begin a new subpath at the first vertex\n             y - r*Math.cos(angle)); // Use trigonometry to compute position\n    var delta = 2*Math.PI/n;         // Angular distance between vertices\n    for(var i = 1; i < n; i++) {     // For each of the remaining vertices\n        angle += counterclockwise?-delta:delta; // Adjust angle\n        c.lineTo(x + r*Math.sin(angle),         // Add line to next vertex\n                 y - r*Math.cos(angle));\n    }\n    c.closePath();                   // Connect last vertex back to the first\n}\n// Start a new path and add polygon subpaths\nc.beginPath();\npolygon(c, 3, 50, 70, 50);                   // Triangle\npolygon(c, 4, 150, 60, 50, Math.PI/4);       // Square\npolygon(c, 5, 255, 55, 50);                  // Pentagon\npolygon(c, 6, 365, 53, 50, Math.PI/6);       // Hexagon\npolygon(c, 4, 365, 53, 20, Math.PI/4, true); // Small square inside the hexagon\n// Set some properties that control how the graphics will look\nc.fillStyle = \"#ccc\";    // Light gray interiors\nc.strokeStyle = \"#008\";  // outlined with dark blue lines\nc.lineWidth = 5;         // five pixels wide.\n// Now draw all the polygons (each in its own subpath) with these calls\nc.fill();                // Fill the shapes\nc.stroke();              // And stroke their outlines\n\n\n\n\n</script>\n</body>\n</html>","description":""},{"copy":0,"tags":[],"key":"33ec2e09078d99dd569f19c010546ad8540d7d06","createAt":1541642622281,"updateAt":1541642622281,"name":"interview","lang":"JavaScript","value":"/*[1]what's result?*/\nvar marty = {\n    firstName: \"Marty\",\n    lastName: \"McFly\",\n    timeTravel: function(year) {\n        console.log(this.firstName + \" \" + this.lastName + \" is time traveling to \" + year);\n    }\n};\n\nvar getBackInTime = marty.timeTravel;\n\ngetBackInTime(2014);\n\n/*[2]what console print when button be clicked?*/\n<html>\n\t<head>\n\t</head>\n\t<body>\n\t\t<button id=\"btn\">click me</button>\n\t</body>\n\t<script>\n\t\tvar marty = {\n    firstName: \"Marty\",\n    lastName: \"McFly\",\n    timeTravel: function() {\n        console.log(this.firstName + \" \" + this.lastName + \" is time traveling to \");\n    \t\t}\n\t\t};\n\t\t\n\t\tvar flux = document.getElementById(\"btn\");\n\t\t//flux.addEventListener(\"click\", marty.timeTravel);\n\t\tflux.onclick = marty.timeTravel;\n\t</script>\n</html>\n\n\n/*[3]*/\nvar s = \"test\";         // Start with a string value.\ns.len = 4;              // Set a property on it.\nvar t = s.len;          // what's value of 't'?\n\n/*[4]*/\nfunction f(y,z) { return this.x + y + z };  // Another function that adds\nvar g = f.bind({x:1}, 2);                   // Bind this and y\ng(3)         // what's result?\n\n\n/*[5] scope chain */\nvar msg;\n\nfunction fn(msg){\t\t\t\n\tfn_g = function(){\n\t\tconsole.log(msg);\n\t};\n}\n\nfn('local');\n\nmsg = 'global';\n\n(function (){\n\twindow['fn_g']();\n})();                   // what's printed?\n\n\n/*[13] callback function */\nfunction fn1(cb){\n\tvar fn1_var = \"callback\";\n\tcb();\t\n}\n\nfunction fn2(){\n\tfunction cb(){\n\t\tconsole.log(fn1_var);\n\t}\n\n\tfn1(cb);\n}\n\nfn2(); //what's print in console?\n\n/*[6]new Operate*/\nfunction Building(b_height,b_address,b_cost){\n  var f = function(){}\t\t\n\tf.b_height = b_height; //\n\tf.b_address = b_address;\n\tf.b_cost = b_cost;\n\t\n\treturn f;\n}\n\nBuilding.prototype = {\n\tdoBudget:function(){return this.b_cost},\n\tdoLayFoundations:function(){return this.b_height},\n\tdoBuild:function(){return this.b_address}\t\n\t}\n\t\nvar station = new \tBuilding(10,\"tianjing\",\"500000$\");\n\nstation.b_height;  //what's result?\nstation.doBudget;  //what's result?\n\n/*\n*[7]click button then button element'interhtml display element's NO\n*how to modify below code?\n*/\n<html>\n\t<head>\n\t</head>\n\t<body>\n\t\t<button class=\"myClass\">button1</button><br>\n\t\t<button class=\"myClass\">button2</button><br>\n\t\t<button class=\"myClass\">button3</button><br>\n\t</body>\t\n<script type=\"text/javascript\" >\nvar elems = document.getElementsByClassName(\"myClass\"), \n            i; \nfor (i = 0; i < elems.length; i++) {\n    elems[i].addEventListener(\"click\", function () {\n        \"use strict\";\n        this.innerHTML = i; \n    });\n}\n</script>\n</html>\n\n//[8]how to write code to return different value?\nfunction constfuncs() {\n    var funcs = [];\n    for(var i = 0; i < 10; i++)\n       funcs[i] = function() { return i; };\n    return funcs;\n}\nvar funcs = constfuncs();\nfuncs[5]()    // What does this return? \n\n/*\n * [9]\n * how to add a new methoed to object_o and keep origin method ? \n * e.g follow code:\n * object_o.p()   // return 1\n * how to code method to return 2 1\n */\nvar object_o = {p:function(){return 1;}};\n\n//answer:\nfunction trace(o,m){\n\tvar origin = o[m];\n\to[m] = function(){\n\t\tvar result = origin.apply(this,arguments);\n\t\tconsole.log('2');\n\t\treturn result;\n\t};\n}\n\ntrace(object_o,'p');\n\n/* \n * [10]\n * regular expression\n * can you implement follow code with RegExp constructor ?\n */\nvar url = /(\\w+):\\/\\/([\\w.]+)\\/(\\S*)/;\nvar text = \"Visit my blog at http://www.example.com/~david\";\nvar result = text.match(url);\nif (result != null) {\n    var fullurl = result[0];   // what's value\n    var protocol = result[1];  // what's value\n    var host = result[2];      // what's value\n    var path = result[3];      // what's value\n}\n\n/*[11]*/\ndescribe order of events of browser and verification:\n[1]  document.DOMContentLoaded\n[2]  document.readystatechange.loading\n[3]  document.readystatechange.interactive\n[4]  document.readystatechange.complete\n[5]  window.load\n\n/* code */\nfunction display_loadOrder(msg){\n\tconsole.log(msg);\n}\n\nif (document.addEventListener) {\n\tdocument.addEventListener(\"DOMContentLoaded\", function(){ var msg = 'DOMContentLoaded' ; display_loadOrder(msg); } , false);\n\tdocument.addEventListener(\"readystatechange\", function(){ var msg = document.readyState ; display_loadOrder(msg); } , false);\n\twindow.addEventListener(\"load\", function(){ var msg = 'window.load' ; display_loadOrder(msg); } , false);\n}\n\n/* \n * [12] \n * server exchange a decimal number to Hexadecimal number\n * how to coding client code to return number from server in order?\n * not modify my API\n * try to faster on performance\n */\n \n //server code\n <?php\n$dec = $_GET[\"n\"];\n$cb = $_GET[\"callback\"];\n$hex = dechex($dec);\nheader(\"HTTP/1.1 200 Ok\");\nheader(\"Content-type:text/javascript\");\necho $cb . '(\"' . $hex . '\")';\n?>\n\n//client API\nfunction xss_ajax(url, callback)\n{\n\tvar script_id = null;\n\tvar script = document.createElement('script');\n\tscript.setAttribute('type', 'text/javascript');\n\tscript.setAttribute('src', url);\n\tscript.setAttribute('id', 'coolshell_script_id');\n\n\tscript.onload = script.onreadystatechange = function(){\n\t\tif((!this.readyState || this.readyState === \"loaded\" || this.readyState === \"complete\")){\n\t\t\tcallback && callback();\n\t\t}\n\t};\n\n\tscript_id = document.getElementById('coolshell_script_id');\n\tif(script_id){\n\t\tdocument.getElementsByTagName('head')[0].removeChild(script_id);\n\t}\n\n\t// Insert <script> into DOM\n\tdocument.getElementsByTagName('head')[0].appendChild(script);\n}\n\n\nfunction xss_rpc_call(n, callback)\n{\n\tvar callbackName=\"xss_rpc_callback\"  + Math.round(Math.random() * 10000);\n\tvar url = \"http://127.0.0.1/exchange.php?n=\" + n + \"&callback=\" + callbackName;\n\txss_ajax(url);\n\n\twindow[callbackName] = function(result){\n\t\tvar timeout = Math.round(Math.random() * 1000)\n\t\tcallback && setTimeout( function(){callback(result);}, timeout );\n\t\t//callback && callback(result) ;\n\t}\n}\n\n\n/* your code .....*/\n\n\n\n/*\n * [13] debug mergeSort code\n * what's wrong with follow code?\n */\n\nfunction mergeSort(arr, p, r){\n  if (p<r){\n    var q = Math.floor((p+r)/2);\n    mergeSort(arr, p, q);\n    mergeSort(arr, q+1, r);\n    merge(arr, p, q, r);\n  }\n}\n\nfunction merge(arr, p, q, r){\n  var m = n = 0,\n      left = right = [],\n      n1 = q-p+1,\n      n2 = r-q;\n\n  for(var i=0; i<n1; i++){\n    left[i] = arr[p+i];\n  }\n\n  for(var j=0; j<n2; j++){\n    right[j] = arr[q+1+j];\n  }\n\n  left[n1] = right[n2] = Number.MAX_VALUE;\n\n  for(var k=p; k<=r; k++){\n    if (left[m]<right[n]){\n      arr[k] = left[m];\n      m++;\n    } else {\n      arr[k] = right[n];\n      n++;\n    }\n  }\n}\n\n\nvar array = [6,1,23,6,3,5,7,11,3,10,98,8,3],\n    array_sorted=[array.length];\nconsole.log(array);\nmergeSort(array, 0, (array.length-1));","description":""},{"copy":0,"tags":[],"key":"eceb4b16b5f1b34fc84a8cbdf90c9a8685669340","createAt":1541642716611,"updateAt":1541642716611,"name":"Tricks","lang":"JavaScript","value":"//生成从0到指定值的数字数组\nvar numbersArray = [] , max = 100;\nfor( var i=1; numbersArray.push(i++) < max;);  // numbers = [1,2,3 ... 100]\n\n//生成随机的字母数字字符串\nfunction generateRandomAlphaNum(len) {\n    var rdmString = \"\";\n    for( ; rdmString.length < len; rdmString  += Math.random().toString(36).substr(2));\n    return  rdmString.substr(0, len);\n\n\n//打乱数组的顺序\nvar numbers = [5, 458 , 120 , -215 , 228 , 400 , 122205, -85411];\nnumbers = numbers.sort(function(){ return Math.random() - 0.5});\n/* numbers 数组将类似于 [120, 5, 228, -215, 400, 458, -85411, 122205]  */\n\n//字符串去掉头部和尾部的空格\nString.prototype.trim = function(){return this.replace(/^\\s+|\\s+$/g, \"\");};\n\n//验证是否是数字\nfunction isNumber(n){\n    return !isNaN(parseFloat(n)) && isFinite(n);\n}\n\n//获取数组中的最大值和最小值\nvar  numbers = [5, 458 , 120 , -215 , 228 , 400 , 122205, -85411]; \nvar maxInNumbers = Math.max.apply(Math, numbers); \nvar minInNumbers = Math.min.apply(Math, numbers);\n\n//不要直接从数组中delete或remove元素\n//wrong code\nvar items = [12, 548 ,'a' , 2 , 5478 , 'foo' , 8852, , 'Doe' ,2154 , 119 ]; \nitems.length; // return 11 \ndelete items[3]; // return true \nitems.length; // return 11 \n/* items 结果为 [12, 548, \"a\", undefined × 1, 5478, \"foo\", 8852, undefined × 1, \"Doe\", 2154, 119] */\n\n//conrect code\nvar items = [12, 548 ,'a' , 2 , 5478 , 'foo' , 8852, , 'Doe' ,2154 , 119 ]; \nitems.length; // return 11 \nitems.splice(3,1) ; \nitems.length; // return 10 \n/* items 结果为 [12, 548, \"a\", 5478, \"foo\", 8852, undefined × 1, \"Doe\", 2154, 119] */\n\n/*提前检查传入isFinite()的参数*/\nisFinite(0/0) ; // false\nisFinite(\"foo\"); // false\nisFinite(\"10\"); // true\nisFinite(10);   // true\nisFinite(undefined);  // false\nisFinite();   // false\nisFinite(null);  // true，这点当特别注意\n\n//避免在数组中使用负数做索引,最好判断一下索引值\nvar numbersArray = [1,2,3,4,5];\nvar from = numbersArray.indexOf(\"foo\") ;  // from is equal to -1\nnumbersArray.splice(from,2);    // will return [5]\n//注意传给splice的索引参数不要是负数，当是负数时，会从数组结尾处删除元素\n\n//用JSON来序列化与反序列化\nvar person = {name :'Saad', age : 26, department : {ID : 15, name : \"R&D\"} };\nvar stringFromPerson = JSON.stringify(person);\n/* stringFromPerson 结果为 \"{\"name\":\"Saad\",\"age\":26,\"department\":{\"ID\":15,\"name\":\"R&D\"}}\"   */\nvar personFromString = JSON.parse(stringFromPerson);\n/* personFromString 的值与 person 对象相同  */\n\n\n//HTML字段转换函数\nfunction escapeHTML(text) {  \n    var replacements= {\"<\": \"<\", \">\": \">\",\"&\": \"&\", '\\\"': '\"'};                      \n    return text.replace(/[<>&\"]/g, function(character) {  \n        return replacements[character];  \n    }); \n}\n\n//不要在循环内部使用try-catch-finally.try-catch-finally中catch部分在执行时会将异常赋给一个变量，\n//这个变量会被构建成一个运行时作用域内的新的变量。\n//wrong code \nvar object = ['foo', 'bar'], i;  \nfor (i = 0, len = object.length; i <len; i++) {  \n    try {  \n        // do something that throws an exception \n    }  \n    catch (e) {   \n        // handle exception  \n    } \n}\n\n//correct code\nvar object = ['foo', 'bar'], i;  \ntry { \n    for (i = 0, len = object.length; i <len; i++) {  \n        // do something that throws an exception \n    } \n} \ncatch (e) {   \n    // handle exception  \n}\n\n//使用XMLHttpRequests时注意设置超时,XMLHttpRequests在执行时，当长时间没有响应（如出现网络问题等）时，应该中止掉连接，\n//可以通过setTimeout()来完成这个工作：\nvar xhr = new XMLHttpRequest (); \nxhr.onreadystatechange = function () {  \n    if (this.readyState == 4) {  \n        clearTimeout(timeout);  \n        // do something with response data \n    }  \n}  \nvar timeout = setTimeout( function () {  \n    xhr.abort(); // call error callback  \n}, 60*1000 /* timeout after a minute */ ); \nxhr.open('GET', url, true);  \nxhr.send();\n\n//处理WebSocket的超时\n/*\n通常情况下，WebSocket连接创建后，如果30秒内没有任何活动，服务器端会对连接进行超时处理，\n防火墙也可以对单位周期没有活动的连接进行超时处理。\n\n为了防止这种情况的发生，可以每隔一定时间，往服务器发送一条空的消息。可以通过下面这两个函数来实现这个需求，\n一个用于使连接保持活动状态，另一个专门用于结束这个状态。\n */\nvar timerID = 0; \nfunction keepAlive() { \n    var timeout = 15000;  \n    if (webSocket.readyState == webSocket.OPEN) {  \n        webSocket.send('');  \n    }  \n    timerId = setTimeout(keepAlive, timeout);  \n}  \nfunction cancelKeepAlive() {  \n    if (timerId) {  \n        cancelTimeout(timerId);  \n    }  \n}","description":""},{"copy":0,"tags":[],"key":"e09b84c5f39d50eae9575f3745b21e35a3e056ff","createAt":1541642750999,"updateAt":1541642750999,"name":"Util-browser-sniffing","lang":"JavaScript","value":"// Define browser.name and browser.version for client sniffing, using code\n// derived from jQuery 1.4.1. Both the name and number are strings, and both\n// may differ from the public browser name and version. Detected names are:\n//\n//   \"webkit\": Safari or Chrome; version is WebKit build number\n//   \"opera\": the Opera browser; version is the public version number\n//   \"mozilla\": Firefox or other gecko-based browsers; version is Gecko version\n//   \"msie\": IE; version is public version number\n//\n// Firefox 3.6, for example, returns: { name: \"mozilla\", version: \"1.9.2\" }.\nvar browser = (function() {\n     var s = navigator.userAgent.toLowerCase();\n     var match = /(webkit)[ \\/]([\\w.]+)/.exec(s) ||\n     /(opera)(?:.*version)?[ \\/]([\\w.]+)/.exec(s) ||\n     /(msie) ([\\w.]+)/.exec(s) ||\n     !/compatible/.test(s) && /(mozilla)(?:.*? rv:([\\w.]+))?/.exec(s) ||\n     [];\n     return { name: match[1] || \"\", version: match[2] || \"0\" };\n}());","description":""},{"copy":0,"tags":[],"key":"6726d0bf476a52c930ff39325a9ba4910a0e271f","createAt":1541642764058,"updateAt":1541642764058,"name":"Util-browser-sniffing","lang":"JavaScript","value":"// Define browser.name and browser.version for client sniffing, using code\n// derived from jQuery 1.4.1. Both the name and number are strings, and both\n// may differ from the public browser name and version. Detected names are:\n//\n//   \"webkit\": Safari or Chrome; version is WebKit build number\n//   \"opera\": the Opera browser; version is the public version number\n//   \"mozilla\": Firefox or other gecko-based browsers; version is Gecko version\n//   \"msie\": IE; version is public version number\n//\n// Firefox 3.6, for example, returns: { name: \"mozilla\", version: \"1.9.2\" }.\nvar browser = (function() {\n     var s = navigator.userAgent.toLowerCase();\n     var match = /(webkit)[ \\/]([\\w.]+)/.exec(s) ||\n     /(opera)(?:.*version)?[ \\/]([\\w.]+)/.exec(s) ||\n     /(msie) ([\\w.]+)/.exec(s) ||\n     !/compatible/.test(s) && /(mozilla)(?:.*? rv:([\\w.]+))?/.exec(s) ||\n     [];\n     return { name: match[1] || \"\", version: match[2] || \"0\" };\n}());","description":""},{"copy":0,"tags":[],"key":"a8ee11627feae79e04b16178d76f079b1809515a","createAt":1541642791391,"updateAt":1541642791391,"name":"Util-getCookies","lang":"JavaScript","value":"function getCookies() {\n    var cookies = {};           // The object we will return\n    var all = document.cookie;  // Get all cookies in one big string\n    if (all === \"\")             // If the property is the empty string\n        return cookies;         // return an empty object\n    var list = all.split(\"; \"); // Split into individual name=value pairs\n    for(var i = 0; i < list.length; i++) {  // For each cookie\n        var cookie = list[i];\n        var p = cookie.indexOf(\"=\");        // Find the first = sign\n        var name = cookie.substring(0,p);   // Get cookie name\n        var value = cookie.substring(p+1);  // Get cookie value\n        value = decodeURIComponent(value);  // Decode the value\n        cookies[name] = value;              // Store name and value in object\n    }\n    return cookies;\n}","description":""},{"copy":0,"tags":[],"key":"fc455d5ebdb7444c7e63869d0cfb5cccad3e26e7","createAt":1541642818259,"updateAt":1541642818259,"name":"Util-getUrlArgs","lang":"JavaScript","value":"function urlArgs() {\n    var args = {};                             // Start with an empty object\n    var query = location.search.substring(1);  // Get query string, minus '?'\n    var pairs = query.split(\"&\");              // Split at ampersands\n    for(var i = 0; i < pairs.length; i++) {    // For each fragment\n        var pos = pairs[i].indexOf('=');       // Look for \"name=value\"\n        if (pos == -1) continue;               // If not found, skip it\n        var name = pairs[i].substring(0,pos);  // Extract the name\n        var value = pairs[i].substring(pos+1); // Extract the value\n        value = decodeURIComponent(value);     // Decode the value\n        args[name] = value;                    // Store as a property\n    }\n    return args;                               // Return the parsed arguments\n}","description":""},{"copy":0,"tags":[],"key":"d82f19985c77a7d3823ef7bc912d8936867a61bb","createAt":1541642858039,"updateAt":1541642858039,"name":"Util-load-jsfile-async","lang":"JavaScript","value":"// Asynchronously load and execute a script from a specified URL\nfunction loadasync(url) {\n    var head = document.getElementsByTagName(\"head\")[0]; // Find document <head>\n    var s = document.createElement(\"script\");  // Create a <script> element\n    s.src = url;                               // Set its src attribute\n    head.appendChild(s);                       // Insert the <script> into head\n}","description":""},{"copy":0,"tags":[],"key":"096e7d5cdaac2ed1c0e2e98d35825ca9f9518813","createAt":1541643005878,"updateAt":1541643005878,"name":"Util-object-utility","lang":"JavaScript","value":"//Example 6-2. Object utility functions that enumerate properties\n/*\n * Copy the enumerable properties of p to o, and return o.\n * If o and p have a property by the same name, o's property is overwritten.\n * This function does not handle getters and setters or copy attributes.\n */\nfunction extend(o, p) {\n    for(prop in p) {                         // For all props in p.\n        o[prop] = p[prop];                   // Add the property to o.\n    }\n    return o;\n}\n/*\n * Copy the enumerable properties of p to o, and return o.\n * If o and p have a property by the same name, o's property is left alone.\n * This function does not handle getters and setters or copy attributes.\n */\nfunction merge(o, p) {\n    for(prop in p) {                           // For all props in p.\n        if (o.hasOwnProperty[prop]) continue;  // Except those already in o.\n        o[prop] = p[prop];                     // Add the property to o.\n    }\n    return o;\n}\n/*\n * Remove properties from o if there is not a property with the same name in p.\n * Return o.\n */\nfunction restrict(o, p) {\n    for(prop in o) {                         // For all props in o\n        if (!(prop in p)) delete o[prop];    // Delete if not in p\n    }\n    return o;\n}\n/*\n * For each property of p, delete the property with the same name from o.\n * Return o.\n */\nfunction subtract(o, p) {\n    for(prop in p) {                         // For all props in p\n        delete o[prop];                      // Delete from o (deleting a\n                                             // nonexistent prop is harmless)\n    }\n    return o;\n}\n/*\n * Return a new object that holds the properties of both o and p.\n * If o and p have properties by the same name, the values from o are used.\n */\nfunction union(o,p) { return extend(extend({},o), p); }\n/*\n * Return a new object that holds only the properties of o that also appear\n * in p. This is something like the intersection of o and p, but the values of\n * the properties in p are discarded\n */\nfunction intersection(o,p) { return restrict(extend({}, o), p); }\n/*\n * Return an array that holds the names of the enumerable own properties of o.\n */\nfunction keys(o) {\n    if (typeof o !== \"object\") throw TypeError();  // Object argument required\n    var result = [];                 // The array we will return\n    for(var prop in o) {             // For all enumerable properties\n        if (o.hasOwnProperty(prop))  // If it is an own property\n            result.push(prop);       // add it to the array.\n    }\n    return result;                   // Return the array.\n}\n\n\nfunction inherit(p) {\n    if (p == null) throw TypeError(); // p must be a non-null object\n    if (Object.create)                // If Object.create() is defined...\n        return Object.create(p);      //    then just use it.\n    var t = typeof p;                 // Otherwise do some more type checking\n    if (t !== \"object\" && t !== \"function\") throw TypeError();\n    function f() {};                  // Define a dummy constructor function.\n    f.prototype = p;                  // Set its prototype property to p.\n    return new f();                   // Use f() to create an \"heir\" of p.\n}","description":""},{"copy":0,"tags":[],"key":"acc79deee60c2d99565ee7fbb6ab718240e26a36","createAt":1541644395507,"updateAt":1541644395507,"name":"Util-regular-get-url-parameter","lang":"JavaScript","value":"var url = /(\\w+):\\/\\/([\\w.]+)\\/(\\S*)/;\nvar text = \"Visit my blog at http://www.example.com/~david\";\nvar result = text.match(url);\nif (result != null) {\n    var fullurl = result[0];   // Contains \"http://www.example.com/~david\"\n    var protocol = result[1];  // Contains \"http\"\n    var host = result[2];      // Contains \"www.example.com\"\n    var path = result[3];      // Contains \"~david\"\n}","description":""},{"copy":0,"tags":[],"key":"754c5e9f67b8aeb4593a1c801893e889016980e8","createAt":1541644431917,"updateAt":1541644481859,"name":"XML-request-encoder","lang":"JavaScript","value":"function postQuery(url, what, where, radius, callback) {\n\t\t\t\tvar request = new XMLHttpRequest();\n\t\t\t\trequest.open(\"POST\", url);                  // POST to the specified url\n\t\t\t\trequest.onreadystatechange = function() {   // Simple event handler\n\t\t\t\t\tif (request.readyState === 4 && callback) callback(request);\n\t\t\t\t};\n\t\t\t\t// Create an XML document with root element <query>\n\t\t\t\tvar doc = document.implementation.createDocument(\"\", \"query\", null);\n\t\t\t\tvar query = doc.documentElement;            // The <query> element\n\t\t\t\tvar find = doc.createElement(\"find\");       // Create a <find> element\n\t\t\t\tquery.appendChild(find);                    // And add it to the <query>\n\t\t\t\tfind.setAttribute(\"zipcode\", where);        // Set attributes on <find>\n\t\t\t\tfind.setAttribute(\"radius\", radius);\n\t\t\t\tfind.appendChild(doc.createTextNode(what)); // And set content of <find>\n\t\t\t\t// Now send the XML-encoded data to the server.\n\t\t\t\t// Note that the Content-Type will be automatically set.\n\t\t\t\trequest.send(doc);\n\t\t\t}","description":""},{"copy":0,"tags":[],"key":"47ef32c158e4cdc34a2c86c744f2345d80da10f4","createAt":1541644457639,"updateAt":1541644514965,"name":"XMLHttprequest-Getting-HTTP-response-onreadystatechange","lang":"JavaScript","value":"function getText(url, callback) {\n    var request = new XMLHttpRequest();         // Create new request\n    request.open(\"GET\", url);                   // Specify URL to fetch\n    request.onreadystatechange = function() {   // Define event listener\n        // If the request is compete and was successful\n        if (request.readyState === 4 && request.status === 200) {\n            var type = request.getResponseHeader(\"Content-Type\");\n            if (type.match(/^text/))            // Make sure response is text\n                callback(request.responseText); // Pass it to callback\n        }\n    };\n    request.send(null);                         // Send the request now\n}","description":""},{"copy":0,"tags":[],"key":"801c9517fcc21c63b8837b7a49d5150e770f870a","createAt":1541645050269,"updateAt":1541645428163,"name":"oracle admin","description":"","files":[{"key":"7be7d49bb0ffbfd954c5961cd28a2eba11fd2dde","name":"CLUSTERING_FACTOR.sql","value":"select t.TABLE_NAME ,i.LEAF_BLOCKS, i.CLUSTERING_FACTOR, t.NUM_ROWS, (t.BLOCKS - t.EMPTY_BLOCKS) Used_Blocks\n from user_indexes i, user_tables t\nwhere i.TABLE_NAME = t.TABLE_NAME \nand i.TABLE_NAME = 'B_GE_T_GT'"},{"key":"5af00e7880636febece82d14d80a311b3dfe4dcb","name":"createPartitionSubInteval.sql","value":"CREATE TABLE PL_CALC_LLR_TG_NEW\n  (\n      tg_id      VARCHAR2(32),\n      tg_no      VARCHAR2(20),\n      d_prov_pq  NUMBER(16,4),\n      d_spq      NUMBER(16,4),\n      d_ll       NUMBER(16,4),\n      d_llr      NUMBER(16,4),\n      stat_day   DATE,\n      send_time  DATE,\n      city_no    VARCHAR2(50) default '42406',\n      cc_cnt     NUMBER,\n      read_ratio NUMBER\n  )\n  PARTITION BY RANGE (stat_day)    INTERVAL (NUMTOYMINTERVAL(1,'MONTH'))\n        SUBPARTITION BY LIST (city_no)\n        SUBPARTITION TEMPLATE (\n        subpartition GROUP1 values ('42401') tablespace TOP_MON_OWNER_NEW,\n        subpartition GROUP2 values ('42402') tablespace TOP_MON_OWNER_NEW,\n        subpartition GROUP3 values ('42403') tablespace TOP_MON_OWNER_NEW,\n        subpartition GROUP4 values ('42404') tablespace TOP_MON_OWNER_NEW,\n        subpartition GROUP5 values ('42405') tablespace TOP_MON_OWNER_NEW,\n        subpartition GROUP6 values ('42406') tablespace TOP_MON_OWNER_NEW,\n        subpartition GROUP7 values ('42407') tablespace TOP_MON_OWNER_NEW,\n        subpartition GROUP8 values ('42408') tablespace TOP_MON_OWNER_NEW,\n        subpartition GROUP9 values ('42409') tablespace TOP_MON_OWNER_NEW,\n        subpartition GROUP10 values ('42410') tablespace TOP_MON_OWNER_NEW,\n        subpartition GROUP11 values ('42411') tablespace TOP_MON_OWNER_NEW,\n        subpartition GROUP12 values ('42412') tablespace TOP_MON_OWNER_NEW,\n        subpartition GROUP13 values ('42413') tablespace TOP_MON_OWNER_NEW,\n        subpartition GROUP14 values ('42414') tablespace TOP_MON_OWNER_NEW\n        )\n  (partition values less than  (TO_DATE(' 2015-02-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS') ) );"},{"key":"71a131584a62780d4a823b55100b53451ebc1d35","name":"dyn_process_fast_insert.sql","value":"--create package with multi fast insert produces\ncreate or replace package dyn_process\nas\n  procedure insert_singe_value( p_tname in varchar2,\n                 p_value in varchar2 );\nend;\n/\n\n--create package body\ncreate or replace package body dyn_process\nas\n\ng_last_tname varchar2(30);\ng_cursor     number := dbms_sql.open_cursor;\n\n-----------reduce pl/sql parse statement  procedure insert_singe_value-----------\nprocedure insert_singe_value( p_tname in varchar2,\n               p_value in varchar2 )\nis\n  l_rows number;\nbegin\n  if ( g_last_tname <> p_tname or g_last_tname is null )\n  then\n    dbms_sql.parse( g_cursor, 'insert into ' || p_tname || ' (x) values (:x)', dbms_sql.native );\n    g_last_tname := p_tname;\n  end if;\n  dbms_sql.bind_variable( g_cursor, ':x', p_value );\n  l_rows := dbms_sql.execute( g_cursor );\nend;\n\n-----------------produces end--------------------------\n\n--------------------procedure exec_bulk_insert--------------------\n procedure exec_bulk_insert( p_tname in varchar2,\n               p_value in vcArray )\n is\n begin\n       forall  i  in  1  ..  p_value.count\n             execute immediate 'insert into ' || p_tname || '(x) values( :x )'  using p_value(i);\n       end;\n\n end;\n /\n-----------------produces end--------------------------\n\n--call procedure exec_bulk_insert\ncreate or replace type vcArray as table of varchar2(5);\n\ndeclare\n  l_array  vcArray  :=  vcArray();\nbegin\n     for i in 1 .. 50000000000\nloop\n    l_array.extend;\n    l_array(l_array.count) := i;\n    if ( mod(l_array.count,1000) = 0 or i = 5000 )  then\n          dyn_process.exec_bulk_insert('T', l_array );\n          l_array := vcArray();\n    end if;\nend loop;\nend;\n/\n"},{"key":"d4db250cc6adfc8f61568df85e3842614b8b2157","name":"exp_impdp.sql","value":"(1)前置条件及环境变量\n导出数据库实例名：dghdb\n导出数据库用户：\"SDE\",\"FM\",\"PLATFORM_APP\",\"PLATFORM\",\"GHSJ_PWGL\",\"GHSJ_JCSJ\",\"GHSJ_XM\",\"GHSJ_GHJH\"\n操作系统:RHEL\nORACLE_BASE路径：/home/u01/app/oracle\nORACLE_HOME路径：/home/u01/app/oracle/product/11.2.0/db_1\n操作系统环境变量LANG：en_US.UTF-8 #可通过echo $LANG获知，NLS_LANG须与LANG编码一致\n\n\n\n(2)通过expdp在本地导出文件，详细导出步骤如下：\n\n[1]登录系统后，切换到ORACLE用户下,创建DMP_DIRECTORY\n#su - oracle\n$sqlplus / as sysdba\nsql>CREATE DIRECTORY DMP_DIRECTORY AS '/home/oracle';\n\n[2]创建expdper用户，并授予权限\n-- Create the user \ncreate user EXPDPER\n\tidentified by expdper\n  default tablespace USERS\n  temporary tablespace TEMP\n  profile DEFAULT;\n-- Grant/Revoke object privileges \ngrant read, write on directory DMP_DIRECTORY to EXPDPER;\n-- Grant/Revoke role privileges \ngrant connect to EXPDPER;\ngrant datapump_exp_full_database to EXPDPER;\ngrant datapump_imp_full_database to EXPDPER;\ngrant resource to EXPDPER;\n-- Grant/Revoke system privileges \ngrant unlimited tablespace to EXPDPER;\n\n\n[3]通过vi创建以下脚本内容,并执行\n$vi exp_sh\n\n\nexport ORACLE_BASE=/home/u01/app/oracle\nexport ORACLE_HOME=$ORACLE_BASE/product/11.2.0/db_1\nexport ORACLE_SID=dghdb\nexport ORACLE_TERM=xterm\nexport PATH=/usr/sbin:$PATH\nexport PATH=$ORACLE_HOME/bin:$PATH\nexport LANG=en_US.UTF-8\nexport NLS_LANG=AMERICAN_AMERICA.UTF8\n\ndmp_owner=\"SDE\",\"FM\",\"PLATFORM_APP\",\"PLATFORM\",\"GHSJ_PWGL\",\"GHSJ_JCSJ\",\"GHSJ_XM\",\"GHSJ_GHJH\"\ndmp_file=dmp%U.dmp\nlog_exp_file=\"exp.log\"\n\nexpdp expdper/expdper@$ORACLE_SID SCHEMAS=$dmp_owner dumpfile=DMP_DIRECTORY.$dmp_file DIRECTORY=DMP_DIRECTORY  PARALLEL=8  logfile=$log_exp_file\n\nimpdp system/system@GHSJDB82 FULL=y DIRECTORY=IMP_EXP_DIRECTORY LOGFILE=log_file.log DUMPFILE=dmp.dmp TABLE_EXISTS_ACTION=TRUNCATE  JOB_NAME=job_imp_0716 PARALLEL=8\n\n\nCREATE OR REPLACE DIRECTORY IMP_EXP_DIRECTORY\n  AS '/home/oracle/dmpfile' ;\n  \n-- Create the user \ncreate user EXPDPER\n  default tablespace USERS\n  temporary tablespace TEMP\n  profile DEFAULT\n  identified by expdper;\n-- Grant/Revoke role privileges \ngrant connect to EXPDPER;\ngrant datapump_exp_full_database to EXPDPER;\ngrant datapump_imp_full_database to EXPDPER;\ngrant resource to EXPDPER;\n-- Grant/Revoke system privileges \ngrant unlimited tablespace to EXPDPER;  \n\n\nimpdp system/system@migration  DIRECTORY=DMP_DIRECTORY LOGFILE=log_file.log DUMPFILE=dgh201310181454.dmp TABLE_EXISTS_ACTION=TRUNCATE  TABLES=SDE.SPATIAL_REFERENCES, SDE.ST_SPATIAL_REFERENCES, SDE.TABLE_REGISTRY, SDE.DELTA1607, SDE.DELTA1589, SDE.DELTA1631, SDE.GDB_CODEDDOMAINS, SDE.GDB_EXTENSIONDATASETS, SDE.GDB_OBJECTCLASSES, SDE.GDB_DOMAINS, SDE.GDB_FEATURECLASSES, SDE.GDB_FEATUREDATASET, SDE.GDB_FIELDINFO, SDE.GDB_NETWEIGHTS, SDE.GDB_NETWORKS, SDE.GDB_RELEASE, SDE.GEOMETRY_COLUMNS, SDE.LAYERS CONTENT=data_only\n\nimpdp system/system@migration  DIRECTORY=DMP_DIRECTORY LOGFILE=log_file.log DUMPFILE=dgh201310181454.dmp TABLES=SDE.ST_SPATIAL_REFERENCES, SDE.DELTA1607, SDE.DELTA1589, SDE.DELTA1631  CONTENT=data_only\n\ntrigger\nSDE.GDB_DOM_TR\nSDE.GDB_XDS_TR\nSDE.GDB_OC_TR\nSDE.GDB_DOM_TR\n\nSDE.GDB_FC_TR\nSDE.GDB_FD_TR\nSDE.GDB_FI_TR\nSDE.GDB_NW_TR\nSDE.GDB_NET_TR\nSDE.GDB_RELEASE_TR\n\nST_SPREFS_PK\tPrimary Key\tEnabled\t\tNot Deferrable\tImmediate\tValidated\t\t\t1\tSRID\n"},{"key":"1aa2816ea3e58fedf8fcd7834b3fa35ff2acd0a5","name":"expdb.sql","value":"(1)前置条件及环境变量\n导出数据库实例名：dghdb\n导出数据库用户：\"SDE\",\"FM\",\"PLATFORM_APP\",\"PLATFORM\",\"GHSJ_PWGL\",\"GHSJ_JCSJ\",\"GHSJ_XM\",\"GHSJ_GHJH\"\n操作系统:RHEL\nORACLE_BASE路径：/home/u01/app/oracle\nORACLE_HOME路径：/home/u01/app/oracle/product/11.2.0/db_1\n操作系统环境变量LANG：en_US.UTF-8 #可通过echo $LANG获知，NLS_LANG须与LANG编码一致\n\n\n\n(2)通过expdp在本地导出文件，详细导出步骤如下：\n\n[1]登录系统后，切换到ORACLE用户下,创建DMP_DIRECTORY\n#su - oracle\n$sqlplus / as sysdba\nsql>CREATE DIRECTORY DMP_DIRECTORY AS '/home/oracle';\n\n[2]创建expdper用户，并授予权限\n-- Create the user \ncreate user EXPDPER\n\tidentified by expdper\n  default tablespace USERS\n  temporary tablespace TEMP\n  profile DEFAULT;\n-- Grant/Revoke object privileges \ngrant read, write on directory DMP_DIRECTORY to EXPDPER;\n-- Grant/Revoke role privileges \ngrant connect to EXPDPER;\ngrant datapump_exp_full_database to EXPDPER;\ngrant datapump_imp_full_database to EXPDPER;\ngrant resource to EXPDPER;\n-- Grant/Revoke system privileges \ngrant unlimited tablespace to EXPDPER;\n\n\n[3]通过vi创建以下脚本内容,并执行\n$vi exp_sh\n\n\nexport ORACLE_BASE=/home/u01/app/oracle\nexport ORACLE_HOME=$ORACLE_BASE/product/11.2.0/db_1\nexport ORACLE_SID=dghdb\nexport ORACLE_TERM=xterm\nexport PATH=/usr/sbin:$PATH\nexport PATH=$ORACLE_HOME/bin:$PATH\nexport LANG=en_US.UTF-8\nexport NLS_LANG=AMERICAN_AMERICA.UTF8\n\ndmp_owner=\"SDE\",\"FM\",\"PLATFORM_APP\",\"PLATFORM\",\"GHSJ_PWGL\",\"GHSJ_JCSJ\",\"GHSJ_XM\",\"GHSJ_GHJH\"\ndmp_file=dmp20130809.dmp\nlog_exp_file=\"exp.log\"\n\nexpdp expdper/expdper@$ORACLE_SID SCHEMAS=$dmp_owner dumpfile=exp%U.dmp DIRECTORY=DMP_DIRECTORY  PARALLEL=8  logfile=$log_exp_file\n\nexpdp expdper/expdper@migration FULL=y dumpfile=migration.dmp DIRECTORY=DMP_DIRECTORY  logfile=migration.log\n\nsql>CREATE DIRECTORY DMP_DIRECTORY AS 'd:/exp_dmp/';\n\n-- Create the user \ncreate user EXPDPER\n\tidentified by expdper\n  default tablespace USERS\n  temporary tablespace TEMP\n  profile DEFAULT;\n-- Grant/Revoke object privileges \ngrant read, write on directory DMP_DIRECTORY to EXPDPER;\n-- Grant/Revoke role privileges \ngrant connect to EXPDPER;\ngrant datapump_exp_full_database to EXPDPER;\ngrant datapump_imp_full_database to EXPDPER;\ngrant resource to EXPDPER;\n-- Grant/Revoke system privileges \ngrant unlimited tablespace to EXPDPER;\n\nexpdp expdper/expdper@$ORACLE_SID TABLES=table_name dumpfile=exp%U.dmp DIRECTORY=DMP_DIRECTORY  PARALLEL=32  logfile=exp.log STATUS=120"},{"key":"3c4fc8ba51a5773f2d91c2e9ef124f40befbb665","name":"FullyDecodedLocking.sql","value":"SET ECHO off\nREM NAME:   TFSCLOCK.SQL\nREM USAGE:\"@path/tfsclock\"\nREM ------------------------------------------------------------------------\nREM REQUIREMENTS:\nREM    SELECT on V_$LOCK, V_$SESSION, SYS.USER$, SYS.OBJ$\nREM ------------------------------------------------------------------------\nREM PURPOSE:\nREM    The following locking information script provides fully DECODED\nREM    information regarding the locks currently held in the database.\nREM    The report generated is fairly complex and difficult to read,\nREM    but has considerable detail.\nREM\nREM    The TFTS series contains scripts to provide (less detailed) lock\nREM    information in a formats which are somewhat less difficult to read:\nREM    TFSMLOCK.SQL and TFSLLOCK.SQL.\nREM ------------------------------------------------------------------------\nREM EXAMPLE:\nREM    Too complex to show a representative sample here\nREM\nREM ------------------------------------------------------------------------\nREM DISCLAIMER:\nREM    This script is provided for educational purposes only. It is NOT\nREM    supported by Oracle World Wide Technical Support.\nREM    The script has been tested and appears to work as intended.\nREM    You should always run new scripts on a test instance initially.\nREM ------------------------------------------------------------------------\nREM\n\nset lines 200\nset pagesize 66\nbreak on Kill on sid on  username on terminal\ncolumn Kill heading 'Kill String' format a13\ncolumn res heading 'Resource Type' format 999\ncolumn id1 format 9999990\ncolumn id2 format 9999990\ncolumn locking heading 'Lock Held/Lock Requested' format a40\ncolumn lmode heading 'Lock Held' format a20\ncolumn request heading 'Lock Requested' format a20\ncolumn serial# format 99999\ncolumn username  format a10  heading \"Username\"\ncolumn terminal heading Term format a10\ncolumn tab format a30 heading \"Table Name\"\ncolumn object_name format a10 heading \"OBJECT NAME\"\ncolumn object_type format a10 heading \"OBJECT TYPE\"\ncolumn owner format a9\ncolumn LAddr heading \"ID1 - ID2\" format a18\ncolumn Lockt heading \"Lock Type\" format a40\ncolumn command format a15\ncolumn sid format 990\n\nselect\nnvl(S.USERNAME,'Internal') username,s.SERIAL#,\n        L.SID,\n        nvl(S.TERMINAL,'None') terminal,\nT1.OBJECT_NAME OBJECT_NAME,\nT1.OBJECT_TYPE  OBJECT_TYPE,\ndecode(command,\n0,'BACKGROUND',\n1,'Create Table',\n2,'INSERT',\n3,'SELECT',\n4,'CREATE CLUSTER',\n5,'ALTER CLUSTER',\n6,'UPDATE',\n7,'DELETE',\n8,'DROP',\n9,'CREATE INDEX',\n10,'DROP INDEX',\n11,'ALTER INDEX',\n12,'DROP TABLE',\n13,'CREATE SEQUENCE',\n14,'ALTER SEQUENCE',\n15,'ALTER TABLE',\n16,'DROP SEQUENCE',\n17,'GRANT',\n18,'REVOKE',\n19,'CREATE SYNONYM',\n20,'DROP SYNONYM',\n21,'CREATE VIEW',\n22,'DROP VIEW',\n23,'VALIDATE INDEX',\n24,'CREATE PROCEDURE',\n25,'ALTER PROCEDURE',\n26,'LOCK TABLE',\n27,'NO OPERATION',\n28,'RENAME',\n29,'COMMENT',\n30,'AUDIT',\n31,'NOAUDIT',\n32,'CREATE EXTERNAL DATABASE',\n33,'DROP EXTERNAL DATABASE',\n34,'CREATE DATABASE',\n35,'ALTER DATABASE',\n36,'CREATE ROLLBACK SEGMENT',\n37,'ALTER ROLLBACK SEGMENT',\n38,'DROP ROLLBACK SEGMENT',\n39,'CREATE TABLESPACE',\n40,'ALTER TABLESPACE',\n41,'DROP TABLESPACE',\n42,'ALTER SESSION',\n43,'ALTER USER',\n44,'COMMIT',\n45,'ROLLBACK',\n46,'SAVEPOINT',\n47,'PL/SQL EXECUTE',\n48,'SET TRANSACTION',\n49,'ALTER SYSTEM SWITCH LOG',\n50,'EXPLAIN',\n51,'CREATE USER',\n52,'CREATE ROLE',\n53,'DROP USER',\n54,'DROP ROLE',\n55,'SET ROLE',\n56,'CREATE SCHEMA',\n57,'CREATE CONTROL FILE',\n58,'ALTER TRACING',\n59,'CREATE TRIGGER',\n60,'ALTER TRIGGER',\n61,'DROP TRIGGER',\n62,'ANALYZE TABLE',\n63,'ANALYZE INDEX',\n64,'ANALYZE CLUSTER',\n65,'CREATE PROFILE',\n66,'DROP PROFILE',\n67,'ALTER PROFILE',\n68,'DROP PROCEDURE',\n69,'DROP PROCEDURE',\n70,'ALTER RESOURCE COST',\n71,'CREATE SNAPSHOT LOG',\n72,'ALTER SNAPSHOT LOG',\n73,'DROP SNAPSHOT LOG',\n74,'CREATE SNAPSHOT',\n75,'ALTER SNAPSHOT',\n76,'DROP SNAPSHOT',\n79,'ALTER ROLE',\n85,'TRUNCATE TABLE',\n86,'TRUNCATE CLUSTER',\n87,'-',\n88,'ALTER VIEW',\n89,'-',\n90,'-',\n91,'CREATE FUNCTION',\n92,'ALTER FUNCTION',\n93,'DROP FUNCTION',\n94,'CREATE PACKAGE',\n95,'ALTER PACKAGE',\n96,'DROP PACKAGE',\n97,'CREATE PACKAGE BODY',\n98,'ALTER PACKAGE BODY',\n99,'DROP PACKAGE BODY',\ncommand||' - ???') COMMAND,\n        decode(L.LMODE,1,'No Lock',\n                2,'Row Share',\n                3,'Row Exclusive',\n                4,'Share',\n                5,'Share Row Exclusive',\n                6,'Exclusive','NONE') lmode,\n        decode(L.REQUEST,1,'No Lock',\n                2,'Row Share',\n                3,'Row Exclusive',\n                4,'Share',\n                5,'Share Row Exclusive',\n                6,'Exclusive','NONE') request,\nl.id1||'-'||l.id2 Laddr,\nl.type||' - '||\ndecode(l.type,\n'BL','Buffer hash table instance lock',\n'CF',' Control file schema global enqueue lock',\n'CI','Cross-instance function invocation instance lock',\n'CS','Control file schema global enqueue lock',\n'CU','Cursor bind lock',\n'DF','Data file instance lock',\n'DL','Direct loader parallel index create',\n'DM','Mount/startup db primary/secondary instance lock',\n'DR','Distributed recovery process lock',\n'DX','Distributed transaction entry lock',\n'FI','SGA open-file information lock',\n'FS','File set lock',\n'HW','Space management operations on a specific segment lock',\n'IN','Instance number lock',\n'IR','Instance recovery serialization global enqueue lock',\n'IS','Instance state lock',\n'IV','Library cache invalidation instance lock',\n'JQ','Job queue lock',\n'KK','Thread kick lock',\n'MB','Master buffer hash table instance lock',\n'MM','Mount definition gloabal enqueue lock',\n'MR','Media recovery lock',\n'PF','Password file lock',\n'PI','Parallel operation lock',\n'PR','Process startup lock',\n'PS','Parallel operation lock',\n'RE','USE_ROW_ENQUEUE enforcement lock',\n'RT','Redo thread global enqueue lock',\n'RW','Row wait enqueue lock',\n'SC','System commit number instance lock',\n'SH','System commit number high water mark enqueue lock',\n'SM','SMON lock',\n'SN','Sequence number instance lock',\n'SQ','Sequence number enqueue lock',\n'SS','Sort segment lock',\n'ST','Space transaction enqueue lock',\n'SV','Sequence number value lock',\n'TA','Generic enqueue lock',\n'TD','DDL enqueue lock',\n'TE','Extend-segment enqueue lock',\n'TM','DML enqueue lock',\n'TO','Temporary Table Object Enqueue',\n'TT','Temporary table enqueue lock',\n'TX','Transaction enqueue lock',\n'UL','User supplied lock',\n'UN','User name lock',\n'US','Undo segment DDL lock',\n'WL','Being-written redo log instance lock',\n'WS','Write-atomic-log-switch global enqueue lock',\n'TS',decode(l.id2,0,'Temporary segment enqueue lock (ID2=0)',\n                    'New block allocation enqueue lock (ID2=1)'),\n'LA','Library cache lock instance lock (A=namespace)',\n'LB','Library cache lock instance lock (B=namespace)',\n'LC','Library cache lock instance lock (C=namespace)',\n'LD','Library cache lock instance lock (D=namespace)',\n'LE','Library cache lock instance lock (E=namespace)',\n'LF','Library cache lock instance lock (F=namespace)',\n'LG','Library cache lock instance lock (G=namespace)',\n'LH','Library cache lock instance lock (H=namespace)',\n'LI','Library cache lock instance lock (I=namespace)',\n'LJ','Library cache lock instance lock (J=namespace)',\n'LK','Library cache lock instance lock (K=namespace)',\n'LL','Library cache lock instance lock (L=namespace)',\n'LM','Library cache lock instance lock (M=namespace)',\n'LN','Library cache lock instance lock (N=namespace)',\n'LO','Library cache lock instance lock (O=namespace)',\n'LP','Library cache lock instance lock (P=namespace)',\n'LS','Log start/log switch enqueue lock',\n'PA','Library cache pin instance lock (A=namespace)',\n'PB','Library cache pin instance lock (B=namespace)',\n'PC','Library cache pin instance lock (C=namespace)',\n'PD','Library cache pin instance lock (D=namespace)',\n'PE','Library cache pin instance lock (E=namespace)',\n'PF','Library cache pin instance lock (F=namespace)',\n'PG','Library cache pin instance lock (G=namespace)',\n'PH','Library cache pin instance lock (H=namespace)',\n'PI','Library cache pin instance lock (I=namespace)',\n'PJ','Library cache pin instance lock (J=namespace)',\n'PL','Library cache pin instance lock (K=namespace)',\n'PK','Library cache pin instance lock (L=namespace)',\n'PM','Library cache pin instance lock (M=namespace)',\n'PN','Library cache pin instance lock (N=namespace)',\n'PO','Library cache pin instance lock (O=namespace)',\n'PP','Library cache pin instance lock (P=namespace)',\n'PQ','Library cache pin instance lock (Q=namespace)',\n'PR','Library cache pin instance lock (R=namespace)',\n'PS','Library cache pin instance lock (S=namespace)',\n'PT','Library cache pin instance lock (T=namespace)',\n'PU','Library cache pin instance lock (U=namespace)',\n'PV','Library cache pin instance lock (V=namespace)',\n'PW','Library cache pin instance lock (W=namespace)',\n'PX','Library cache pin instance lock (X=namespace)',\n'PY','Library cache pin instance lock (Y=namespace)',\n'PZ','Library cache pin instance lock (Z=namespace)',\n'QA','Row cache instance lock (A=cache)',\n'QB','Row cache instance lock (B=cache)',\n'QC','Row cache instance lock (C=cache)',\n'QD','Row cache instance lock (D=cache)',\n'QE','Row cache instance lock (E=cache)',\n'QF','Row cache instance lock (F=cache)',\n'QG','Row cache instance lock (G=cache)',\n'QH','Row cache instance lock (H=cache)',\n'QI','Row cache instance lock (I=cache)',\n'QJ','Row cache instance lock (J=cache)',\n'QL','Row cache instance lock (K=cache)',\n'QK','Row cache instance lock (L=cache)',\n'QM','Row cache instance lock (M=cache)',\n'QN','Row cache instance lock (N=cache)',\n'QO','Row cache instance lock (O=cache)',\n'QP','Row cache instance lock (P=cache)',\n'QQ','Row cache instance lock (Q=cache)',\n'QR','Row cache instance lock (R=cache)',\n'QS','Row cache instance lock (S=cache)',\n'QT','Row cache instance lock (T=cache)',\n'QU','Row cache instance lock (U=cache)',\n'QV','Row cache instance lock (V=cache)',\n'QW','Row cache instance lock (W=cache)',\n'QX','Row cache instance lock (X=cache)',\n'QY','Row cache instance lock (Y=cache)',\n'QZ','Row cache instance lock (Z=cache)','????') Lockt\nfrom    V$LOCK L,\n        V$SESSION S,\n        SYS.USER$ U1,\n        dba_objects  T1\nwhere   L.SID = S.SID\nand     T1.OBJECT_ID  = decode(L.ID2,0,L.ID1,1)\nand     U1.NAME = T1.OWNER\nand     S.TYPE != 'BACKGROUND'\norder by 1,2,5\n/"},{"key":"286c5ec8100d393f8ce28b3d2ea6a04268bea9ff","name":"grantDevRole.sql","value":"-- Grant/Revoke object privileges\n-- Grant/Revoke system privileges\ngrant administer database trigger to ecs;\ngrant alter any index to ecs;\ngrant alter any table to ecs;\ngrant analyze any to ecs;\ngrant create any index to ecs;\ngrant create any procedure to ecs;\ngrant create any sequence to ecs;\ngrant create any trigger to ecs;\ngrant create indextype to ecs;\ngrant create library to ecs;\ngrant create operator to ecs;\ngrant create procedure to ecs;\ngrant create public synonym to ecs;\ngrant create sequence to ecs;\ngrant create session to ecs;\ngrant create table to ecs;\ngrant create trigger to ecs;\ngrant create type to ecs;\ngrant create view to ecs;\ngrant create database link to ecs;\ngrant create materialized view to ecs;\ngrant drop any index to ecs;\ngrant drop any procedure to ecs;\ngrant drop any sequence to ecs;\ngrant drop any table to ecs;\ngrant drop any view to ecs;\ngrant drop public synonym to ecs;\ngrant execute any procedure to ecs;\ngrant select any sequence to ecs;\ngrant select any table to ecs;\ngrant unlimited tablespace to ecs;\nGRANT exp_full_database TO ecs;\nGRANT imp_full_database TO ecs;\nGRANT debug connect session to ecs; \nGRANT debug any procedure to ecs;\n\nselect s.sid, s.serial#, s.status, p.spid\nfrom v$session s, v$process p\nwhere s.username = 'ecs'\nand p.addr  = s.paddr;\n\n   INST_ID        SID    SERIAL#\n---------- ---------- ----------\n         1         11       8911\n         1         12      21355\n         1         16       9025\n         1         17        409\n         1         18         33\n         1         19          7\n         1         20         23\n         1         21          9\n         1         22          7\n         1         23          7\n         1         71      20177\n\n   INST_ID        SID    SERIAL#\n---------- ---------- ----------\n         1         72       8463\n         1         73      19157\n         1         77      21823\n         1         79          7\n         1         80          7\n         1         81          9\n         1         82         41\n         1         83          7\n         1         84          7\n         1        130       2751\n         1        134       5097\n\n   INST_ID        SID    SERIAL#\n---------- ---------- ----------\n         1        137         93\n         1        138        429\n         1        141        233\n         1        142          7\n         1        143          7\n         1        144          5\n         1        145          7\n         1        146          7\n         1        193        567\n         1        201       8455\n         1        204      49491\n\n   INST_ID        SID    SERIAL#\n---------- ---------- ----------\n         1        205         15\n         1        206        441\n         1        207         13\n         1        208          7\n         1        209          7\n         1        210         63\n         1        211          7"},{"key":"82395e356b315db08eed84c289a3517d2d140481","name":"KillSession.sql","value":"SET LINESIZE 100\nCOLUMN spid FORMAT A10\nCOLUMN username FORMAT A10\nCOLUMN program FORMAT A45\n\nSELECT s.inst_id,\n       s.sid,\n       s.serial#,\n       p.spid,\n       s.username,\n       s.program\nFROM   gv$session s\n       JOIN gv$process p ON p.addr = s.paddr AND p.inst_id = s.inst_id\nWHERE  s.type != 'BACKGROUND';\n\n--Single\nALTER SYSTEM KILL SESSION 'sid,serial#'  IMMEDIATE;\n\nALTER SYSTEM DISCONNECT SESSION 'sid,serial#' POST_TRANSACTION;\nALTER SYSTEM DISCONNECT SESSION 'sid,serial#' IMMEDIATE;\n\n-- Rac\n  ALTER SYSTEM KILL SESSION 'sid,serial#,@inst_id'  IMMEDIATE;"},{"key":"ffafad8da6c724ca95c20f470a0494b81c02a6d0","name":"login.sql","value":"set termout off\ndefine _editor=vi\nset serveroutput on size 1000000 format wrapped\ncol object_name for a30\ncol segment_name for a30\ncol file_name for a40\ncol name for a30\ncol what for a30 word_wrapped\ncol plan_plus_exp for a100 \n\nset trimspool on\nset long 5000\nset linesize 131\nset pagesize 0\n\ndefine gname=idle\ncol global_name new_value gname\n\nselect lower(user) || '@' || \tsubstr(global_name, 1, decode(dot, 0, length(global_name), dot-1)) global_name\n\tfrom (select global_name, instr(global_name, ' . ') dot from global_name );\n\t\nset termout on\n\n\n\nREDEM set appinfo ON\nREDEM set appinfo \"SQL*Plus\"\nREDEM set arraysize 15\nREDEM set autocommit OFF\nREDEM set autoprint OFF\nREDEM set autorecovery OFF\nREDEM set autotrace off\nREDEM set blockterminator \".\"\nREDEM set cmdsep OFF\nREDEM set colsep \" \"\nREDEM set compatibility NATIVE\nREDEM set concat \".\"\nREDEM set copycommit 0\nREDEM set copytypecheck ON\nREDEM set define \"&\"\nREDEM set describe DEPTH 1 LINENUM OFF INDENT ON\nREDEM set markup HTML OFF SPOOL OFF ENTMAP ON PRE OFF\nREDEM set echo OFF\nREDEM set editfile \"afiedt.buf\"\nREDEM set embedded OFF\nREDEM set endbuftoken \"\"\nREDEM set escape OFF\nREDEM set feedback 6\nREDEM set flagger OFF\nREDEM set flush ON\nREDEM SET HEADING ON\nREDEM set headsep \"|\"\nREDEM SET LINESIZE 250\nREDEM set logsource \"\"\nREDEM set long 80\nREDEM set longchunksize 80\nREDEM set newpage 1\nREDEM set null \"\"\nREDEM set numformat \"\"\nREDEM set numwidth 10\nREDEM SET PAGESIZE 24\nREDEM set pause OFF\nREDEM set recsep WRAP\nREDEM set recsepchar \" \"\nREDEM SET SERVEROUTPUT ON size 1000000 format WORD_WRAPPED\nREDEM set shiftinout invisible\nREDEM set showmode OFF\nREDEM set sqlblanklines OFF\nREDEM set sqlcase MIXED\nREDEM set sqlcontinue \"> \"\nREDEM set sqlnumber ON\nREDEM set sqlprefix \"#\"\nREDEM set sqlprompt \"SQL> \"\nREDEM set sqlterminator \";\"\nREDEM set suffix \"sql\"\nREDEM set tab ON\nREDEM set termout ON\nREDEM SET TIME ON\nREDEM SET TIMING ON\nREDEM SET TRIMOUT ON\nREDEM set trimspool OFF\nREDEM set underline \"-\"\nREDEM set verify ON\nREDEM set wrap ON"},{"key":"2cda0722f401dd5f190cf37a17b6b18280c8700a","name":"operateAllContraint.sql","value":"select \n\t'alter table ' || OWNER || '.' || TABLE_NAME || ' disable constraint ' || CONSTRAINT_NAME || ';' noprimarykey  \nfrom dba_constraints \nwhere owner in ('FM','GHSJ_XM','GHSJ_JCSJ','PLATFORM') and CONSTRAINT_TYPE <> 'P';\n\n\nselect \n\t'alter table ' || OWNER || '.' || TABLE_NAME || ' disable constraint ' || CONSTRAINT_NAME || ';' noprimarykey  \nfrom dba_constraints \nwhere owner in ('SDE') and CONSTRAINT_TYPE <> 'P';\n\nselect \n\t'alter table ' || OWNER || '.' || TABLE_NAME || ' enable constraint ' || CONSTRAINT_NAME || ';' noprimarykey  \nfrom dba_constraints \nwhere owner in ('FM','GHSJ_XM','GHSJ_JCSJ','PLATFORM','SDE') and CONSTRAINT_TYPE <> 'P';select \n\t'alter table ' || OWNER || '.' || TABLE_NAME || ' disable constraint ' || CONSTRAINT_NAME || ';' noprimarykey  \nfrom dba_constraints \nwhere owner in ('FM','GHSJ_XM','GHSJ_JCSJ','PLATFORM') and CONSTRAINT_TYPE <> 'P';\n\n\nselect \n\t'alter table ' || OWNER || '.' || TABLE_NAME || ' disable constraint ' || CONSTRAINT_NAME || ';' noprimarykey  \nfrom dba_constraints \nwhere owner in ('SDE') and CONSTRAINT_TYPE <> 'P';\n\nselect \n\t'alter table ' || OWNER || '.' || TABLE_NAME || ' enable constraint ' || CONSTRAINT_NAME || ';' noprimarykey  \nfrom dba_constraints \nwhere owner in ('FM','GHSJ_XM','GHSJ_JCSJ','PLATFORM','SDE') and CONSTRAINT_TYPE <> 'P';"},{"key":"358d99e6a2f5d7e0a08c3fc25f1939aabc706500","name":"OperateAllForeignKey.sql","value":"select\n'alter table ' || child_owner || '.' || child_tname || ' disable constraint ' || child_cons_name || ';' fkey\nfrom\n( select a.table_name child_tname, a.constraint_name \n          child_cons_name,\n         b.r_constraint_name parent_cons_name,\n         max(b.owner) child_owner,\n         max(decode(position, 1,     '\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position, 2,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position, 3,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position, 4,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position, 5,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position, 6,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position, 7,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position, 8,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position, 9,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position,10,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position,11,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position,12,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position,13,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position,14,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position,15,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position,16,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL))\n            child_columns\n    from dba_cons_columns a, dba_constraints b\n   where a.constraint_name = b.constraint_name\n     and b.constraint_type = 'R'\n     and b.owner in ('FM','GHSJ_XM','GHSJ_JCSJ','PLATFORM')\n   group by a.table_name, a.constraint_name, \n               b.r_constraint_name ) child,\n( select a.constraint_name parent_cons_name, a.table_name \n          parent_tname,\n         max(decode(position, 1,     '\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position, 2,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position, 3,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position, 4,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position, 5,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position, 6,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position, 7,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position, 8,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position, 9,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position,10,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position,11,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position,12,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position,13,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position,14,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position,15,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL)) ||\n         max(decode(position,16,', '||'\"'||\n                substr(column_name,1,30)||'\"',NULL))\n            parent_columns\n    from dba_cons_columns a, dba_constraints b\n   where a.constraint_name = b.constraint_name\n     and b.constraint_type in ( 'P', 'U' )\n     and b.owner in ('FM','GHSJ_XM','GHSJ_JCSJ','PLATFORM')\n   group by a.table_name, a.constraint_name ) parent\nwhere child.parent_cons_name = parent.parent_cons_name;\n"},{"key":"3d3b127409af8b5a2404ccee17f3c64def254c62","name":"operateAllTriggers.sql","value":"select \n\t'alter table ' || TABLE_OWNER || '.' || TABLE_NAME || ' enable all triggers;' \nfrom all_triggers \nwhere TABLE_OWNER in ('FM','GHSJ_JCSJ','PLATFORM','GHSJ_XM');"},{"key":"fc427be464e0e01d667d02e331a4c5c82d02c76f","name":"queryToFindLockedTablesInOracle.sql","value":"run following from sysdba:\nselect owner||'.'||object_name obj\n,oracle_username||' ('||s.status||')' oruser\n,os_user_name osuser\n,machine computer\n,l.process unix\n,''''||s.sid||','||s.serial#||'''' ss\n,r.name rs\n,to_char(s.logon_time,'yyyy/mm/dd hh24:mi:ss') time\nfrom v$locked_object l\n,dba_objects o\n,v$session s\n,v$transaction t\n,v$rollname r\nwhere l.object_id = o.object_id\nand s.sid=l.session_id\nand s.taddr=t.addr\nand t.xidusn=r.usn\norder by osuser, ss, obj\n\n\nTo kill a perticular session :\nalter system kill session '<>';\ne.g.\nalter system kill session '101,1120';"},{"key":"e7e1d919a6977aa1a4b3fc135920ad088d560660","name":"queryFRA.sql","value":"SELECT\n    NAME,\n    TO_CHAR(SPACE_LIMIT/1024/1024, '999,999,999,999') AS SPACE_LIMIT_MB,\n    TO_CHAR((SPACE_LIMIT - SPACE_USED + SPACE_RECLAIMABLE)/1024/1024,'999,999,999,999') AS SPACE_AVAILABLE_MB,\n    ROUND((SPACE_USED - SPACE_RECLAIMABLE)/SPACE_LIMIT * 100, 1) AS PERCENT_FULL\n    FROM V$RECOVERY_FILE_DEST;\n\n--show parameter db_recovery_file_dest_size;\n\n--alter system set  db_recovery_file_dest_size = integer;\n"},{"key":"e7e90f7bbbb5558c22bf248f83875204f9615061","name":"queryIsolationLevel.sql","value":"SELECT s.sid, s.serial#,\n   CASE BITAND(t.flag, POWER(2, 28))\n      WHEN 0 THEN 'READ COMMITTED'\n      ELSE 'SERIALIZABLE'\n   END AS isolation_level\nFROM v$transaction t \nJOIN v$session s ON t.addr = s.taddr AND s.sid = sys_context('USERENV', 'SID');\n\n#If you are not already in a transaction you can start one with the following:\n\ndeclare \n   trans_id Varchar2(100);\nbegin\n   trans_id := dbms_transaction.local_transaction_id( TRUE );\nend;\n/"},{"key":"420c8a5f7580d71587b930c54e239b0eb09bb9f8","name":"querySCN.sql","value":"-- query scn max value\ncol maxscn for 999,999,999,999,999,999\nselect \n(\n    (\n        (\n            (\n                (   \n                    (\n                        to_char(sysdate,'YYYY')-1988\n                    )*12+\n                to_char(sysdate,'mm')-1\n                )*31+to_char(sysdate,'dd')-1\n            )*24+to_char(sysdate,'hh24')\n        )*60+to_char(sysdate,'mi')\n    )*60+to_char(sysdate,'ss')\n) * to_number('ffff','XXXXXXXX')/4 as maxscn\nfrom dual;\n\n-- query retain days\ncol maxscn for 999,999,999,999,999,999\ncol retain_days for 999,999,999,999,999,999\nselect \n(\n    (\n        (\n            (\n                (   \n                    (\n                        to_char(sysdate,'YYYY')-1988\n                    )*12+\n                to_char(sysdate,'mm')-1\n                )*31+to_char(sysdate,'dd')-1\n            )*24+to_char(sysdate,'hh24')\n        )*60+to_char(sysdate,'mi')\n    )*60+to_char(sysdate,'ss')\n) * to_number('ffff','XXXXXXXX')/4 maxscn,\n( maxscn - dbms_flashback.get_system_change_number ) / 16 / 1024 / 3600 / 24 / 365 as retain_days\nfrom dual;\n\n"},{"key":"d85462e0875587da63dc85275288874930ccbc74","name":"querySpecialUserExecSql.sql","value":"-- 查询特定用户和特定客户端程序执行过的sql\n-- 本例用户是ghsj_jcsj,客户端程序是TableaU\nselect \nsqltext.FIRST_LOAD_TIME,\nsqltext.LAST_ACTIVE_TIME,\nsqltext.*\n  from v$sql sqltext, v$session sesion\n where \nsesion.PREV_HASH_VALUE = sqltext.hash_value\nand sesion.PREV_SQL_ADDR = sqltext.address\n   and sesion.username='GHSJ_JCSJ'\n   and sesion.PROGRAM = 'tabprotosrv.exe'\n   order by sqltext.LAST_ACTIVE_TIME"},{"key":"a09d4994b9894cb727e561828b256316b5b03f5f","name":"querySqlHistory.sql","value":"\n\n--query special table be accessed history info in 7 day\nselect t.sql_id\n       ,sql.sql_text\n       ,sql.sql_fulltext\n       ,t.optimizer_cost\n       ,t.optimizer_mode\n       ,t.optimized_physical_reads_total\n       ,t.optimized_physical_reads_delta\n       ,t.sharable_mem\n       ,t.fetches_total\n       ,t.sorts_total\n       ,t.executions_total\n       ,t.parse_calls_total\n       ,t.disk_reads_total\n       ,t.direct_writes_total\n       ,t.buffer_gets_total\n       ,t.cpu_time_total\n       ,t.elapsed_time_total\n       ,t.iowait_total\n       ,t.clwait_total\n       ,t.apwait_total\n       ,t.ccwait_total\n       ,t.plsexec_time_total\n       ,t.io_interconnect_bytes_total\n       ,t.physical_read_requests_total\n       ,t.physical_read_bytes_total\n       ,s.begin_interval_time\nfrom   dba_hist_sqlstat t, dba_hist_snapshot s,(select q.sql_id,q.SQL_TEXT,q.SQL_FULLTEXT\nfrom v$sql q\nwhere q.SQL_TEXT like '%PL_CALC_LLR_TG%') sql\nwhere  t.snap_id = s.snap_id\nand    t.dbid = s.dbid\nand    t.instance_number = s.instance_number\nand    s.begin_interval_time between trunc(sysdate)-7 and trunc(sysdate)\nand    t.sql_id = sql.sql_id;\n/\n\n--query performance of sql of special table be accessed  in 7 day\nselect sql.sql_id\n       ,min(sql.sql_text)\n       ,count(sql.sql_id) timers\n       ,sum(t.elapsed_time_total) elapsed_time_sum\n       ,sum(t.iowait_total)\n       ,(sum(t.iowait_total)/sum(t.elapsed_time_total) ) iowait_rato\n       ,sum(t.clwait_total)\n       ,sum(t.apwait_total)\n       ,sum(t.ccwait_total)\n       ,sum(t.executions_total)\n       ,sum(t.parse_calls_total)\n       ,sum(t.physical_read_requests_total)\nfrom   dba_hist_sqlstat t, dba_hist_snapshot s,(select q.sql_id,q.SQL_TEXT,q.SQL_FULLTEXT\nfrom v$sql q\nwhere q.SQL_TEXT like '%PL_CALC_LLR_TG%') sql\nwhere  t.snap_id = s.snap_id\nand    t.dbid = s.dbid\nand    t.instance_number = s.instance_number\nand    s.begin_interval_time between trunc(sysdate)-7 and trunc(sysdate)\nand    t.sql_id = sql.sql_id\ngroup by sql.sql_id\norder  by  elapsed_time_sum desc,timers desc\n\n\n-- query performance of sql run by speical user  last 7 day\n-- get user_id from DBA_USERS\nselect sql.sql_id\n       ,min(his_sess.user_id)\n       ,min(sql.sql_text)\n       ,count(sql.sql_id) timers\n       ,sum(t.elapsed_time_total) elapsed_time_sum\n       ,sum(t.iowait_total)\n       ,(sum(t.iowait_total)/sum(t.elapsed_time_total) ) iowait_rato\n       ,sum(t.clwait_total)\n       ,sum(t.apwait_total)\n       ,sum(t.ccwait_total)\n       ,sum(t.executions_total)\n       ,sum(t.parse_calls_total)\n       ,sum(t.physical_read_requests_total)\nfrom   dba_hist_sqlstat t, dba_hist_snapshot s,(select q.sql_id,q.SQL_TEXT,q.SQL_FULLTEXT from v$sql q ) sql ,\n  (select sql_id, user_id \n  from dba_hist_active_sess_history h \n  where  (h.user_id ='105' or h.user_id = '106')) his_sess\nwhere  t.snap_id = s.snap_id\nand    t.dbid = s.dbid\nand    t.instance_number = s.instance_number\nand    s.begin_interval_time between trunc(sysdate)-7 and trunc(sysdate)\nand    t.sql_id = sql.sql_id\nand    t.sql_id = his_sess.sql_id\ngroup by sql.sql_id\norder  by  elapsed_time_sum desc,timers desc"},{"key":"083b8eab56f2bc9451c537efe8c1f61a5beea2c6","name":"queryTableComments.sql","value":"select * from all_tab_comments\nwhere substr(table_name,1,4) != 'BIN$'\nand table_name = 'B_GE_T_GT_C'\n/"},{"key":"da96c7a2df62149da05423cdeafa31784d7bb9ec","name":"queryTablespaceUsed.sql","value":"select df.tablespace_name \"Tablespace\",\ntotalusedspace \"Used MB\",\n(df.totalspace - tu.totalusedspace) \"Free MB\",\ndf.totalspace \"Total MB\",\nround(100 * ( (df.totalspace - tu.totalusedspace)/ df.totalspace)) \"Pct. Free\"\n from\n(select tablespace_name,\n\tround(sum(bytes) / 1048576) TotalSpace\n \tfrom dba_data_files\n\tgroup by tablespace_name) df,\n(select round(sum(bytes)/(1024*1024)) totalusedspace, tablespace_name\n from dba_segments\ngroup by tablespace_name) tu\nwhere df.tablespace_name = tu.tablespace_name;"},{"key":"c3c30c3ad7c5352cf416acc57844634c543adc1e","name":"queryWhichIndexOnColumn.sql","value":"select t1.index_name, t1.index_type, t2.COLUMN_NAME\nfrom user_indexes t1, user_ind_columns t2\nwhere t1.table_name = 'C_CONS' and t1.index_name = t2.index_name"},{"key":"67f7ea6134b13c0404dc5f3350f6d5920a1c3844","name":"reportSessionLock.sql","value":"SET ECHO off\nREM NAME:   TFSLCKWT.SQL\nREM USAGE:\"@path/tfslckwt\"\nREM ------------------------------------------------------------------------\nREM REQUIREMENTS:\nREM    SELECT on V$SESSION, V$LOCK\nREM ------------------------------------------------------------------------\nREM PURPOSE:\nREM    Reports users waiting for locks.\nREM ------------------------------------------------------------------------\nREM EXAMPLE:\nREM    USERNAME          SID TYPE HELD        REQ           ID1        ID2\nREM    --------------- ----- ---- ----------- ----------- -------- --------\nREM    SYSTEM             12 TX   Exclusive   None          131087     2328\nREM    SCOTT               7 TX   None        Exclusive     131087     2328\nREM    SCOTT               8 TX   Exclusive   None          131099     2332\nREM    SYSTEM             10 TX   None        Exclusive     131099     2332\nREM    SYSTEM             12 TX   None        Exclusive     131099     2332\nREM\nREM ------------------------------------------------------------------------\nREM Main text of script follows:\n\ncolumn username format  A15\ncolumn sid      format  9990    heading SID\ncolumn type     format  A4\ncolumn lmode    format  990     heading 'HELD'\ncolumn request  format  990     heading 'REQ'\ncolumn id1      format  9999990\ncolumn id2 format  9999990\n\nSELECT sn.username, m.sid, m.type,\n        DECODE(m.lmode, 0, 'None',\n                        1, 'Null',\n                        2, 'Row Share',\n                        3, 'Row Excl.',\n                        4, 'Share',\n                        5, 'S/Row Excl.',\n                        6, 'Exclusive',\n                lmode, ltrim(to_char(lmode,'990'))) lmode,\n        DECODE(m.request,0, 'None',\n                         1, 'Null',\n                         2, 'Row Share',\n                         3, 'Row Excl.',\n                         4, 'Share',\n                         5, 'S/Row Excl.',\n                         6, 'Exclusive',\n                         request, ltrim(to_char(m.request,\n                '990'))) request, m.id1, m.id2\nFROM v$session sn, v$lock m\nWHERE (sn.sid = m.sid AND m.request != 0)\n        OR (sn.sid = m.sid\n                AND m.request = 0 AND lmode != 4\n                AND (id1, id2) IN (SELECT s.id1, s.id2\n     FROM v$lock s\n                        WHERE request != 0\n              AND s.id1 = m.id1\n                                AND s.id2 = m.id2)\n                )\nORDER BY id1, id2, m.request;\n"},{"key":"aabe510f85139866245edd1f43f73b007f835bff","name":"returnMediumLockInfo.sql","value":"SET ECHO off\nREM NAME:   TFSMLOCK.SQL\nREM USAGE:\"@path/tfsmlock\"\nREM ------------------------------------------------------------------------\nREM REQUIREMENTS:\nREM    SELECT on V_$LOCK, V_$SESSION, USER$, OBJ$\nREM ------------------------------------------------------------------------\nREM PURPOSE:\nREM    The following locking information script provides the following\nREM    items: SessionID, Serial #, Username, Terminal, Resource\nREM    Type, Table, Owner, ID1, ID2, Lock Held, Lock Requested.\nREM\nREM    The TFTS series contains scripts to provide (less detailed) lock\nREM    information in a simpler format (TFSLLOCK.SQL), and a script which\nREM    breaks the details out further (TFSCLOCK.SQL).\nREM ------------------------------------------------------------------------\nREM EXAMPLE:\nREM    Too complex to fit a representative sample here.\nREM ------------------------------------------------------------------------\nREM DISCLAIMER:\nREM    This script is provided for educational purposes only. It is NOT\nREM   supported by Oracle World Wide Technical Support.\nREM    The script has been tested and appears to work as intended.\nREM You should always run new scripts on a test instance initially.\nREM ------------------------------------------------------------------------\nREM Main text of script follows:  set pagesize 60\nset linesize 200 feedback off heading on\ncolumn sid format 999\ncolumn res heading 'Resource Type' format a20\ncolumn id1 format 9999999\ncolumn id2 format 9999999\ncolumn lmode heading 'Lock Held' format a14\ncolumn request heading 'Lock Req.' format a14\ncolumn serial# format 99999\ncolumn username  format a10\ncolumn terminal heading Term format a6\ncolumn tab format a10\ncolumn owner format a8\nselect  l.sid,s.serial#,s.username,s.terminal,\n        decode(l.type,'RW','RW - Row Wait Enqueue',\n                    'TM','TM - DML Enqueue',\n                    'TX','TX - Trans Enqueue',\n                    'UL','UL - User',l.type||' - System') res,\n        substr(t.name,1,10) tab,u.name owner,\n        l.id1,l.id2,\n        decode(l.lmode,1,'No Lock',\n                2,'Row Share',\n                3,'Row Exclusive',\n                4,'Share',\n                5,'Shr Row Excl',\n                6,'Exclusive',null) lmode,\n        decode(l.request,1,'No Lock',\n                2,'Row Share',\n                3,'Row Excl',\n                4,'Share',\n                5,'Shr Row Excl',\n                6,'Exclusive',null) request\nfrom v$lock l, v$session s,\nsys.user$ u,sys.obj$ t\nwhere l.sid = s.sid\nand s.type != 'BACKGROUND'\nand t.obj# = l.id1\nand u.user# = t.owner#\n/\nset feedback on"},{"key":"bf4a0ddc27e4bb1da1c6dda91434bd652a86d203","name":"rsyncdb.sh","value":"export TMP=/tmp\nexport TMPDIR=$TMP\nexport ORACLE_BASE=/home/u01/app/oracle\nexport ORACLE_HOME=$ORACLE_BASE/product/11.2.0/db_1\nexport ORACLE_SID=ghsjdb\nexport ORACLE_TERM=xterm\nexport PATH=/usr/sbin:$PATH\nexport PATH=$ORACLE_HOME/bin:$PATH\n# user locale variable\n#export LANG=zh_CN.GB18030\nexport LANG=en_US.UTF-8\n#export NLS_LANG=simplified chinese_china.ZHS16GBK\n#export NLS_LANG=AMERICAN_AMERICA.ZHS32GB18030\nexport NLS_LANG=AMERICAN_AMERICA.UTF8\n\ndmp_owner=\"SDE\",\"FM\",\"PLATFORM_APP\",\"PLATFORM\",\"GHSJ_PWGL\",\"GHSJ_JCSJ\",\"GHSJ_XM\"\ncurtime=`date +%Y%m%d%H%M`\ndmp_directory=DMP_DIRECTORY\ndmp_file=dmp.dmp\nlog_exp_file=\"log_$curtime_exp.log\"\njob_exp_name=\"expdp_$curtime_job\"\nlog_imp_file=\"log_$curtime_exp.log\"\njob_imp_name=\"expdp_$curtime_job\"\n\necho \" \"\necho \"============expdp impdp ===============\"\n\nexpdp expdper/expdper@ghsjdb SCHEMAS=$dmp_owner dumpfile=$dmp_file DIRECTORY=$dmp_directory  PARALLEL=16  logfile=$log_exp_file job_name=$job_exp_name\n#impdp impdper/impdper@ghsjdb_test SCHEMAS=$dmp_owner DIRECTORY=$dmp_directory DUMPFILE=$dmp_file TABLE_EXISTS_ACTION=replace LOGFILE=$log_imp_file JOB_NAME=$job_imp_name PARALLEL=16"},{"key":"d543e3641655a3eb4a68ad91a4bc9ee05348579a","name":"runstats_pkg.sql","value":"-- usage:\n-- exec  runstats_pkg.rs_start;\n-- run produces1\n-- exec runstats_pkg.rs_middle\n-- run produces2\n-- exec runstats_pkg.rs_stop(100);\n\ncreate or replace view stats\nas select 'STAT...' || a.name name, b.value\n      from v$statname a, v$mystat b\n     where a.statistic# = b.statistic#\n    union all\n    select 'LATCH.' || name,  gets\n      from v$latch;\n\ncreate global temporary table run_stats\n( runid varchar2(15),\n  name varchar2(80),\n  value int )\non commit preserve rows;\n\n\ncreate or replace package runstats_pkg\nas\n    procedure rs_start;\n    procedure rs_middle;\n    procedure rs_stop( p_difference_threshold in number default 0 );\nend;\n/\n\ncreate or replace package body runstats_pkg\nas\n\ng_start      number;\ng_run1     number;\ng_run2     number;\n\nprocedure rs_start\nis\nbegin\n    delete from run_stats;\n\n    insert into run_stats\n    select 'before', stats.* from stats;\n\n    g_start := dbms_utility.get_time;\nend;\n\nprocedure rs_middle\nis\nbegin\n    g_run1 := (dbms_utility.get_time-g_start);\n\n    insert into run_stats\n    select 'after 1', stats.* from stats;\n    g_start := dbms_utility.get_time;\n\nend;\n\nprocedure rs_stop(p_difference_threshold in number default 0)\nis\nbegin\n    g_run2 := (dbms_utility.get_time-g_start);\n\n    dbms_output.put_line\n        ( 'Run1 ran in ' || g_run1 || ' hsecs' );\n    dbms_output.put_line\n        ( 'Run2 ran in ' || g_run2 || ' hsecs' );\n    dbms_output.put_line\n    ( 'run1:run2  rato is ' || round(g_run1/g_run2,2)  );\n        dbms_output.put_line( chr(9) );\n\n    insert into run_stats\n    select 'after 2', stats.* from stats;\n\n    dbms_output.put_line\n    ( rpad( 'Name', 30 ) || lpad( 'Run1', 10 ) ||\n      lpad( 'Run2', 10 ) || lpad( 'Diff', 10 ) );\n\n    for x in\n    ( select rpad( a.name, 30 ) ||\n             to_char( b.value-a.value, '9,999,999' ) ||\n             to_char( c.value-b.value, '9,999,999' ) ||\n             to_char( ( (c.value-b.value)-(b.value-a.value)), '9,999,999' ) data\n        from run_stats a, run_stats b, run_stats c\n       where a.name = b.name\n         and b.name = c.name\n         and a.runid = 'before'\n         and b.runid = 'after 1'\n         and c.runid = 'after 2'\n         and (c.value-a.value) > 0\n         and abs( (c.value-b.value) - (b.value-a.value) )\n               > p_difference_threshold\n       order by abs( (c.value-b.value)-(b.value-a.value))\n    ) loop\n        dbms_output.put_line( x.data );\n    end loop;\n\n        dbms_output.put_line( chr(9) );\n    dbms_output.put_line( 'Run1 latches total versus runs -- difference and pct' );\n    dbms_output.put_line( lpad( 'Run1', 10 ) || lpad( 'Run2', 10 ) ||  lpad( 'Diff', 10 ) || lpad( '   run1:run2', 10 ) );\n\n    for x in\n    ( select to_char( run1, '9,999,999' ) ||\n             to_char( run2, '9,999,999' ) ||\n             to_char( diff, '9,999,999' ) ||\n             to_char( round( run1/run2 ,2 ), '999.99' ) data\n        from ( select sum(b.value-a.value) run1, sum(c.value-b.value) run2,\n                      sum( (c.value-b.value)-(b.value-a.value)) diff\n                 from run_stats a, run_stats b, run_stats c\n                where a.name = b.name\n                  and b.name = c.name\n                  and a.runid = 'before'\n                  and b.runid = 'after 1'\n                  and c.runid = 'after 2'\n                  and a.name like 'LATCH%'\n                )\n    ) loop\n        dbms_output.put_line( x.data );\n    end loop;\nend;\n\nend;\n/\n\n"},{"key":"8b3bb0b135738bfa7ab619adcb5c619d55319eb4","name":"sqlplus_customer.sql","value":"define _editor=vi\n\nset serveroutput on size 1000000 format wrapped\n\nset trimspool on\nset long 5000\nset linesize 119\nset pagesize 9999\nset wrap off\n"},{"key":"0b3eb5c3b9313be524d5e6077a4af7993761ba73","name":"TKPROF.sql","value":"--get tkporf file path\nselect rtrim(c.value,'/') || '/' || d.instance_name || '_ora_' || ltrim(to_char(a.spid)) || '.trc' \nfrom v$process a, v$session b, v$parameter c, v$instance d \nwhere a.addr = b.paddr \nand b.audsid = sys_context( 'userenv', 'sessionid') \nand c.name = 'user_dump_dest';"},{"key":"227228795929f88fdbe195cd2427e05c3c08abd0","name":"ts_extent_map.sql","value":"-- -----------------------------------------------------------------------------------\n-- File Name    : https://oracle-base.com/dba/monitoring/ts_extent_map.sql\n-- Author       : Tim Hall\n-- Description  : Displays gaps (empty space) in a tablespace or specific datafile.\n-- Requirements : Access to the DBA views.\n-- Call Syntax  : @ts_extent_map (tablespace-name) [all | file_id]\n-- Last Modified: 25/01/2003\n-- -----------------------------------------------------------------------------------\nSET SERVEROUTPUT ON SIZE 1000000\nSET FEEDBACK OFF\nSET TRIMOUT ON\nSET VERIFY OFF\n\nDECLARE\n  l_tablespace_name VARCHAR2(30) := UPPER('&1');\n  l_file_id         VARCHAR2(30) := UPPER('&2');\n\n  CURSOR c_extents IS\n    SELECT owner,\n           segment_name,\n           file_id,\n           block_id AS start_block,\n           block_id + blocks - 1 AS end_block\n    FROM   dba_extents\n    WHERE  tablespace_name = l_tablespace_name\n    AND    file_id = DECODE(l_file_id, 'ALL', file_id, TO_NUMBER(l_file_id))\n    ORDER BY file_id, block_id;\n\n  l_block_size     NUMBER  := 0;\n  l_last_file_id   NUMBER  := 0;\n  l_last_block_id  NUMBER  := 0;\n  l_gaps_only      BOOLEAN := TRUE;\n  l_total_blocks   NUMBER  := 0;\nBEGIN\n  SELECT block_size\n  INTO   l_block_size\n  FROM   dba_tablespaces\n  WHERE  tablespace_name = l_tablespace_name;\n\n  DBMS_OUTPUT.PUT_LINE('Tablespace Block Size (bytes): ' || l_block_size);\n  FOR cur_rec IN c_extents LOOP\n    IF cur_rec.file_id != l_last_file_id THEN\n      l_last_file_id  := cur_rec.file_id;\n      l_last_block_id := cur_rec.start_block - 1;\n    END IF;\n    \n    IF cur_rec.start_block > l_last_block_id + 1 THEN\n      DBMS_OUTPUT.PUT_LINE('*** GAP *** (' || l_last_block_id || ' -> ' || cur_rec.start_block || ')' ||\n        ' FileID=' || cur_rec.file_id ||\n        ' Blocks=' || (cur_rec.start_block-l_last_block_id-1) || \n        ' Size(MB)=' || ROUND(((cur_rec.start_block-l_last_block_id-1) * l_block_size)/1024/1024,2)\n      );\n      l_total_blocks := l_total_blocks + cur_rec.start_block - l_last_block_id-1;\n    END IF;\n    l_last_block_id := cur_rec.end_block;\n    IF NOT l_gaps_only THEN\n      DBMS_OUTPUT.PUT_LINE(RPAD(cur_rec.owner || '.' || cur_rec.segment_name, 40, ' ') ||\n                           ' (' || cur_rec.start_block || ' -> ' || cur_rec.end_block || ')');\n    END IF;\n  END LOOP;\n  DBMS_OUTPUT.PUT_LINE('Total Gap Blocks: ' || l_total_blocks);\n  DBMS_OUTPUT.PUT_LINE('Total Gap Space (MB): ' || ROUND((l_total_blocks * l_block_size)/1024/1024,2));\nEND;\n/\n\nPROMPT\nSET FEEDBACK ON"},{"key":"4349e5dc870a1239cb0c5ade3f5d985ffcbf32ac","name":"ts_free_space.sql","value":"-- -----------------------------------------------------------------------------------\n-- File Name    : https://oracle-base.com/dba/monitoring/ts_free_space.sql\n-- Author       : Tim Hall\n-- Description  : Displays a list of tablespaces and their used/full status.\n-- Requirements : Access to the DBA views.\n-- Call Syntax  : @ts_free_space.sql\n-- Last Modified: 13-OCT-2012 - Created. Based on ts_full.sql\n-- -----------------------------------------------------------------------------------\nSET PAGESIZE 140\nCOLUMN used_pct FORMAT A11\n\nSELECT tablespace_name,\n       size_mb,\n       free_mb,\n       max_size_mb,\n       max_free_mb,\n       TRUNC((max_free_mb/max_size_mb) * 100) AS free_pct,\n       RPAD(' '|| RPAD('X',ROUND((max_size_mb-max_free_mb)/max_size_mb*10,0), 'X'),11,'-') AS used_pct\nFROM   (\n        SELECT a.tablespace_name,\n               b.size_mb,\n               a.free_mb,\n               b.max_size_mb,\n               a.free_mb + (b.max_size_mb - b.size_mb) AS max_free_mb\n        FROM   (SELECT tablespace_name,\n                       TRUNC(SUM(bytes)/1024/1024) AS free_mb\n                FROM   dba_free_space\n                GROUP BY tablespace_name) a,\n               (SELECT tablespace_name,\n                       TRUNC(SUM(bytes)/1024/1024) AS size_mb,\n                       TRUNC(SUM(GREATEST(bytes,maxbytes))/1024/1024) AS max_size_mb\n                FROM   dba_data_files\n                GROUP BY tablespace_name) b\n        WHERE  a.tablespace_name = b.tablespace_name\n       )\nORDER BY tablespace_name;\n\nSET PAGESIZE 14"}]},{"copy":0,"tags":[],"key":"7a15859c30fc6a6a5245a4d0f594dbef6a78ecff","createAt":1541645568470,"updateAt":1541645568470,"name":"RMAN","description":"","files":[{"key":"4ccb4e56d940254d677fcb8eb983ba4b285d0172","name":"fullbackup.sql","value":"run\n{\nallocate channel ch1 device type disk; #one disk one channel\nbackup  as COMPRESSED backupset database format '/home/oracle/rmanback/db_%U_%d';\nbackup archivelog all format '/home/oracle/rmanback/arch_%t_%s' delete all input;\nbackup format '/home/oracle/rmanback/con_%s_%p' current controlfile;\ncrosscheck backup;\ncrosscheck archivelog all;\ndelete noprompt expired backup;\ndelete noprompt obsolete;\ndelete noprompt archivelog all;\nrelease channel ch1;\n}"}]},{"key":"9a17390e1fc68b51d7780377f026fdc215d8704a","createAt":1542176154445,"updateAt":1542176154445,"copy":0,"tags":[],"name":"interview js","description":"using for interview","files":[{"key":"05fcfae271db4db208d512ef8714853e9bc79e3c","name":"12","value":"12"}]}]