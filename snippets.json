[{"copy":1,"tags":[],"key":"6a203f3dd74ea1cab8435c1bea887722635c6e2f","createAt":1541581883463,"updateAt":1541581994677,"name":"IsInArray","lang":"VBScript","value":"'********************************************************************************\n'' Determines whether a string has the same value in an array\n'' @stringToBeFound  :  to be found string\n'' @arr              :  use to found in array\nFunction IsInArray(stringToBeFound As String, arr As Variant) As Long\nDim i As Long\n' default return value if value not found in array\nIsInArray = -1\n\nif Initialized(arr) then\n    For i = LBound(arr) To UBound(arr)\n      If StrComp(stringToBeFound, arr(i), vbTextCompare) = 0 Then\n        IsInArray = i\n        Exit For\n      End If\n    Next i\nelse\n    IsInArray = -2\nEnd If\n\nEnd Function","description":""},{"copy":0,"tags":[],"key":"22d93e1e778364bf05c97fcb8d0677d8e8eb6308","createAt":1541582104253,"updateAt":1541582128184,"name":"ArrayFunction.vbs","description":"ArrayFunction.vbs","files":[{"key":"e6d3c00c1944f2ac2b8018d6e346f4e7f7f9effd","name":"ArrayFunction.vbs","value":"'********************************************************************************\n'' Determines whether a string has the same value in an array\n'' @stringToBeFound  :  to be found string\n'' @arr              :  use to found in array\nFunction IsInArray(stringToBeFound As String, arr As Variant) As Long\nDim i As Long\n' default return value if value not found in array\nIsInArray = -1\n\nif Initialized(arr) then\n    For i = LBound(arr) To UBound(arr)\n      If StrComp(stringToBeFound, arr(i), vbTextCompare) = 0 Then\n        IsInArray = i\n        Exit For\n      End If\n    Next i\nelse\n    IsInArray = -2\nEnd If\n\nEnd Function\n\n'********************************************************************************\n'' push  value in an array\n'' @arr              :  not need dim length in advance\nSub pushArray(val As Variant, ByRef resizeArr As Variant)\n\nOn Error GoTo FIRST\nReDim Preserve resizeArr(UBound(resizeArr) + 1)\n\nresizeArr(UBound(resizeArr)) = val\n\nExit Sub\n\nFIRST:\nReDim resizeArr(0)\nresizeArr(0) = val\n\nEnd Sub\n\n'********************************************************************************\n'' push  arr2 to another arr1\nFunction pushArrayToArray(ByRef arr1 As Variant, ByVal arr2 As Variant) As Long\n  Dim i As Integer\n\n  For i = LBound(arr2) To UBound(arr2)\n    pushArray arr2(i), arr1\n  Next i\n\nEnd Function\n\n'********************************************************************************\n'' push value of range into a array and no repetition\n'' @range\n'' @arr  : array with contain distinct value\nFunction pushRangeToArrayNoRepetition(ByVal Range As Excel.Range, ByRef arr() As Variant)\n    Dim c As Excel.Range\n    Dim str As String\n\n    For Each c In Range\n        If c.Value2 <> \"\" Then\n            str = c.Value2\n        End If\n\n        '-1 :   no find string, -2 : array no init\n        If IsInArray(str, arr) < 0 Then\n            pushArray2 str, arr\n        End If\n\n    Next\nEnd Function\n\n'********************************************************************************\n'' push value of range into a array\n'' @range\n'' @arr  : array with contain distinct value\nFunction pushRangeToArray(ByVal Range As Excel.Range, ByRef arr() As Variant)\n    Dim c As Excel.Range\n    Dim str As String\n\n    For Each c In Range\n        If c.Value2 <> \"\" Then\n            str = c.Value2\n        End If\n\n        pushArray2 str, arr\n\n    Next\nEnd Function\n\n'********************************************************************************\n'' find splite sign in string,return array.if not find return 0\nFunction supSplit(ByVal str As String, Optional ByRef flag As Integer) As String()\nDim aStr(0) As String\nflag = 1\n\nIf InStr(str, \",\") > 0 Then\n    supSplit = Split(str, \",\")\nElseIf InStr(str, \":\") > 0 Then\n    supSplit = Split(str, \":\")\nElseIf InStr(str, \"|\") > 0 Then\n    supSplit = Split(str, \"|\")\nElseIf InStr(str, \"\\\") > 0 Then\n    supSplit = Split(str, \"\\\")\nElseIf InStr(str, \";\") > 0 Then\n    supSplit = Split(str, \";\")\nElseIf InStr(str, \"_\") > 0 Then\n    supSplit = Split(str, \"_\")\nElseIf InStr(str, \"-\") > 0 Then\n    supSplit = Split(str, \"-\")\nElse\n    aStr(0) = str\n    supSplit = aStr\n    flag = 0\nEnd If\n\n\nEnd Function\n\n'********************************************************************************\n'' return count of element of array,and element is not \"\"\nFunction countArrayNotEmpte(ByVal arr As Variant) As Integer\nDim count As Integer\nDim i As Integer\n\nFor i = LBound(arr) To UBound(arr)\n    If arr(i) <> \"\" Then\n        count = count + 1\n    End If\nNext i\n\ncountArrayNotEmpte = count\n\nEnd Function\n\n'********************************************************************************\nFunction countArray(ByVal arr As Variant) As Integer\nDim i As Variant\nDim count As Integer\n\nFor Each i In arr\n    count = count + 1\nNext\n\ncountArray = count\n\nEnd Function\n\n'********************************************************************************\n'' Determine if Array is not Initialized\nFunction Initialized(val) As Boolean\nOn Error GoTo errHandler\n    Dim i\n\n    If Not IsArray(val) Then GoTo exitRoutine\n\n    i = UBound(val)\n\n    Initialized = True\nexitRoutine:\n    Exit Function\nerrHandler:\n    Select Case Err.Number\n        Case 9 'Subscript out of range\n            GoTo exitRoutine\n        Case Else\n            Debug.Print Err.Number & \": \" & Err.Description, _\n                \"Error in Initialized()\"\n    End Select\n    Debug.Assert False\n    Resume\nEnd Function\n\n'********************************************************************************\n'' 将一个array中的值填充到一个range中\n'' @range\n'' @arr  :\nFunction pushArrayToRange(ByRef arr As Variant, ByVal range As Excel.range)\nDim i As Long\nDim j As Long\n\nj = 1\n\nFor i = LBound(arr) To UBound(arr)\n    If  j <= range.Count Then\n        range.Item(j) = arr(i)\n        j = j + 1\n    End If\nNext i\n\nEnd Function\n\n'********************************************************************************\n''push element of array into a range of single column type from up to down\n'@arr           :   array by pushed\n'@startCell    :   range type , the first cell by pushed\nSub pushArrayToSingleColumnRange(arr As Variant, ByVal startCell As range)\nDim i As Long\nDim c As range\n\nFor i = 0 To UBound(arr)\n        Set c = startCell.Offset(rowoffset:=i)\n        c.Value2 = arr(i)\nNext i\n\nEnd Sub"}]},{"copy":0,"tags":[],"key":"b6bb1895af1ba90df3a24111d9e00752b9c69765","createAt":1541582367022,"updateAt":1541582380171,"name":"sdf","lang":"VBScript","value":"'********************************************************************************\n'' Determines whether a string has the same value in an array\n'' @stringToBeFound  :  to be found string\n'' @arr              :  use to found in array\nFunction IsInArray(stringToBeFound As String, arr As Variant) As Long\nDim i As Long\n' default return value if value not found in array\nIsInArray = -1\n\nif Initialized(arr) then\n    For i = LBound(arr) To UBound(arr)\n      If StrComp(stringToBeFound, arr(i), vbTextCompare) = 0 Then\n        IsInArray = i\n        Exit For\n      End If\n    Next i\nelse\n    IsInArray = -2\nEnd If\n\nEnd Function","description":""},{"copy":0,"tags":[],"key":"f06c9bdd5e83307d4598aaddabce85d8a6f454b9","createAt":1541582421119,"updateAt":1541582542958,"name":"123","description":"","files":[{"key":"06d864e4e1b1bc9ecce0d7fca7cb86ca827bd55b","name":"123","value":"123"},{"key":"c3c2ae9cbf6e03e11baf99e9731880161ab32cd6","name":"1234","value":"1234"}]}]